# E-commerce IAI Tech - GuÃ­a de Desarrollo Completa

## ğŸ¯ Objetivo del Proyecto
Crear un e-commerce moderno con el diseÃ±o inspirado en PC Factory Chile pero vendiendo productos de tecnologÃ­a de seguridad y automatizaciÃ³n de IAI Tech, utilizando Next.js 14, NestJS, TailwindCSS y mejores prÃ¡cticas de UX/UI.

## ğŸ“‹ Tabla de Contenidos
1. [Stack TecnolÃ³gico](#stack-tecnolÃ³gico)
2. [AnÃ¡lisis de Referencia](#anÃ¡lisis-de-referencia)
3. [Estructura del Proyecto](#estructura-del-proyecto)
4. [ConfiguraciÃ³n Inicial](#configuraciÃ³n-inicial)
5. [Desarrollo Backend](#desarrollo-backend)
6. [Desarrollo Frontend](#desarrollo-frontend)
7. [ImplementaciÃ³n de Funcionalidades](#implementaciÃ³n-de-funcionalidades)
8. [DiseÃ±o y UX/UI](#diseÃ±o-y-ux-ui)
9. [Deployment](#deployment)
10. [Testing](#testing)

## ğŸ›  Stack TecnolÃ³gico

### Frontend
- **Next.js 14** (App Router)
- **TypeScript**
- **TailwindCSS**
- **Shadcn/ui** (componentes)
- **Framer Motion** (animaciones)
- **Zustand** (gestiÃ³n de estado)
- **React Hook Form** (formularios)
- **React Query/TanStack Query** (cache de datos)

### Backend
- **NestJS**
- **TypeScript**
- **PostgreSQL** (base de datos principal)
- **Prisma** (ORM)
- **Redis** (cache y sesiones)
- **Cloudinary** (gestiÃ³n de imÃ¡genes)
- **JWT** (autenticaciÃ³n)
- **Stripe** (pagos)

### DevOps & Herramientas
- **Docker** (containerizaciÃ³n)
- **Vercel** (frontend deployment)
- **Railway/Heroku** (backend deployment)
- **GitHub Actions** (CI/CD)

## ğŸ” AnÃ¡lisis de Referencia

### PC Factory - Elementos Clave a Replicar
- **Header**: Logo prominente, bÃºsqueda central, categorÃ­as, carrito
- **Hero Section**: Banners promocionales con ofertas destacadas
- **NavegaciÃ³n**: MenÃº por categorÃ­as con mega-menÃºs
- **Grid de Productos**: Cards limpias con precio, descuento, stock
- **Colores**: Azul corporativo (#0066CC), blanco, grises
- **Funcionalidades**: Filtros, ordenamiento, comparaciÃ³n de productos

### IAI Tech - CatÃ¡logo de Productos
- **Seguridad**: CÃ¡maras, alarmas, control de acceso
- **IluminaciÃ³n**: LED RGB, pantallas LED
- **AutomatizaciÃ³n**: Smart home, cercos elÃ©ctricos
- **EnergÃ­a**: Sistemas solares
- **ComunicaciÃ³n**: Video porteros

## ğŸ— Estructura del Proyecto

```
iai-tech-ecommerce/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ web/                    # Frontend Next.js
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ (auth)/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ (shop)/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ productos/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ categoria/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ carrito/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ api/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ product/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ cart/
â”‚   â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ store/
â”‚   â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ styles/
â”‚   â””â”€â”€ api/                    # Backend NestJS
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ auth/
â”‚       â”‚   â”œâ”€â”€ products/
â”‚       â”‚   â”œâ”€â”€ categories/
â”‚       â”‚   â”œâ”€â”€ orders/
â”‚       â”‚   â”œâ”€â”€ users/
â”‚       â”‚   â”œâ”€â”€ upload/
â”‚       â”‚   â””â”€â”€ common/
â”‚       â”œâ”€â”€ prisma/
â”‚       â””â”€â”€ uploads/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ shared/                 # Tipos compartidos
â”‚   â””â”€â”€ ui/                     # Componentes UI compartidos
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ README.md
```

## ğŸš€ ConfiguraciÃ³n Inicial

### 1. Crear el Workspace

```bash
# Crear directorio principal
mkdir iai-tech-ecommerce
cd iai-tech-ecommerce

# Inicializar monorepo
npm init -y
npm install -D @typescript-eslint/eslint-plugin @typescript-eslint/parser eslint prettier
```

### 2. Configurar Backend (NestJS)

```bash
# Crear aplicaciÃ³n NestJS
npx @nestjs/cli new api
cd api

# Instalar dependencias principales
npm install @nestjs/common @nestjs/core @nestjs/platform-express
npm install @nestjs/jwt @nestjs/passport passport passport-jwt
npm install @prisma/client prisma
npm install bcryptjs class-validator class-transformer
npm install @nestjs/config @nestjs/throttler
npm install redis ioredis @nestjs/bull bull

# Dependencias de desarrollo
npm install -D @nestjs/cli @nestjs/schematics @nestjs/testing
npm install -D @types/bcryptjs @types/passport-jwt
```

### 3. Configurar Frontend (Next.js)

```bash
# Crear aplicaciÃ³n Next.js
npx create-next-app@latest web --typescript --tailwind --eslint --app --src-dir
cd web

# Instalar dependencias UI
npm install @radix-ui/react-slot @radix-ui/react-dialog
npm install @radix-ui/react-dropdown-menu @radix-ui/react-select
npm install clsx tailwind-merge lucide-react
npm install framer-motion

# GestiÃ³n de estado y datos
npm install zustand @tanstack/react-query
npm install react-hook-form @hookform/resolvers zod

# Utilidades
npm install axios date-fns
```

## ğŸ”§ Desarrollo Backend

### 1. ConfiguraciÃ³n de Base de Datos

```typescript
// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  firstName String
  lastName  String
  role      Role     @default(USER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  orders    Order[]
}

model Category {
  id          String    @id @default(cuid())
  name        String
  slug        String    @unique
  description String?
  image       String?
  parentId    String?
  parent      Category? @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children    Category[] @relation("CategoryHierarchy")
  products    Product[]
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Product {
  id          String   @id @default(cuid())
  name        String
  slug        String   @unique
  description String
  price       Decimal
  salePrice   Decimal?
  sku         String   @unique
  stock       Int
  images      String[]
  features    Json?
  categoryId  String
  category    Category @relation(fields: [categoryId], references: [id])
  isActive    Boolean  @default(true)
  isFeatured  Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  orderItems  OrderItem[]
}

model Order {
  id         String      @id @default(cuid())
  userId     String
  user       User        @relation(fields: [userId], references: [id])
  status     OrderStatus @default(PENDING)
  total      Decimal
  items      OrderItem[]
  shippingAddress Json
  paymentMethod   String
  paymentStatus   PaymentStatus @default(PENDING)
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}

model OrderItem {
  id        String  @id @default(cuid())
  orderId   String
  order     Order   @relation(fields: [orderId], references: [id])
  productId String
  product   Product @relation(fields: [productId], references: [id])
  quantity  Int
  price     Decimal
}

enum Role {
  USER
  ADMIN
}

enum OrderStatus {
  PENDING
  CONFIRMED
  SHIPPED
  DELIVERED
  CANCELLED
}

enum PaymentStatus {
  PENDING
  PAID
  FAILED
  REFUNDED
}
```

### 2. MÃ³dulos Principales del Backend

```typescript
// src/products/products.service.ts
@Injectable()
export class ProductsService {
  constructor(private prisma: PrismaService) {}

  async findAll(filters: ProductFilters) {
    const where: Prisma.ProductWhereInput = {
      isActive: true,
      ...(filters.categoryId && { categoryId: filters.categoryId }),
      ...(filters.search && {
        OR: [
          { name: { contains: filters.search, mode: 'insensitive' } },
          { description: { contains: filters.search, mode: 'insensitive' } }
        ]
      }),
      ...(filters.priceRange && {
        price: {
          gte: filters.priceRange.min,
          lte: filters.priceRange.max
        }
      })
    }

    return this.prisma.product.findMany({
      where,
      include: { category: true },
      orderBy: { [filters.sortBy || 'createdAt']: filters.sortOrder || 'desc' },
      skip: (filters.page - 1) * filters.limit,
      take: filters.limit
    })
  }

  async findBySlug(slug: string) {
    return this.prisma.product.findUnique({
      where: { slug },
      include: { category: true }
    })
  }
}
```

## ğŸ¨ Desarrollo Frontend

### 1. ConfiguraciÃ³n de TailwindCSS

```javascript
// tailwind.config.js
module.exports = {
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
    './src/app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#eff6ff',
          500: '#0066cc',
          600: '#0052a3',
          700: '#003d7a',
        },
        secondary: {
          50: '#f8fafc',
          500: '#64748b',
          600: '#475569',
        }
      },
      fontFamily: {
        sans: ['Inter', 'sans-serif'],
      },
      animation: {
        'fade-in': 'fadeIn 0.5s ease-in-out',
        'slide-up': 'slideUp 0.3s ease-out',
      }
    },
  },
  plugins: [],
}
```

### 2. Componentes Base UI

```typescript
// src/components/ui/button.tsx
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"
import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",
  {
    variants: {
      variant: {
        default: "bg-primary-500 text-white hover:bg-primary-600",
        outline: "border border-primary-500 text-primary-500 hover:bg-primary-50",
        ghost: "hover:bg-gray-100",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-8 px-3 text-xs",
        lg: "h-12 px-8",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

export const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button"
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
```

### 3. Layout Principal

```typescript
// src/components/layout/header.tsx
export function Header() {
  return (
    <header className="bg-white shadow-sm border-b">
      <div className="container mx-auto px-4">
        {/* Top Bar */}
        <div className="flex items-center justify-between h-12 text-sm">
          <div className="flex items-center space-x-4">
            <span>ğŸ“ +56 2 2345 6789</span>
            <span>ğŸ“§ info@iai-tech.cl</span>
          </div>
          <div className="flex items-center space-x-4">
            <Link href="/login">Iniciar SesiÃ³n</Link>
            <Link href="/register">Registrarse</Link>
          </div>
        </div>
        
        {/* Main Header */}
        <div className="flex items-center justify-between h-16">
          <Link href="/" className="flex items-center">
            <img src="/logo.svg" alt="IAI Tech" className="h-10" />
          </Link>
          
          {/* Search Bar */}
          <div className="flex-1 max-w-xl mx-8">
            <SearchBar />
          </div>
          
          {/* Actions */}
          <div className="flex items-center space-x-4">
            <Button variant="ghost" size="sm">
              <Heart className="h-5 w-5" />
            </Button>
            <CartButton />
          </div>
        </div>
        
        {/* Navigation */}
        <nav className="h-12 flex items-center space-x-8">
          <CategoryMenu />
        </nav>
      </div>
    </header>
  )
}
```

### 4. Componentes de Producto

```typescript
// src/components/product/product-card.tsx
interface ProductCardProps {
  product: Product
}

export function ProductCard({ product }: ProductCardProps) {
  const { addToCart } = useCart()
  
  const discountPercentage = product.salePrice 
    ? Math.round(((product.price - product.salePrice) / product.price) * 100)
    : 0

  return (
    <div className="group relative bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow">
      {/* Badge de descuento */}
      {discountPercentage > 0 && (
        <div className="absolute top-2 left-2 z-10 bg-red-500 text-white px-2 py-1 rounded text-xs font-medium">
          -{discountPercentage}%
        </div>
      )}
      
      {/* Imagen */}
      <div className="aspect-square relative overflow-hidden rounded-t-lg">
        <img
          src={product.images[0]}
          alt={product.name}
          className="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
        />
        
        {/* Overlay con acciones */}
        <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
          <div className="flex space-x-2">
            <Button size="sm" variant="default">
              <Eye className="h-4 w-4 mr-1" />
              Ver
            </Button>
            <Button size="sm" variant="outline">
              <Heart className="h-4 w-4" />
            </Button>
          </div>
        </div>
      </div>
      
      {/* Contenido */}
      <div className="p-4">
        <h3 className="font-semibold text-gray-900 mb-2 line-clamp-2">
          {product.name}
        </h3>
        
        <div className="flex items-center justify-between mb-3">
          <div className="flex flex-col">
            {product.salePrice ? (
              <>
                <span className="text-lg font-bold text-primary-600">
                  ${product.salePrice.toLocaleString()}
                </span>
                <span className="text-sm text-gray-500 line-through">
                  ${product.price.toLocaleString()}
                </span>
              </>
            ) : (
              <span className="text-lg font-bold text-gray-900">
                ${product.price.toLocaleString()}
              </span>
            )}
          </div>
          
          <div className="text-sm text-gray-500">
            Stock: {product.stock}
          </div>
        </div>
        
        <Button
          onClick={() => addToCart(product)}
          className="w-full"
          disabled={product.stock === 0}
        >
          <ShoppingCart className="h-4 w-4 mr-2" />
          {product.stock > 0 ? 'Agregar al Carrito' : 'Agotado'}
        </Button>
      </div>
    </div>
  )
}
```

## ğŸ›’ ImplementaciÃ³n de Funcionalidades

### 1. GestiÃ³n de Estado del Carrito

```typescript
// src/store/cart-store.ts
import { create } from 'zustand'
import { persist } from 'zustand/middleware'

interface CartItem {
  id: string
  name: string
  price: number
  salePrice?: number
  image: string
  quantity: number
  stock: number
}

interface CartStore {
  items: CartItem[]
  total: number
  addItem: (product: Product) => void
  removeItem: (id: string) => void
  updateQuantity: (id: string, quantity: number) => void
  clearCart: () => void
}

export const useCart = create<CartStore>()(
  persist(
    (set, get) => ({
      items: [],
      total: 0,
      
      addItem: (product) => {
        const items = get().items
        const existingItem = items.find(item => item.id === product.id)
        
        if (existingItem) {
          set({
            items: items.map(item =>
              item.id === product.id
                ? { ...item, quantity: Math.min(item.quantity + 1, item.stock) }
                : item
            )
          })
        } else {
          set({
            items: [...items, {
              id: product.id,
              name: product.name,
              price: product.price,
              salePrice: product.salePrice,
              image: product.images[0],
              quantity: 1,
              stock: product.stock
            }]
          })
        }
        
        // Recalcular total
        const newItems = get().items
        const newTotal = newItems.reduce((sum, item) => 
          sum + (item.salePrice || item.price) * item.quantity, 0
        )
        set({ total: newTotal })
      },
      
      removeItem: (id) => {
        const items = get().items.filter(item => item.id !== id)
        const total = items.reduce((sum, item) => 
          sum + (item.salePrice || item.price) * item.quantity, 0
        )
        set({ items, total })
      },
      
      updateQuantity: (id, quantity) => {
        const items = get().items.map(item =>
          item.id === id ? { ...item, quantity: Math.max(0, Math.min(quantity, item.stock)) } : item
        )
        const total = items.reduce((sum, item) => 
          sum + (item.salePrice || item.price) * item.quantity, 0
        )
        set({ items, total })
      },
      
      clearCart: () => set({ items: [], total: 0 })
    }),
    {
      name: 'cart-storage',
    }
  )
)
```

### 2. BÃºsqueda y Filtros

```typescript
// src/components/search/search-bar.tsx
export function SearchBar() {
  const [query, setQuery] = useState('')
  const [isOpen, setIsOpen] = useState(false)
  const { data: suggestions } = useQuery({
    queryKey: ['search-suggestions', query],
    queryFn: () => searchProducts(query),
    enabled: query.length > 2,
    staleTime: 300000 // 5 minutos
  })

  return (
    <div className="relative">
      <div className="relative">
        <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400" />
        <input
          type="text"
          placeholder="Buscar productos..."
          value={query}
          onChange={(e) => setQuery(e.target.value)}
          onFocus={() => setIsOpen(true)}
          className="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"
        />
      </div>
      
      {/* Suggestions Dropdown */}
      {isOpen && suggestions && suggestions.length > 0 && (
        <div className="absolute top-full left-0 right-0 bg-white border border-gray-200 rounded-lg shadow-lg z-50 mt-1">
          {suggestions.map((product) => (
            <Link
              key={product.id}
              href={`/productos/${product.slug}`}
              className="flex items-center p-3 hover:bg-gray-50 border-b last:border-b-0"
              onClick={() => setIsOpen(false)}
            >
              <img
                src={product.images[0]}
                alt={product.name}
                className="w-10 h-10 object-cover rounded mr-3"
              />
              <div>
                <p className="font-medium">{product.name}</p>
                <p className="text-sm text-gray-500">
                  ${product.salePrice || product.price}
                </p>
              </div>
            </Link>
          ))}
        </div>
      )}
    </div>
  )
}
```

## ğŸ¨ DiseÃ±o y UX/UI

### 1. Paleta de Colores y Tokens de DiseÃ±o

```css
/* src/styles/globals.css */
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* Colores principales */
  --primary-50: #eff6ff;
  --primary-500: #0066cc;
  --primary-600: #0052a3;
  --primary-700: #003d7a;
  
  /* Colores de estado */
  --success: #059669;
  --warning: #d97706;
  --error: #dc2626;
  
  /* Grises */
  --gray-50: #f9fafb;
  --gray-100: #f3f4f6;
  --gray-500: #6b7280;
  --gray-900: #111827;
  
  /* Sombras */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
}

/* Animaciones personalizadas */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { 
    opacity: 0;
    transform: translateY(20px);
  }
  to { 
    opacity: 1;
    transform: translateY(0);
  }
}

/* Utilidades personalizadas */
@layer utilities {
  .animate-fade-in {
    animation: fadeIn 0.5s ease-in-out;
  }
  
  .animate-slide-up {
    animation: slideUp 0.3s ease-out;
  }
  
  .line-clamp-2 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
  }
}
```

### 2. Componentes de PÃ¡gina Principal

```typescript
// src/app/(shop)/page.tsx
export default function HomePage() {
  return (
    <div className="min-h-screen">
      {/* Hero Section */}
      <HeroSection />
      
      {/* CategorÃ­as Destacadas */}
      <section className="py-12 bg-gray-50">
        <div className="container mx-auto px-4">
          <h2 className="text-3xl font-bold text-center mb-8">
            CategorÃ­as Destacadas
          </h2>
          <FeaturedCategories />
        </div>
      </section>
      
      {/* Productos Destacados */}
      <section className="py-12">
        <div className="container mx-auto px-4">
          <h2 className="text-3xl font-bold text-center mb-8">
            Productos Destacados
          </h2>
          <FeaturedProducts />
        </div>
      </section>
      
      {/* Ofertas Especiales */}
      <section className="py-12 bg-primary-50">
        <div className="container mx-auto px-4">
          <SpecialOffers />
        </div>
      </section>
      
      {/* Newsletter */}
      <section className="py-12 bg-gray-900 text-white">
        <div className="container mx-auto px-4 text-center">
          <Newsletter />
        </div>
      </section>
    </div>
  )
}
```

## ğŸš€ Deployment

### 1. ConfiguraciÃ³n de Docker

```dockerfile
# Dockerfile para Backend
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .

RUN npx prisma generate
RUN npm run build

EXPOSE 3001

CMD ["npm", "run", "start:prod"]
```

### 2. Docker Compose para Desarrollo

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_USER: iai_tech
      POSTGRES_PASSWORD: password
      POSTGRES_DB: iai_tech_db
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  api:
    build: ./apps/api
    ports:
      - "3001:3001"
    environment:
      DATABASE_URL: postgresql://iai_tech:password@postgres:5432/iai_tech_db
      REDIS_URL: redis://redis:6379
      JWT_SECRET: your-jwt-secret
    depends_on:
      - postgres
      - redis
    volumes:
      - ./apps/api:/app
      - /app/node_modules

  web:
    build: ./apps/web
    ports:
      - "3000:3000"
    environment:
      NEXT_PUBLIC_API_URL: http://localhost:3001
    volumes:
      - ./apps/web:/app
      - /app/node_modules

volumes:
  postgres_data:
```

### 3. Scripts de Deployment

```json
{
  "scripts": {
    "dev": "docker-compose up -d",
    "build": "docker-compose build",
    "deploy:frontend": "vercel --prod",
    "deploy:backend": "railway up",
    "db:migrate": "npx prisma migrate deploy",
    "db:seed": "npx prisma db seed"
  }
}
```

## ğŸ§ª Testing

### 1. Testing Backend

```typescript
// src/products/products.service.spec.ts
describe('ProductsService', () => {
  let service: ProductsService
  let prisma: PrismaService

  beforeEach(async () => {
    const module: TestingModule = await Test.createTestingModule({
      providers: [ProductsService, PrismaService],
    }).compile()

    service = module.get<ProductsService>(ProductsService)
    prisma = module.get<PrismaService>(PrismaService)
  })

  describe('findAll', () => {
    it('should return filtered products', async () => {
      const mockProducts = [
        {
          id: '1',
          name: 'CÃ¡mara IP WiFi',
          price: 89990,
          salePrice: 79990,
          category: { name: 'CÃ¡maras de Seguridad' }
        }
      ]
      
      jest.spyOn(prisma.product, 'findMany').mockResolvedValue(mockProducts)
      
      const result = await service.findAll({
        page: 1,
        limit: 10,
        categoryId: 'security'
      })
      
      expect(result).toEqual(mockProducts)
      expect(prisma.product.findMany).toHaveBeenCalledWith({
        where: { isActive: true, categoryId: 'security' },
        include: { category: true },
        orderBy: { createdAt: 'desc' },
        skip: 0,
        take: 10
      })
    })
  })
})
```

### 2. Testing Frontend

```typescript
// src/components/product/product-card.test.tsx
import { render, screen, fireEvent } from '@testing-library/react'
import { ProductCard } from './product-card'
import { useCart } from '@/store/cart-store'

jest.mock('@/store/cart-store')

const mockProduct = {
  id: '1',
  name: 'CÃ¡mara IP WiFi HD',
  price: 89990,
  salePrice: 79990,
  images: ['/camera1.jpg'],
  stock: 5,
  slug: 'camara-ip-wifi-hd'
}

describe('ProductCard', () => {
  const mockAddToCart = jest.fn()
  
  beforeEach(() => {
    (useCart as jest.Mock).mockReturnValue({
      addToCart: mockAddToCart
    })
  })

  it('renders product information correctly', () => {
    render(<ProductCard product={mockProduct} />)
    
    expect(screen.getByText('CÃ¡mara IP WiFi HD')).toBeInTheDocument()
    expect(screen.getByText('$79.990')).toBeInTheDocument()
    expect(screen.getByText('$89.990')).toBeInTheDocument()
    expect(screen.getByText('Stock: 5')).toBeInTheDocument()
  })

  it('calculates discount percentage correctly', () => {
    render(<ProductCard product={mockProduct} />)
    expect(screen.getByText('-11%')).toBeInTheDocument()
  })

  it('calls addToCart when button is clicked', () => {
    render(<ProductCard product={mockProduct} />)
    
    const addButton = screen.getByText('Agregar al Carrito')
    fireEvent.click(addButton)
    
    expect(mockAddToCart).toHaveBeenCalledWith(mockProduct)
  })
})
```

## ğŸ“± Funcionalidades Avanzadas

### 1. Sistema de ComparaciÃ³n de Productos

```typescript
// src/store/comparison-store.ts
interface ComparisonStore {
  products: Product[]
  addProduct: (product: Product) => void
  removeProduct: (id: string) => void
  clearComparison: () => void
  isInComparison: (id: string) => boolean
}

export const useComparison = create<ComparisonStore>()((set, get) => ({
  products: [],
  
  addProduct: (product) => {
    const products = get().products
    if (products.length >= 4) {
      toast.error('MÃ¡ximo 4 productos para comparar')
      return
    }
    if (products.find(p => p.id === product.id)) return
    
    set({ products: [...products, product] })
    toast.success('Producto agregado a comparaciÃ³n')
  },
  
  removeProduct: (id) => {
    set({ products: get().products.filter(p => p.id !== id) })
  },
  
  clearComparison: () => set({ products: [] }),
  
  isInComparison: (id) => get().products.some(p => p.id === id)
}))
```

### 2. Sistema de Wishlist

```typescript
// src/store/wishlist-store.ts
interface WishlistStore {
  items: string[]
  addItem: (productId: string) => void
  removeItem: (productId: string) => void
  isInWishlist: (productId: string) => boolean
  clearWishlist: () => void
}

export const useWishlist = create<WishlistStore>()(
  persist(
    (set, get) => ({
      items: [],
      
      addItem: (productId) => {
        const items = get().items
        if (!items.includes(productId)) {
          set({ items: [...items, productId] })
          toast.success('Agregado a favoritos')
        }
      },
      
      removeItem: (productId) => {
        set({ items: get().items.filter(id => id !== productId) })
        toast.success('Removido de favoritos')
      },
      
      isInWishlist: (productId) => get().items.includes(productId),
      
      clearWishlist: () => set({ items: [] })
    }),
    { name: 'wishlist-storage' }
  )
)
```

### 3. Sistema de Reviews y Ratings

```typescript
// Backend: src/reviews/reviews.service.ts
@Injectable()
export class ReviewsService {
  constructor(private prisma: PrismaService) {}

  async createReview(userId: string, productId: string, data: CreateReviewDto) {
    // Verificar que el usuario haya comprado el producto
    const hasPurchased = await this.prisma.order.findFirst({
      where: {
        userId,
        status: 'DELIVERED',
        items: {
          some: { productId }
        }
      }
    })

    if (!hasPurchased) {
      throw new ForbiddenException('Debes haber comprado el producto para reseÃ±arlo')
    }

    return this.prisma.review.create({
      data: {
        userId,
        productId,
        rating: data.rating,
        comment: data.comment,
        title: data.title
      }
    })
  }

  async getProductReviews(productId: string, page = 1, limit = 10) {
    const reviews = await this.prisma.review.findMany({
      where: { productId },
      include: {
        user: { select: { firstName: true, lastName: true } }
      },
      orderBy: { createdAt: 'desc' },
      skip: (page - 1) * limit,
      take: limit
    })

    const stats = await this.prisma.review.aggregate({
      where: { productId },
      _avg: { rating: true },
      _count: { rating: true }
    })

    return {
      reviews,
      averageRating: stats._avg.rating || 0,
      totalReviews: stats._count.rating
    }
  }
}
```

### 4. Sistema de Cupones y Descuentos

```typescript
// Backend: src/coupons/coupons.service.ts
@Injectable()
export class CouponsService {
  async validateCoupon(code: string, orderTotal: number, userId: string) {
    const coupon = await this.prisma.coupon.findUnique({
      where: { code },
      include: { usages: true }
    })

    if (!coupon) {
      throw new NotFoundException('CupÃ³n no encontrado')
    }

    // Validaciones
    const now = new Date()
    if (coupon.expiresAt && now > coupon.expiresAt) {
      throw new BadRequestException('CupÃ³n expirado')
    }

    if (coupon.maxUses && coupon.usages.length >= coupon.maxUses) {
      throw new BadRequestException('CupÃ³n agotado')
    }

    if (coupon.minOrderAmount && orderTotal < coupon.minOrderAmount) {
      throw new BadRequestException(`Monto mÃ­nimo requerido: ${coupon.minOrderAmount}`)
    }

    // Verificar uso por usuario
    const userUsage = coupon.usages.filter(u => u.userId === userId)
    if (coupon.maxUsesPerUser && userUsage.length >= coupon.maxUsesPerUser) {
      throw new BadRequestException('Has alcanzado el lÃ­mite de uso de este cupÃ³n')
    }

    return coupon
  }

  calculateDiscount(coupon: Coupon, orderTotal: number) {
    if (coupon.type === 'PERCENTAGE') {
      const discount = (orderTotal * coupon.value) / 100
      return Math.min(discount, coupon.maxDiscountAmount || discount)
    } else {
      return Math.min(coupon.value, orderTotal)
    }
  }
}
```

## ğŸ” Seguridad y AutenticaciÃ³n

### 1. ImplementaciÃ³n de JWT

```typescript
// Backend: src/auth/auth.service.ts
@Injectable()
export class AuthService {
  constructor(
    private usersService: UsersService,
    private jwtService: JwtService
  ) {}

  async validateUser(email: string, password: string) {
    const user = await this.usersService.findByEmail(email)
    
    if (user && await bcrypt.compare(password, user.password)) {
      const { password, ...result } = user
      return result
    }
    return null
  }

  async login(user: any) {
    const payload = { email: user.email, sub: user.id, role: user.role }
    
    return {
      access_token: this.jwtService.sign(payload),
      user: {
        id: user.id,
        email: user.email,
        firstName: user.firstName,
        lastName: user.lastName,
        role: user.role
      }
    }
  }

  async register(createUserDto: CreateUserDto) {
    const existingUser = await this.usersService.findByEmail(createUserDto.email)
    
    if (existingUser) {
      throw new ConflictException('El email ya estÃ¡ registrado')
    }

    const hashedPassword = await bcrypt.hash(createUserDto.password, 10)
    const user = await this.usersService.create({
      ...createUserDto,
      password: hashedPassword
    })

    return this.login(user)
  }
}
```

### 2. Middleware de AutenticaciÃ³n Frontend

```typescript
// src/middleware.ts
import { NextResponse } from 'next/server'
import type { NextRequest } from 'next/server'
import { jwtVerify } from 'jose'

const protectedRoutes = ['/admin', '/profile', '/orders']
const authRoutes = ['/login', '/register']

export async function middleware(request: NextRequest) {
  const { pathname } = request.nextUrl
  const token = request.cookies.get('token')?.value

  // Verificar si la ruta requiere autenticaciÃ³n
  const isProtectedRoute = protectedRoutes.some(route => 
    pathname.startsWith(route)
  )
  
  const isAuthRoute = authRoutes.some(route => 
    pathname.startsWith(route)
  )

  if (isProtectedRoute && !token) {
    return NextResponse.redirect(new URL('/login', request.url))
  }

  if (isAuthRoute && token) {
    try {
      await jwtVerify(token, new TextEncoder().encode(process.env.JWT_SECRET))
      return NextResponse.redirect(new URL('/', request.url))
    } catch {
      // Token invÃ¡lido, permitir acceso a rutas de auth
    }
  }

  // Verificar permisos de admin
  if (pathname.startsWith('/admin') && token) {
    try {
      const { payload } = await jwtVerify(
        token, 
        new TextEncoder().encode(process.env.JWT_SECRET)
      )
      
      if (payload.role !== 'ADMIN') {
        return NextResponse.redirect(new URL('/', request.url))
      }
    } catch {
      return NextResponse.redirect(new URL('/login', request.url))
    }
  }

  return NextResponse.next()
}

export const config = {
  matcher: ['/admin/:path*', '/profile/:path*', '/orders/:path*', '/login', '/register']
}
```

## ğŸ“Š Analytics y SEO

### 1. ConfiguraciÃ³n de SEO

```typescript
// src/app/productos/[slug]/page.tsx
export async function generateMetadata({ params }: { params: { slug: string } }) {
  const product = await getProductBySlug(params.slug)
  
  if (!product) {
    return {
      title: 'Producto no encontrado | IAI Tech',
    }
  }

  return {
    title: `${product.name} | IAI Tech Chile`,
    description: product.description.substring(0, 160),
    keywords: [product.name, product.category.name, 'IAI Tech', 'Chile', 'tecnologÃ­a'],
    openGraph: {
      title: product.name,
      description: product.description,
      images: [
        {
          url: product.images[0],
          width: 800,
          height: 600,
          alt: product.name,
        }
      ],
      type: 'product',
      siteName: 'IAI Tech Chile',
    },
    twitter: {
      card: 'summary_large_image',
      title: product.name,
      description: product.description,
      images: [product.images[0]],
    },
    alternates: {
      canonical: `https://iai-tech.cl/productos/${product.slug}`,
    }
  }
}
```

### 2. Structured Data (JSON-LD)

```typescript
// src/components/seo/product-schema.tsx
interface ProductSchemaProps {
  product: Product
  reviews?: { averageRating: number; totalReviews: number }
}

export function ProductSchema({ product, reviews }: ProductSchemaProps) {
  const schema = {
    "@context": "https://schema.org/",
    "@type": "Product",
    "name": product.name,
    "description": product.description,
    "image": product.images,
    "sku": product.sku,
    "brand": {
      "@type": "Brand",
      "name": "IAI Tech"
    },
    "offers": {
      "@type": "Offer",
      "price": (product.salePrice || product.price).toString(),
      "priceCurrency": "CLP",
      "availability": product.stock > 0 ? "https://schema.org/InStock" : "https://schema.org/OutOfStock",
      "seller": {
        "@type": "Organization",
        "name": "IAI Tech Chile"
      }
    },
    ...(reviews && {
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": reviews.averageRating,
        "reviewCount": reviews.totalReviews
      }
    })
  }

  return (
    <script
      type="application/ld+json"
      dangerouslySetInnerHTML={{ __html: JSON.stringify(schema) }}
    />
  )
}
```

## ğŸš€ Comandos de Deployment y Mantenimiento

### 1. Scripts de ProducciÃ³n

```bash
#!/bin/bash
# scripts/deploy.sh

echo "ğŸš€ Iniciando deployment de IAI Tech E-commerce..."

# Build y test
echo "ğŸ“¦ Building aplicaciones..."
cd apps/web && npm run build
cd ../api && npm run build

# Tests
echo "ğŸ§ª Ejecutando tests..."
cd ../web && npm run test
cd ../api && npm run test:e2e

# Deploy frontend
echo "ğŸŒ Deploying frontend a Vercel..."
cd ../web && vercel --prod

# Deploy backend
echo "ğŸ”§ Deploying backend a Railway..."
cd ../api && railway up

# Ejecutar migraciones
echo "ğŸ’¾ Ejecutando migraciones de base de datos..."
npm run db:migrate

echo "âœ… Deployment completado!"
```

### 2. Monitoreo y Health Checks

```typescript
// Backend: src/health/health.controller.ts
@Controller('health')
export class HealthController {
  constructor(
    private health: HealthCheckService,
    private db: PrismaHealthIndicator,
    private redis: RedisHealthIndicator,
  ) {}

  @Get()
  @HealthCheck()
  check() {
    return this.health.check([
      () => this.db.pingCheck('database'),
      () => this.redis.pingCheck('redis'),
    ])
  }

  @Get('detailed')
  async detailedHealth() {
    const dbStatus = await this.checkDatabase()
    const redisStatus = await this.checkRedis()
    const memoryUsage = process.memoryUsage()
    
    return {
      timestamp: new Date().toISOString(),
      status: 'healthy',
      version: process.env.npm_package_version,
      uptime: process.uptime(),
      database: dbStatus,
      redis: redisStatus,
      memory: {
        used: Math.round(memoryUsage.heapUsed / 1024 / 1024),
        total: Math.round(memoryUsage.heapTotal / 1024 / 1024),
        external: Math.round(memoryUsage.external / 1024 / 1024),
      }
    }
  }
}
```

## ğŸ“ DocumentaciÃ³n de API

### 1. Swagger/OpenAPI

```typescript
// Backend: src/main.ts
async function bootstrap() {
  const app = await NestFactory.create(AppModule)
  
  // Swagger configuration
  const config = new DocumentBuilder()
    .setTitle('IAI Tech E-commerce API')
    .setDescription('API para el sistema de e-commerce de IAI Tech')
    .setVersion('1.0')
    .addBearerAuth()
    .addTag('products', 'GestiÃ³n de productos')
    .addTag('categories', 'CategorÃ­as de productos')
    .addTag('orders', 'GestiÃ³n de pedidos')
    .addTag('users', 'GestiÃ³n de usuarios')
    .addTag('auth', 'AutenticaciÃ³n')
    .build()
    
  const document = SwaggerModule.createDocument(app, config)
  SwaggerModule.setup('api/docs', app, document)
  
  await app.listen(3001)
}
```

## ğŸ¯ Checklist Final de ImplementaciÃ³n

### âœ… Funcionalidades Core
- [ ] Sistema de autenticaciÃ³n completo
- [ ] CatÃ¡logo de productos con filtros
- [ ] Carrito de compras persistente
- [ ] Sistema de checkout
- [ ] GestiÃ³n de pedidos
- [ ] Panel de administraciÃ³n
- [ ] BÃºsqueda y filtros avanzados
- [ ] Responsive design

### âœ… CaracterÃ­sticas Avanzadas
- [ ] Sistema de reviews y ratings
- [ ] Wishlist/Favoritos
- [ ] ComparaciÃ³n de productos
- [ ] Cupones y descuentos
- [ ] Notificaciones push
- [ ] Recomendaciones de productos
- [ ] Chat en vivo
- [ ] MÃºltiples mÃ©todos de pago

### âœ… OptimizaciÃ³n y Performance
- [ ] Lazy loading de imÃ¡genes
- [ ] Caching de Redis
- [ ] OptimizaciÃ³n de consultas DB
- [ ] CompresiÃ³n de assets
- [ ] CDN para imÃ¡genes
- [ ] Server-side rendering
- [ ] Sitemap automÃ¡tico
- [ ] Meta tags dinÃ¡micos

### âœ… Seguridad
- [ ] ValidaciÃ³n de inputs
- [ ] Rate limiting
- [ ] CORS configurado
- [ ] Headers de seguridad
- [ ] SanitizaciÃ³n de datos
- [ ] Logs de seguridad
- [ ] Backup automÃ¡tico
- [ ] SSL/HTTPS

### âœ… Testing y Calidad
- [ ] Unit tests (>80% coverage)
- [ ] Integration tests
- [ ] E2E tests
- [ ] Performance tests
- [ ] Accessibility tests
- [ ] SEO audit
- [ ] Lighthouse score >90
- [ ] Code quality (ESLint/Prettier)

## ğŸš§ PrÃ³ximos Pasos y Mejoras

1. **Implementar PWA** - Service workers y app manifest
2. **Inteligencia Artificial** - Recomendaciones personalizadas
3. **Marketplace** - Permitir mÃºltiples vendedores
4. **AplicaciÃ³n MÃ³vil** - React Native o Flutter
5. **LogÃ­stica Avanzada** - Tracking en tiempo real
6. **Business Intelligence** - Dashboard de analytics
7. **InternacionalizaciÃ³n** - Soporte multi-idioma
8. **API PÃºblica** - Para integraciones externas

---

## ğŸ“ Soporte y Contacto

Para dudas sobre la implementaciÃ³n:
- ğŸ“§ Email: dev@iai-tech.cl
- ğŸ’¬ Slack: #iai-tech-dev
- ğŸ“š DocumentaciÃ³n: [docs.iai-tech.cl](https://docs.iai-tech.cl)

**Â¡Que tengas un excelente desarrollo! ğŸš€**