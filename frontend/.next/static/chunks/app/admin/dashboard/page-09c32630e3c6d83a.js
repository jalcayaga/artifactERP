(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8427],{2686:function(e,t,r){Promise.resolve().then(r.bind(r,8157))},8157:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return y}});var a=r(7437),o=r(2265),s=r(6070),l=r(8560),n=r(5678),c=r(6476),i=r(4508),d=()=>{let e=(0,o.useRef)(null),t=(0,o.useRef)(null),{theme:r}=(0,c.F)(),[s,l]=(0,o.useState)(0);return(0,o.useEffect)(()=>{l(e=>e+1)},[r]),(0,o.useEffect)(()=>{if(!e.current)return;let r=e.current.getContext("2d");if(!r)return;t.current&&t.current.destroy();let a=getComputedStyle(document.documentElement),o=a.getPropertyValue("--primary-hsl-values").trim(),s=a.getPropertyValue("--card-foreground-hsl-values").trim(),l=a.getPropertyValue("--muted-foreground-hsl-values").trim(),c=a.getPropertyValue("--border-hsl-values").trim(),d=a.getPropertyValue("--card-hsl-values").trim(),u="hsl(".concat(o,")"),m="hsla(".concat(o,", 0.2)"),h="hsl(".concat(s,")"),f="hsl(".concat(l,")"),g="hsla(".concat(c,", 0.5)"),p="hsl(".concat(d,")");return t.current=new n.ZP(r,{type:"line",data:{labels:["Enero","Febrero","Marzo","Abril","Mayo","Junio"],datasets:[{label:"Ventas del Mes",data:[125e4,198e4,153e4,225e4,187e4,256e4],borderColor:u,backgroundColor:m,fill:!0,tension:.35,pointBackgroundColor:u,pointBorderColor:p,pointBorderWidth:2,pointRadius:4,pointHoverRadius:6,pointHoverBackgroundColor:u,pointHoverBorderColor:p,pointHoverBorderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!1,grid:{color:g},ticks:{color:f,padding:8,callback:function(e){return"number"==typeof e?Math.abs(e)>=1e6?"$".concat((e/1e6).toFixed(1),"M"):Math.abs(e)>=1e3?"$".concat((e/1e3).toFixed(0),"K"):(0,i.eQ)(e):e}}},x:{grid:{display:!1},ticks:{color:f,padding:8}}},plugins:{legend:{display:!1},tooltip:{backgroundColor:p,titleColor:h,bodyColor:h,borderColor:g,borderWidth:1,padding:12,cornerRadius:4,usePointStyle:!0,callbacks:{label:function(e){let t=e.dataset.label||"";return t&&(t+=": "),null!==e.parsed.y&&(t+=(0,i.eQ)(e.parsed.y)),t}}}},interaction:{mode:"index",intersect:!1}}}),()=>{t.current&&(t.current.destroy(),t.current=null)}},[r,s]),(0,a.jsx)("div",{style:{height:"350px",position:"relative"},children:(0,a.jsx)("canvas",{ref:e,role:"img","aria-label":"Gr\xe1fico de resumen de ventas mensuales"})},s)},u=r(3464);let m=r(257).env.NEXT_PUBLIC_API_URL||"http://localhost:3001",h={async getStats(e){try{return(await u.Z.get("".concat(m,"/dashboard"),{headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){throw console.error("Error fetching dashboard stats:",e),e}}};var f=r(2779);let g=e=>{let{title:t,value:r,icon:o}=e;return(0,a.jsx)(s.Zb,{className:"overflow-hidden",children:(0,a.jsxs)(s.aY,{className:"p-5",children:[" ",(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg bg-primary/10 dark:bg-primary/20 mr-4",children:(0,a.jsx)(o,{className:"w-6 h-6 text-primary"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:t}),(0,a.jsx)("p",{className:"text-2xl font-semibold text-foreground",children:r})]})]})]})})},p="wolfflow_dashboard_tasks",x=[{id:1,text:"Revisar propuesta Cliente Alfa",due:"Ma\xf1ana",completed:!1},{id:2,text:"Contactar Proveedor Beta",due:"En 3 d\xedas",completed:!1},{id:3,text:"Generar reporte de ventas Q3",due:"Pr\xf3xima semana",completed:!1},{id:4,text:"Actualizar inventario",due:"Hoy",completed:!0}];var v=()=>{let{token:e}=(0,f.a)(),[t,r]=(0,o.useState)(()=>{try{let e=localStorage.getItem(p);if(e)return JSON.parse(e).map(e=>({...e,completed:e.completed||!1}))}catch(e){console.error("Error loading tasks from localStorage:",e)}return x}),[n,c]=(0,o.useState)(null),[u,m]=(0,o.useState)(!0),[v,y]=(0,o.useState)(null);(0,o.useEffect)(()=>{(async()=>{if(!e){y("No autorizado. Por favor, inicie sesi\xf3n como administrador."),m(!1);return}try{let t=await h.getStats(e);c(t)}catch(e){console.error("Error fetching dashboard stats:",e),y("Error al cargar las estad\xedsticas del dashboard.")}finally{m(!1)}})()},[e]),(0,o.useEffect)(()=>{try{localStorage.setItem(p,JSON.stringify(t))}catch(e){console.error("Error saving tasks to localStorage:",e)}},[t]);let N=(0,o.useCallback)(e=>{r(t=>t.map(t=>t.id===e?{...t,completed:!t.completed}:t))},[]),w=(null==n?void 0:n.recentActivities.map(e=>({id:e.id,user:"".concat(e.user.firstName," ").concat(e.user.lastName),action:"cre\xf3 un pedido con estado ".concat(e.status),time:new Date(e.createdAt).toLocaleDateString(),avatar:"https://placehold.co/40x40/EFEFEF/31343C?text=".concat(e.user.firstName.charAt(0))})))||[];return(0,a.jsxs)("div",{className:"space-y-6 lg:space-y-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-semibold text-foreground",children:"Dashboard General"}),u?(0,a.jsx)("p",{children:"Cargando estad\xedsticas..."}):v?(0,a.jsx)("p",{className:"text-destructive",children:v}):(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsx)(g,{title:"Clientes Activos",value:(null==n?void 0:n.totalUsers.toString())||"N/A",icon:l.oy}),(0,a.jsx)(g,{title:"Ventas del Mes",value:(0,i.eQ)((null==n?void 0:n.totalSalesAmount)||0),icon:l.Q1}),(0,a.jsx)(g,{title:"Productos en Stock",value:(null==n?void 0:n.totalProducts.toString())||"N/A",icon:l.vx}),(0,a.jsx)(g,{title:"Facturas Pendientes",value:(null==n?void 0:n.pendingInvoices.toString())||"N/A",icon:l.ci})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 lg:gap-8",children:[(0,a.jsxs)(s.Zb,{className:"lg:col-span-2",children:[(0,a.jsxs)(s.Ol,{children:[" ",(0,a.jsx)(s.ll,{className:"text-xl text-primary",children:"Actividad Reciente"})]}),(0,a.jsxs)(s.aY,{children:[" ",(0,a.jsx)("ul",{className:"space-y-4",children:w.length>0?w.map(e=>(0,a.jsxs)("li",{className:"flex items-start space-x-3",children:[(0,a.jsx)("img",{className:"w-10 h-10 rounded-full",src:e.avatar,alt:e.user}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-foreground",children:[(0,a.jsx)("span",{className:"font-medium",children:e.user})," ",e.action,"."]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.time})]})]},e.id)):(0,a.jsx)("p",{className:"text-sm text-muted-foreground italic text-center py-4",children:"No hay actividad reciente."})}),(0,a.jsx)("div",{className:"mt-6 text-right",children:(0,a.jsx)("button",{className:"text-sm font-medium text-primary hover:text-primary/80 dark:hover:text-primary/70",children:"Ver toda la actividad"})})]})]}),(0,a.jsxs)(s.Zb,{children:[(0,a.jsxs)(s.Ol,{children:[" ",(0,a.jsx)(s.ll,{className:"text-lg",children:"Tareas Pendientes"})]}),(0,a.jsxs)(s.aY,{children:[" ",t.length>0?(0,a.jsx)("ul",{className:"space-y-3",children:t.map(e=>(0,a.jsxs)("li",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 ".concat(e.completed?"opacity-60":""),children:[(0,a.jsx)("label",{htmlFor:"task-".concat(e.id),className:"text-sm font-medium text-foreground cursor-pointer ".concat(e.completed?"line-through":""),children:e.text}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground ".concat(e.completed?"line-through":""),children:["Vence: ",e.due]})]}),(0,a.jsx)("input",{id:"task-".concat(e.id),type:"checkbox",checked:e.completed,onChange:()=>N(e.id),className:"form-checkbox h-4 w-4 text-primary rounded border-border focus:ring-primary ml-3 flex-shrink-0"})]},e.id))}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground italic text-center py-4",children:"No hay tareas pendientes."}),(0,a.jsx)("div",{className:"mt-4 text-right",children:(0,a.jsx)("button",{className:"text-sm font-medium text-primary hover:text-primary/80 dark:hover:text-primary/70",children:"Ver todas las tareas"})})]})]})]}),(0,a.jsxs)(s.Zb,{children:[(0,a.jsxs)(s.Ol,{children:[" ",(0,a.jsx)(s.ll,{className:"text-lg",children:"Resumen de Ventas"})]}),(0,a.jsxs)(s.aY,{className:"p-5",children:[" ",(0,a.jsx)(d,{})]})]})]})};function y(){return(0,a.jsx)(v,{})}},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return n},SZ:function(){return i},Zb:function(){return l},aY:function(){return d},eW:function(){return u},ll:function(){return c}});var a=r(7437),o=r(2265),s=r(4508);let l=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("rounded-xl bg-card text-card-foreground shadow-sm","border border-border","transition-all duration-200 ease-in-out","hover:shadow-lg dark:hover:shadow-primary/20","hover:border-border dark:hover:border-primary/40","dark:hover:bg-muted/20",r),...o})});l.displayName="Card";let n=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-5",r),...o})});n.displayName="CardHeader";let c=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)("h3",{ref:t,className:(0,s.cn)("text-xl font-semibold leading-none tracking-tight",r),...o})});c.displayName="CardTitle";let i=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...o})});i.displayName="CardDescription";let d=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("p-5 pt-0",r),...o})});d.displayName="CardContent";let u=o.forwardRef((e,t)=>{let{className:r,...o}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-5 pt-0",r),...o})});u.displayName="CardFooter"},2779:function(e,t,r){"use strict";r.d(t,{H:function(){return i},a:function(){return d}});var a=r(7437),o=r(2265),s=r(3464);let l="http://localhost:3001",n={login:async e=>{try{return(await s.Z.post("".concat(l,"/auth/login"),e)).data}catch(e){throw e}},register:async e=>{let t={email:e.email,password:e.password,firstName:e.firstName,lastName:e.lastName,role:e.role};try{return(await s.Z.post("".concat(l,"/auth/register"),t)).data}catch(e){throw e}}},c=(0,o.createContext)(void 0),i=e=>{let{children:t}=e,[r,s]=(0,o.useState)(null),[l,i]=(0,o.useState)(null),[d,u]=(0,o.useState)(!0);(0,o.useEffect)(()=>{let e=localStorage.getItem("wolfflow_token"),t=localStorage.getItem("wolfflow_user");if(e&&t){s(e);try{i(JSON.parse(t))}catch(e){console.error("Failed to parse stored user:",e),localStorage.removeItem("wolfflow_user"),localStorage.removeItem("wolfflow_token"),s(null),i(null)}}u(!1)},[]);let m=async e=>{u(!0);try{let t=await n.login(e);if(t&&t.access_token&&t.user)return s(t.access_token),i(t.user),localStorage.setItem("wolfflow_token",t.access_token),localStorage.setItem("wolfflow_user",JSON.stringify(t.user)),u(!1),{success:!0};return u(!1),{success:!1,error:t.message||"Login failed: No token or user data received."}}catch(e){var t,r;return u(!1),{success:!1,error:(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||e.message||"An unknown error occurred during login."}}},h=async e=>{u(!0);try{let t=await n.register(e);if(t){let r=await m({email:e.email,password:e.password});return u(!1),{success:r.success,error:r.error,data:t}}return u(!1),{success:!0,data:t}}catch(e){var t,r;return u(!1),{success:!1,error:(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||e.message||"An unknown error occurred during registration."}}};return(0,a.jsx)(c.Provider,{value:{token:r,currentUser:l,isAuthenticated:!!r,isLoading:d,login:m,logout:()=>{u(!0),s(null),i(null),localStorage.removeItem("wolfflow_token"),localStorage.removeItem("wolfflow_user"),u(!1)},register:h},children:t})},d=()=>{let e=(0,o.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6476:function(e,t,r){"use strict";r.d(t,{F:function(){return n},f:function(){return l}});var a=r(7437),o=r(2265);let s=(0,o.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,o.useState)("light"),[n,c]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{let e="light";try{let t=localStorage.getItem("wolfflow_theme");e=t&&("light"===t||"dark"===t)?t:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}catch(e){console.error("Error accessing localStorage or matchMedia for theme:",e)}l(e),c(!0)},[]),(0,o.useEffect)(()=>{if(!n)return;let e=window.document.documentElement;"dark"===r?e.classList.add("dark"):e.classList.remove("dark");try{localStorage.setItem("wolfflow_theme",r)}catch(e){console.error("Error saving theme to localStorage:",e)}},[r,n]),(0,a.jsx)(s.Provider,{value:{theme:r,setTheme:e=>{l(e)}},children:t})},n=()=>{let e=(0,o.useContext)(s);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},4508:function(e,t,r){"use strict";r.d(t,{LH:function(){return c},cn:function(){return s},eQ:function(){return l},fW:function(){return i},p6:function(){return n}});var a=r(1994),o=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m6)((0,a.W)(t))}function l(e){let t=Number(e);if(isNaN(t))return"$0";let r=Math.abs(t),a=(r%1).toFixed(2).substring(2),o=Math.trunc(r).toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),s="$".concat(o);return"00"!==a&&(s+=",".concat(a)),t<0?"-".concat(s):s}function n(e){try{let t=new Date(e),r=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear();return"".concat(r,"/").concat(a,"/").concat(o)}catch(t){return console.error("Invalid date provided to formatDate:",e),"Fecha inv\xe1lida"}}function c(e){if("string"!=typeof e)return NaN;let t=parseFloat(e.replace(/\$\s?|(,*)/g,"").replace(/\./g,"").replace(",","."));return isNaN(t)?0:t}function i(e){if("string"!=typeof e||(e=e.replace(/\./g,"").replace(/-/g,"")).length<2)return!1;let t=e.slice(0,-1),r=e.slice(-1).toUpperCase(),a=0,o=2;for(let e=t.length-1;e>=0;e--)a+=parseInt(t[e],10)*o,++o>7&&(o=2);let s=11-a%11;return(11===s?"0":10===s?"K":s.toString())===r}}},function(e){e.O(0,[7674,6137,3464,1276,8560,2971,2117,1744],function(){return e(e.s=2686)}),_N_E=e.O()}]);