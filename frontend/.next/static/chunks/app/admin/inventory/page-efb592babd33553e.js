(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3180],{4134:function(e,t,r){Promise.resolve().then(r.bind(r,7553))},7553:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var a=r(7437),s=r(2265),o=r(3985),n=r(6070),l=r(8560),i=r(3464);let c="http://localhost:3001",d={async uploadImage(e){let t=new FormData;t.append("file",e);try{return(await i.Z.post("".concat(c,"/uploads/image"),t,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){throw console.error("Error uploading image:",e),e}},async deleteImage(e){try{await i.Z.delete("".concat(c,"/uploads/").concat(e))}catch(t){throw console.error("Error deleting image ".concat(e,":"),t),t}}};var u=r(9138),m=r(2779),x=r(4508),p=r(4438),h=e=>{let{productData:t,onSave:r,onCancel:o}=e,{token:i}=(0,m.a)(),[c,h]=(0,s.useState)(""),[f,g]=(0,s.useState)("PRODUCT"),[b,v]=(0,s.useState)(""),[N,j]=(0,s.useState)(""),[y,w]=(0,s.useState)(""),[C,k]=(0,s.useState)(""),[E,P]=(0,s.useState)(""),[S,D]=(0,s.useState)(""),[A,T]=(0,s.useState)(""),[I,R]=(0,s.useState)([]),[F,O]=(0,s.useState)([]),[L,U]=(0,s.useState)(null),[_,V]=(0,s.useState)(null),[M,B]=(0,s.useState)(!0),[Q,z]=(0,s.useState)({}),[H,Y]=(0,s.useState)("30"),[Z,G]=(0,s.useState)(null),X=(0,s.useMemo)(()=>{let e=parseFloat(E);return isNaN(e)?0:1.19*e},[E]);(0,s.useEffect)(()=>{if(t){var e,r;h(t.name),g(t.productType),v(t.sku||""),j(t.description||""),w(t.longDescription||""),k(t.category||""),P(t.price.toString()),D((null===(e=t.unitPrice)||void 0===e?void 0:e.toString())||""),T((null===(r=t.reorderLevel)||void 0===r?void 0:r.toString())||""),R(t.images||[]),V(t.technicalSheetUrl||null),B(t.isPublished),t.id&&u.M.getAverageCost(t.id,i).then(e=>{G(e.averageCost)})}else h(""),g("PRODUCT"),v(""),j(""),w(""),k(""),P(""),D(""),T(""),R([]),O([]),U(null),V(null),B(!0),G(null);z({})},[t,i]);let q=async e=>{let t=I[e].split("/").pop();if(t&&i)try{await d.deleteImage(t),R(t=>t.filter((t,r)=>r!==e))}catch(e){console.error("Error deleting image from backend:",e)}},K=e=>{O(t=>t.filter((t,r)=>r!==e))},W=async()=>{if(t&&t.id&&i)try{await u.M.deleteTechnicalSheet(t.id,i),V(null),U(null)}catch(e){console.error("Error deleting technical sheet:",e),z(e=>({...e,technicalSheet:"Error al eliminar la ficha t\xe9cnica."}))}},J=()=>{let e={};c.trim()||(e.name="El nombre es requerido."),f||(e.type="El tipo es requerido.");let t=parseFloat(E);if((isNaN(t)||t<0)&&(e.price="El precio de venta debe ser un n\xfamero positivo o cero."),S.trim()){let t=parseFloat(S);(isNaN(t)||t<0)&&(e.unitPrice="El precio de costo debe ser un n\xfamero positivo o cero.")}return z(e),0===Object.keys(e).length},$=async e=>{if(e.preventDefault(),!J())return;let a=[];if(F.length>0)try{let e=F.map(e=>d.uploadImage(e));a=(await Promise.all(e)).map(e=>e.url)}catch(e){console.error("Error uploading new images:",e),z({images:"Error al subir las nuevas im\xe1genes."});return}r({id:null==t?void 0:t.id,name:c.trim(),productType:f,sku:b.trim()||void 0,description:N.trim()||void 0,longDescription:y.trim()||void 0,category:C.trim()||void 0,price:parseFloat(E),unitPrice:S.trim()?parseFloat(S):void 0,reorderLevel:A.trim()?parseInt(A,10):void 0,isPublished:M,images:[...I,...a],technicalSheetUrl:_},L)},ee="mt-1 block w-full px-3 py-2 border rounded-md shadow-sm text-sm transition-colors duration-150 bg-background border-border placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-ring text-foreground",et="".concat(ee," pr-8"),er="mt-1 text-xs text-destructive";return(0,a.jsxs)(n.Zb,{className:"max-w-3xl mx-auto border",children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"text-xl flex items-center",children:[(0,a.jsx)(l.vx,{className:"w-6 h-6 mr-2 text-primary"}),t?"Editar: ".concat(t.name):"Nuevo Producto/Servicio"]})}),(0,a.jsxs)("form",{onSubmit:$,children:[(0,a.jsxs)(n.aY,{className:"space-y-5 pt-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"prod-name",className:"block text-sm font-medium text-foreground",children:["Nombre ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"prod-name",value:c,onChange:e=>h(e.target.value),className:ee})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"prod-type",className:"block text-sm font-medium text-foreground",children:["Tipo ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{id:"prod-type",value:f,onChange:e=>g(e.target.value),className:et,children:[(0,a.jsx)("option",{value:"PRODUCT",children:"Producto"}),(0,a.jsx)("option",{value:"SERVICE",children:"Servicio"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"prod-description",className:"block text-sm font-medium text-foreground",children:"Descripci\xf3n Corta"}),(0,a.jsx)("textarea",{id:"prod-description",value:N,onChange:e=>j(e.target.value),rows:2,className:ee})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"prod-long-description",className:"block text-sm font-medium text-foreground",children:"Descripci\xf3n Larga"}),(0,a.jsx)("textarea",{id:"prod-long-description",value:y,onChange:e=>w(e.target.value),rows:4,className:ee})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"prod-sku",className:"block text-sm font-medium text-foreground",children:"SKU"}),(0,a.jsx)("input",{type:"text",id:"prod-sku",value:b,onChange:e=>v(e.target.value),className:ee})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"prod-category",className:"block text-sm font-medium text-foreground",children:"Categor\xeda"}),(0,a.jsx)("input",{type:"text",id:"prod-category",value:C,onChange:e=>k(e.target.value),className:ee})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"prod-unit-price",className:"block text-sm font-medium text-foreground",children:"Precio Costo (sin IVA)"}),(0,a.jsx)("input",{type:"number",id:"prod-unit-price",value:S,onChange:e=>D(e.target.value),className:ee,placeholder:"0.00",step:"0.01"}),Q.unitPrice&&(0,a.jsx)("p",{className:er,children:Q.unitPrice})]}),(0,a.jsxs)("div",{className:"bg-muted/50 p-3 rounded-lg",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Sugerencia de Precio"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"number",value:H,onChange:e=>Y(e.target.value),className:"".concat(ee," w-20 text-center"),placeholder:"30"}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:"% de Utilidad"}),(0,a.jsx)("button",{type:"button",onClick:()=>{let e=parseFloat(S);if(isNaN(e)||e<=0){p.Am.error("Por favor, ingrese un costo unitario v\xe1lido para calcular el precio sugerido.");return}let t=parseFloat(H)/100;if(isNaN(t)){p.Am.error("Por favor, ingrese un margen de utilidad v\xe1lido.");return}P((e*(1+t)).toFixed(2)),p.Am.success("Precio de venta sugerido (sin IVA) ha sido calculado.")},disabled:!S||0>=parseFloat(S),className:"px-3 py-2 bg-secondary hover:bg-secondary/80 text-secondary-foreground text-sm font-medium rounded-md shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:(0,a.jsx)(l.Xk,{className:"w-5 h-5"})})]}),null!==Z&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Costo Promedio Actual: ",(0,x.eQ)(Z)]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"prod-price",className:"block text-sm font-medium text-foreground",children:["Precio Venta (sin IVA) ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"number",id:"prod-price",value:E,onChange:e=>P(e.target.value),className:ee,placeholder:"0.00",step:"0.01"}),Q.price&&(0,a.jsx)("p",{className:er,children:Q.price}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Precio con IVA (19%): ",(0,x.eQ)(X)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"prod-reorder-level",className:"block text-sm font-medium text-foreground",children:"Stock M\xednimo"}),(0,a.jsx)("input",{type:"number",id:"prod-reorder-level",value:A,onChange:e=>T(e.target.value),className:ee,placeholder:"0"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"prod-images",className:"block text-sm font-medium text-foreground",children:"Im\xe1genes"}),(0,a.jsx)("input",{type:"file",id:"prod-images",multiple:!0,accept:"image/*",onChange:e=>{e.target.files&&O(t=>[...t,...Array.from(e.target.files||[])])},className:"mt-1 block w-full text-sm text-foreground file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-primary-foreground hover:file:bg-primary/90"}),(0,a.jsxs)("div",{className:"mt-3 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[I.map((e,t)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:e,alt:"Producto ".concat(t+1),className:"w-full h-24 object-cover rounded-md"}),(0,a.jsx)("button",{type:"button",onClick:()=>q(t),className:"absolute top-1 right-1 bg-destructive/80 text-destructive-foreground rounded-full p-1 text-xs opacity-0 group-hover:opacity-100 transition-opacity",title:"Eliminar imagen existente",children:"X"})]},e)),F.map((e,t)=>(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:URL.createObjectURL(e),alt:"Nueva imagen ".concat(t+1),className:"w-full h-24 object-cover rounded-md"}),(0,a.jsx)("button",{type:"button",onClick:()=>K(t),className:"absolute top-1 right-1 bg-destructive/80 text-destructive-foreground rounded-full p-1 text-xs opacity-0 group-hover:opacity-100 transition-opacity",title:"Eliminar nueva imagen",children:"X"})]},e.name))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-foreground",children:"Ficha T\xe9cnica (PDF)"}),_?(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,a.jsx)(l.YH,{className:"w-5 h-5 text-muted-foreground"}),(0,a.jsx)("a",{href:"http://localhost:3001".concat(_),target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-primary hover:underline",children:"Ver Ficha Actual"}),(0,a.jsx)("button",{type:"button",onClick:W,className:"text-destructive hover:text-destructive/80 p-1 rounded-md",title:"Quitar Ficha T\xe9cnica",children:(0,a.jsx)(l.XH,{className:"w-4 h-4"})})]}):null,(0,a.jsx)("input",{type:"file",id:"prod-technical-sheet",accept:"application/pdf",onChange:e=>{e.target.files&&e.target.files[0]&&U(e.target.files[0])},className:"mt-2 block w-full text-sm text-foreground file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-primary-foreground hover:file:bg-primary/90"}),L&&(0,a.jsxs)("p",{className:"mt-2 text-sm text-muted-foreground",children:["Nuevo archivo seleccionado: ",L.name]}),Q.technicalSheet&&(0,a.jsx)("p",{className:er,children:Q.technicalSheet})]}),(0,a.jsxs)("div",{className:"flex items-center pt-2",children:[(0,a.jsx)("input",{id:"prod-isPublished",type:"checkbox",checked:M,onChange:e=>B(e.target.checked),className:"h-4 w-4 text-primary border-border rounded focus:ring-primary"}),(0,a.jsx)("label",{htmlFor:"prod-isPublished",className:"ml-2 block text-sm text-foreground",children:"Publicado (visible en tienda/cat\xe1logo)"})]})]}),(0,a.jsxs)(n.eW,{className:"flex flex-col sm:flex-row justify-end items-center gap-3 pt-6",children:[(0,a.jsx)("button",{type:"button",onClick:o,className:"w-full sm:w-auto order-2 sm:order-1 px-4 py-2.5 border border-border text-sm font-medium rounded-md text-foreground bg-background hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-ring dark:focus:ring-offset-card transition-colors duration-150",children:"Cancelar"}),(0,a.jsxs)("button",{type:"submit",className:"w-full sm:w-auto order-1 sm:order-2 bg-primary hover:bg-primary/90 text-primary-foreground font-medium py-2.5 px-5 rounded-lg shadow-sm hover:shadow-md transition-all duration-150 flex items-center justify-center space-x-2",children:[(0,a.jsx)(l.pO,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:t?"Actualizar":"Guardar"})]})]})]})]})},f=r(9116),g=e=>{let{lot:t,onClose:r,onSave:o}=e,[n,i]=(0,s.useState)({});if((0,s.useEffect)(()=>{t&&i({lotNumber:t.lotNumber,currentQuantity:t.currentQuantity,purchasePrice:t.purchasePrice,expirationDate:t.expirationDate?new Date(t.expirationDate).toISOString().split("T")[0]:"",location:t.location})},[t]),!t)return null;let c=e=>{let{name:t,value:r}=e.target;i(e=>({...e,[t]:r}))},d=async e=>{e.preventDefault();try{let e=await f.h.patch("/lots/".concat(t.id),n);o(e.data),r()}catch(e){console.error("Error updating lot:",e)}};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",children:(0,a.jsx)("div",{className:"bg-card rounded-lg shadow-xl w-full max-w-md",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("form",{onSubmit:d,children:[(0,a.jsx)("div",{className:"p-5 border-b border-border",children:(0,a.jsxs)("h2",{className:"text-lg font-semibold",children:["Editar Lote #",t.lotNumber]})}),(0,a.jsxs)("div",{className:"p-5 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"lotNumber",className:"block text-sm font-medium text-muted-foreground mb-1",children:"N\xfamero de Lote"}),(0,a.jsx)("input",{type:"text",name:"lotNumber",id:"lotNumber",value:n.lotNumber||"",onChange:c,className:"input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"currentQuantity",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Cantidad Actual"}),(0,a.jsx)("input",{type:"number",name:"currentQuantity",id:"currentQuantity",value:n.currentQuantity||"",onChange:c,className:"input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"purchasePrice",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Precio de Compra"}),(0,a.jsx)("input",{type:"number",step:"0.01",name:"purchasePrice",id:"purchasePrice",value:n.purchasePrice||"",onChange:c,className:"input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"expirationDate",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Fecha de Vencimiento"}),(0,a.jsx)("input",{type:"date",name:"expirationDate",id:"expirationDate",value:n.expirationDate||"",onChange:c,className:"input"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"location",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Ubicaci\xf3n"}),(0,a.jsx)("input",{type:"text",name:"location",id:"location",value:n.location||"",onChange:c,className:"input"})]})]}),(0,a.jsxs)("div",{className:"px-5 py-3 bg-muted/50 border-t border-border flex justify-end space-x-2",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"btn btn-ghost",children:"Cancelar"}),(0,a.jsxs)("button",{type:"submit",className:"btn btn-primary",children:[(0,a.jsx)(l.N,{className:"w-4 h-4 mr-2"})," Guardar"]})]})]})})})},b=e=>{let{productId:t}=e,[r,o]=(0,s.useState)([]),[n,i]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{t&&(async()=>{i(!0);try{let e=await f.h.get("/products/".concat(t,"/purchases"));console.log("Historial de compras recibido:",e.data),o(e.data)}catch(e){console.error("Error fetching purchase history:",e),o([])}finally{i(!1)}})()},[t]),n)?(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cargando historial de compras..."}):0===r.length?(0,a.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"No hay historial de compras para este producto."}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-md font-semibold text-foreground mb-3 flex items-center",children:[(0,a.jsx)(l.Q1,{className:"w-5 h-5 mr-2 opacity-80"}),"Historial de Compras"]}),(0,a.jsx)("div",{className:"border border-border rounded-lg overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-border/50 text-sm",children:[(0,a.jsx)("thead",{className:"bg-muted/50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Fecha"}),(0,a.jsx)("th",{scope:"col",className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Proveedor"}),(0,a.jsx)("th",{scope:"col",className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Cantidad"}),(0,a.jsx)("th",{scope:"col",className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Precio Unit."}),(0,a.jsx)("th",{scope:"col",className:"px-3 py-2 text-left font-medium text-muted-foreground",children:"Estado"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-border bg-background",children:r.map(e=>{var r,s;let o=null===(r=e.items)||void 0===r?void 0:r.find(e=>e.productId===t);return o?(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-muted-foreground",children:(0,x.p6)(e.purchaseDate)}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap font-medium text-foreground",children:(null===(s=e.company)||void 0===s?void 0:s.name)||"N/A"}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap",children:o.quantity}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap",children:(0,x.eQ)(o.unitPrice)}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap",children:(0,a.jsx)("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",children:e.status})})]},e.id):null})})]})})})]})};let v=e=>{let t,{label:r,value:s,icon:o,isCurrency:n=!1}=e;return t=n&&"number"==typeof s?(0,x.eQ)(s):"boolean"==typeof s?s?(0,a.jsxs)("span",{className:"flex items-center text-emerald-600 dark:text-emerald-400",children:[(0,a.jsx)(l.rE,{className:"w-4 h-4 mr-1.5"})," S\xed"]}):(0,a.jsxs)("span",{className:"flex items-center text-amber-600 dark:text-amber-400",children:[(0,a.jsx)(l.oO,{className:"w-4 h-4 mr-1.5"})," No"]}):null==s||"string"==typeof s&&""===s.trim()?(0,a.jsx)("span",{className:"italic text-muted-foreground",children:"N/A"}):s,(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start py-2",children:[(0,a.jsxs)("dt",{className:"w-full sm:w-2/5 md:w-1/3 text-sm font-medium text-muted-foreground flex items-center",children:[o&&(0,a.jsx)(o,{className:"w-4 h-4 mr-2 opacity-70 flex-shrink-0"}),r]}),(0,a.jsx)("dd",{className:"w-full sm:w-3/5 md:w-2/3 mt-1 sm:mt-0 text-sm text-foreground break-words",children:t})]})};var N=e=>{let{product:t,onClose:r}=e,[o,n]=(0,s.useState)([]),[i,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null);if((0,s.useEffect)(()=>{t&&"PRODUCT"===t.productType&&(async()=>{c(!0);try{let e=await f.h.get("/products/".concat(t.id,"/lots"));n(e.data)}catch(e){console.error("Error fetching lots for product ".concat(t.id,":"),e),n([])}finally{c(!1)}})()},[t]),(0,s.useEffect)(()=>{if(!t)return;let e=e=>{"Escape"===e.key&&r()};return window.addEventListener("keydown",e),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,r]),!t)return null;let m="PRODUCT"===t.productType?l.FM:l.vx;return(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 dark:bg-black/75 p-4 transition-opacity duration-300 ease-in-out",onClick:r,role:"dialog","aria-modal":"true","aria-labelledby":"product-detail-modal-title",children:[(0,a.jsxs)("div",{className:"bg-card text-card-foreground rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden border border-border",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between p-4 sm:p-5 border-b border-border",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[t.images&&t.images.length>0?(0,a.jsx)("img",{src:t.images[0],alt:t.name,className:"w-16 h-16 sm:w-20 sm:h-20 rounded-lg object-cover mr-3 sm:mr-4"}):(0,a.jsx)("div",{className:"w-16 h-16 sm:w-20 sm:h-20 rounded-lg bg-muted flex items-center justify-center mr-3 sm:mr-4",children:(0,a.jsx)(m,{className:"w-8 h-8 sm:w-10 sm:h-10 text-muted-foreground"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{id:"product-detail-modal-title",className:"text-lg sm:text-xl font-semibold text-foreground leading-tight",children:t.name}),(0,a.jsx)("span",{className:"mt-1 px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("PRODUCT"===t.productType?"bg-primary/10 text-primary":"bg-secondary/10 text-secondary-foreground"),children:t.productType})]})]}),(0,a.jsx)("button",{onClick:r,className:"p-1.5 rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors ml-2","aria-label":"Cerrar modal",children:(0,a.jsx)(l.b0,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"p-4 sm:p-5 space-y-4 overflow-y-auto",children:[(0,a.jsxs)("dl",{className:"divide-y divide-border/50",children:[(0,a.jsx)(v,{label:"SKU",value:t.sku,icon:l.lO}),(0,a.jsx)(v,{label:"Descripci\xf3n",value:(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:t.description})}),(0,a.jsx)(v,{label:"Categor\xeda",value:t.category}),(0,a.jsx)(v,{label:"Precio Venta (sin IVA)",value:t.price,icon:l.ci,isCurrency:!0}),"PRODUCT"===t.productType&&void 0!==t.unitPrice&&(0,a.jsx)(v,{label:"Precio Costo (sin IVA)",value:t.unitPrice,icon:l.ci,isCurrency:!0}),"PRODUCT"===t.productType&&(0,a.jsx)(v,{label:"Stock Actual",value:t.totalStock,icon:l.vx}),(0,a.jsx)(v,{label:"Publicado",value:t.isPublished}),t.longDescription&&(0,a.jsx)(v,{label:"Descripci\xf3n Larga",value:(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:t.longDescription})}),t.technicalSheetUrl&&(0,a.jsx)(v,{label:"Ficha T\xe9cnica",icon:l.YH,value:(0,a.jsx)("a",{href:"http://localhost:3001".concat(t.technicalSheetUrl),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-secondary hover:bg-secondary/80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-secondary",children:"Descargar PDF"})})]}),"PRODUCT"===t.productType&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-md font-semibold text-foreground mb-2 flex items-center",children:[(0,a.jsx)(l.xx,{className:"w-5 h-5 mr-2 opacity-80"}),"Lotes de Stock Activos"]}),i?(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cargando lotes..."}):o.length>0?(0,a.jsx)("div",{className:"border border-border rounded-lg overflow-hidden",children:(0,a.jsx)("ul",{className:"divide-y divide-border/50",children:o.map(e=>(0,a.jsxs)("li",{className:"p-2.5 grid grid-cols-2 sm:grid-cols-4 gap-2 text-sm",children:[(0,a.jsxs)("div",{className:"font-medium",children:["#",e.lotNumber||"N/A"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-semibold",children:"Cant:"})," ",e.currentQuantity]}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:[(0,a.jsx)("span",{className:"font-semibold text-foreground",children:"Costo:"})," ",(0,x.eQ)(e.purchasePrice)]}),(0,a.jsxs)("div",{className:"text-muted-foreground",children:[(0,a.jsx)("span",{className:"font-semibold text-foreground",children:"Venc:"})," ",e.expirationDate?(0,x.p6)(e.expirationDate):"N/A"]}),(0,a.jsx)("div",{className:"flex items-center justify-end",children:(0,a.jsx)("button",{onClick:()=>u(e),className:"p-1 text-muted-foreground hover:text-primary",children:(0,a.jsx)(l.vd,{className:"w-4 h-4"})})})]},e.id))})}):(0,a.jsx)("p",{className:"text-sm text-muted-foreground italic",children:"No hay lotes activos para este producto."})]}),"PRODUCT"===t.productType&&(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(b,{productId:t.id})})]}),(0,a.jsx)("div",{className:"px-4 py-3 sm:px-5 bg-muted/50 border-t border-border flex justify-end",children:(0,a.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 border border-border text-sm font-medium rounded-md text-foreground bg-background hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-ring dark:focus:ring-offset-card transition-colors",children:"Cerrar"})})]}),d&&(0,a.jsx)(g,{lot:d,onClose:()=>u(null),onSave:e=>{n(t=>t.map(t=>t.id===e.id?e:t))}})]})},j=r(1944),y=()=>{let{token:e,isAuthenticated:t,currentUser:r}=(0,m.a)(),[i,c]=(0,s.useState)([]),[d,p]=(0,s.useState)(1),[f,g]=(0,s.useState)(1),[b,v]=(0,s.useState)(0),[y,w]=(0,s.useState)(!0),[C,k]=(0,s.useState)(null),[E,P]=(0,s.useState)(!1),[S,D]=(0,s.useState)(null),[A,T]=(0,s.useState)(null),[I,R]=(0,s.useState)(!1),[F,O]=(0,s.useState)(null),L=(0,s.useCallback)(async function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!t||!e||(null==r?void 0:r.role)!==o.i4.ADMIN){k("No autorizado para ver esta p\xe1gina."),w(!1);return}try{w(!0);let t=await u.M.getAllProducts(e,a),r=await Promise.all(t.data.map(async t=>{if("PRODUCT"!==t.productType)return{...t,totalStock:void 0};{let r=(await u.M.getProductLots(t.id,e)).reduce((e,t)=>e+t.currentQuantity,0);return{...t,totalStock:r}}}));c(r),g(t.pages),p(t.currentPage),v(t.total)}catch(e){console.error("Error fetching products:",e),k("Error al cargar los productos.")}finally{w(!1)}},[t,e,r]);(0,s.useEffect)(()=>{L(d)},[L,d]);let U=(0,s.useCallback)(()=>{D(null),P(!0)},[]),_=(0,s.useCallback)(e=>{D(e),P(!0)},[]),V=(0,s.useCallback)(e=>{O(e),R(!0)},[]),M=(0,s.useCallback)(async()=>{if(F&&e)try{await u.M.deleteProduct(F.id,e),L(d),O(null),R(!1)}catch(e){console.error("Error deleting product:",e),k("Error al eliminar el producto.")}},[F,e,L,d]),B=(0,s.useCallback)(()=>{O(null),R(!1)},[]),Q=(0,s.useCallback)(e=>{T(e)},[]),z=(0,s.useCallback)(()=>{T(null)},[]),H=(0,s.useCallback)(async(t,r)=>{if(e)try{let a;a=S?await u.M.updateProduct(t.id,t,e):await u.M.createProduct(t,e),r&&a.id&&await u.M.uploadTechnicalSheet(a.id,r,e),P(!1),D(null),L(d)}catch(e){console.error("Error saving product:",e),k("Error al guardar el producto.")}},[S,e,L,d]),Y=(0,s.useCallback)(()=>{P(!1),D(null)},[]),Z=e=>{p(e)};return y?(0,a.jsx)("div",{className:"text-center py-8",children:"Cargando productos..."}):C?(0,a.jsx)("div",{className:"text-center py-8 text-destructive",children:C}):t&&(null==r?void 0:r.role)===o.i4.ADMIN?E?(0,a.jsx)(h,{productData:S,onSave:H,onCancel:Y}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-semibold text-foreground",children:"Productos y Servicios"}),(0,a.jsxs)("button",{className:"w-full sm:w-auto bg-primary hover:bg-primary/90 text-primary-foreground font-medium py-2.5 px-5 rounded-lg shadow-sm hover:shadow-md transition-all duration-150 flex items-center justify-center space-x-2",onClick:U,"aria-label":"A\xf1adir Nuevo Producto o Servicio",children:[(0,a.jsx)(l.pO,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Nuevo Producto/Servicio"})]})]}),(0,a.jsx)(n.Zb,{className:"overflow-hidden border",children:(0,a.jsx)(n.aY,{className:"p-0",children:i.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[(0,a.jsx)("thead",{className:"bg-muted/50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Nombre"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider hidden sm:table-cell",children:"SKU"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Tipo"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Precio Venta"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider hidden md:table-cell",children:"Stock"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider hidden lg:table-cell",children:"Estado"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-center text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"bg-card divide-y divide-border",children:i.map(e=>{var t;return(0,a.jsxs)("tr",{className:"hover:bg-accent transition-colors duration-150",children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[e.images&&e.images.length>0?(0,a.jsx)("img",{src:e.images[0],alt:e.name,className:"w-10 h-10 rounded-md object-cover mr-3 hidden sm:block"}):(0,a.jsx)("div",{className:"w-10 h-10 rounded-md bg-muted flex items-center justify-center mr-3 hidden sm:block",children:(0,a.jsx)(l.FM,{className:"w-5 h-5 text-muted-foreground"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-foreground",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground sm:hidden",children:e.sku||"-"})]})]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground hidden sm:table-cell",children:e.sku||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground",children:(0,a.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("PRODUCT"===e.productType?"bg-primary/10 text-primary":"bg-secondary/10 text-secondary-foreground"),children:e.productType})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-foreground text-right",children:(0,x.eQ)(e.price)}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-muted-foreground text-right hidden md:table-cell",children:"PRODUCT"===e.productType&&null!==(t=e.totalStock)&&void 0!==t?t:"N/A"}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm hidden lg:table-cell",children:(0,a.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(e.isPublished?"bg-emerald-500/10 text-emerald-700 dark:text-emerald-400":"bg-amber-500/10 text-amber-700 dark:text-amber-400"),children:e.isPublished?"Publicado":"Borrador"})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-1 sm:space-x-2",children:[(0,a.jsx)("button",{onClick:()=>Q(e),title:"Ver Detalles",className:"text-primary hover:text-primary/80 dark:hover:text-primary/70 transition-colors p-1 rounded-md hover:bg-primary/10","aria-label":"Ver detalles de ".concat(e.name),children:(0,a.jsx)(l.tE,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:()=>_(e),title:"Editar Producto",className:"text-primary hover:text-primary/80 dark:hover:text-primary/70 transition-colors p-1 rounded-md hover:bg-primary/10","aria-label":"Editar producto ".concat(e.name),children:(0,a.jsx)(l.vd,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:()=>V(e),title:"Eliminar Producto",className:"text-destructive hover:text-destructive/80 dark:hover:text-destructive/70 transition-colors p-1 rounded-md hover:bg-destructive/10","aria-label":"Eliminar producto ".concat(e.name),children:(0,a.jsx)(l.XH,{className:"w-5 h-5"})})]})})]},e.id)})})]})}):(0,a.jsxs)("div",{className:"text-center py-12 px-4",children:[(0,a.jsx)(l.vx,{className:"mx-auto h-16 w-16 text-muted-foreground opacity-40"}),(0,a.jsx)("h3",{className:"mt-3 text-xl font-semibold text-foreground",children:"No hay productos o servicios registrados"}),(0,a.jsx)("p",{className:"mt-1.5 text-sm text-muted-foreground",children:"Empieza a\xf1adiendo tu primer producto o servicio para gestionar tu inventario y cat\xe1logo."}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)("button",{type:"button",onClick:U,className:"w-full sm:w-auto bg-primary hover:bg-primary/90 text-primary-foreground font-medium py-2.5 px-5 rounded-lg shadow-sm hover:shadow-md transition-all duration-150 flex items-center justify-center space-x-2 mx-auto",children:[(0,a.jsx)(l.pO,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"A\xf1adir Primer Producto/Servicio"})]})})]})})}),i.length>0&&f>1&&(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["P\xe1gina ",d," de ",f," (Total: ",b," productos)"]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{className:"px-4 py-2 border rounded-md text-sm font-medium bg-background hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>Z(d-1),disabled:d<=1,children:"Anterior"}),(0,a.jsx)("button",{className:"px-4 py-2 border rounded-md text-sm font-medium bg-background hover:bg-accent disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>Z(d+1),disabled:d>=f,children:"Siguiente"})]})]})]}),A&&(0,a.jsx)(N,{product:A,onClose:z}),I&&F&&(0,a.jsx)(j.Z,{isOpen:I,onClose:B,onConfirm:M,title:"Confirmar Eliminaci\xf3n",message:(0,a.jsxs)(a.Fragment,{children:["\xbfEst\xe1s seguro de que quieres eliminar ",(0,a.jsx)("strong",{children:F.name}),"? Esta acci\xf3n no se puede deshacer."]}),confirmText:"Eliminar",confirmButtonClass:"bg-destructive hover:bg-destructive/90 text-destructive-foreground",icon:(0,a.jsx)(l.XH,{className:"w-5 h-5 mr-2"})})]}):(0,a.jsx)("div",{className:"text-center py-8 text-destructive",children:"Acceso denegado. No tienes permisos de administrador."})};function w(){return(0,a.jsx)(y,{})}},1944:function(e,t,r){"use strict";var a=r(7437),s=r(2265),o=r(8560);t.Z=e=>{let{isOpen:t,onClose:r,onConfirm:n,title:l,message:i,confirmText:c="Confirmar",cancelText:d="Cancelar",confirmButtonClass:u="bg-primary hover:bg-primary/90 text-primary-foreground",icon:m}=e;return((0,s.useEffect)(()=>{if(!t)return;let e=e=>{"Escape"===e.key&&r()};return window.addEventListener("keydown",e),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,r]),t)?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 dark:bg-black/75 p-4 transition-opacity duration-300 ease-in-out",onClick:r,role:"alertdialog","aria-modal":"true","aria-labelledby":"confirmation-modal-title","aria-describedby":"confirmation-modal-message",children:(0,a.jsxs)("div",{className:"bg-card text-card-foreground rounded-lg shadow-xl w-full max-w-md flex flex-col overflow-hidden border border-border",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-5 border-b border-border",children:[(0,a.jsxs)("h2",{id:"confirmation-modal-title",className:"text-lg sm:text-xl font-semibold text-foreground flex items-center",children:[m&&(0,a.jsx)("span",{className:"mr-2",children:m})," ",l," "]}),(0,a.jsxs)("button",{onClick:r,className:"p-1.5 rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors","aria-label":"Cerrar modal",children:[(0,a.jsx)(o.b0,{className:"w-5 h-5"})," "]})]}),(0,a.jsx)("div",{className:"p-4 sm:p-5",children:(0,a.jsxs)("p",{id:"confirmation-modal-message",className:"text-sm text-foreground",children:[i," "]})}),(0,a.jsxs)("div",{className:"px-4 py-3 sm:p-5 bg-muted/50 border-t border-border flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0 space-y-reverse",children:[(0,a.jsxs)("button",{type:"button",onClick:r,className:"w-full sm:w-auto justify-center px-4 py-2.5 border border-border text-sm font-medium rounded-md text-foreground bg-background hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-ring dark:focus:ring-offset-card transition-colors duration-150",children:[d," "]}),(0,a.jsxs)("button",{type:"button",onClick:n,className:"w-full sm:w-auto justify-center px-4 py-2.5 border border-transparent text-sm font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-card transition-colors duration-150 ".concat(u," focus:ring-current"),children:[c," "]})]})]})}):null}},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return n},aY:function(){return d},eW:function(){return u},ll:function(){return i}});var a=r(7437),s=r(2265),o=r(4508);let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("rounded-xl bg-card text-card-foreground shadow-sm","border border-border","transition-all duration-200 ease-in-out","hover:shadow-lg dark:hover:shadow-primary/20","hover:border-border dark:hover:border-primary/40","dark:hover:bg-muted/20",r),...s})});n.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-5",r),...s})});l.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,o.cn)("text-xl font-semibold leading-none tracking-tight",r),...s})});i.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("p-5 pt-0",r),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-5 pt-0",r),...s})});u.displayName="CardFooter"},2779:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return d}});var a=r(7437),s=r(2265),o=r(3464);let n="http://localhost:3001",l={login:async e=>{try{return(await o.Z.post("".concat(n,"/auth/login"),e)).data}catch(e){throw e}},register:async e=>{let t={email:e.email,password:e.password,firstName:e.firstName,lastName:e.lastName,role:e.role};try{return(await o.Z.post("".concat(n,"/auth/register"),t)).data}catch(e){throw e}}},i=(0,s.createContext)(void 0),c=e=>{let{children:t}=e,[r,o]=(0,s.useState)(null),[n,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=localStorage.getItem("wolfflow_token"),t=localStorage.getItem("wolfflow_user");if(e&&t){o(e);try{c(JSON.parse(t))}catch(e){console.error("Failed to parse stored user:",e),localStorage.removeItem("wolfflow_user"),localStorage.removeItem("wolfflow_token"),o(null),c(null)}}u(!1)},[]);let m=async e=>{u(!0);try{let t=await l.login(e);if(t&&t.access_token&&t.user)return o(t.access_token),c(t.user),localStorage.setItem("wolfflow_token",t.access_token),localStorage.setItem("wolfflow_user",JSON.stringify(t.user)),u(!1),{success:!0};return u(!1),{success:!1,error:t.message||"Login failed: No token or user data received."}}catch(e){var t,r;return u(!1),{success:!1,error:(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||e.message||"An unknown error occurred during login."}}},x=async e=>{u(!0);try{let t=await l.register(e);if(t){let r=await m({email:e.email,password:e.password});return u(!1),{success:r.success,error:r.error,data:t}}return u(!1),{success:!0,data:t}}catch(e){var t,r;return u(!1),{success:!1,error:(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||e.message||"An unknown error occurred during registration."}}};return(0,a.jsx)(i.Provider,{value:{token:r,currentUser:n,isAuthenticated:!!r,isLoading:d,login:m,logout:()=>{u(!0),o(null),c(null),localStorage.removeItem("wolfflow_token"),localStorage.removeItem("wolfflow_user"),u(!1)},register:x},children:t})},d=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9116:function(e,t,r){"use strict";r.d(t,{h:function(){return o}});var a=r(3464);let s=()=>localStorage.getItem("wolfflow_token"),o=a.Z.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{let t=s();return console.log("Auth Token being sent:",t),t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e))},9138:function(e,t,r){"use strict";r.d(t,{M:function(){return s}});var a=r(9116);let s={async getAllProducts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return(await a.h.get("/products",{params:{page:t,limit:r},headers:{Authorization:"Bearer ".concat(e)}})).data},async searchProducts(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return(await a.h.get("/products/search",{params:{term:t,page:r,limit:s},headers:{Authorization:"Bearer ".concat(e)}})).data},async getPublishedProducts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,n=arguments.length>5?arguments[5]:void 0;return(await a.h.get("/products/published",{params:{page:e,limit:t,category:r,searchQuery:s,minPrice:o,maxPrice:n}})).data},getPublishedProductById:async e=>(await a.h.get("/products/published/".concat(e))).data,getProductLots:async(e,t)=>(await a.h.get("/products/".concat(e,"/lots"),{headers:{Authorization:"Bearer ".concat(t)}})).data,getAverageCost:async(e,t)=>(await a.h.get("/products/".concat(e,"/average-cost"),{headers:{Authorization:"Bearer ".concat(t)}})).data,createProduct:async(e,t)=>(await a.h.post("/products",e,{headers:{Authorization:"Bearer ".concat(t)}})).data,updateProduct:async(e,t,r)=>(await a.h.patch("/products/".concat(e),t,{headers:{Authorization:"Bearer ".concat(r)}})).data,async deleteProduct(e,t){await a.h.delete("/products/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},async uploadTechnicalSheet(e,t,r){let s=new FormData;return s.append("file",t),(await a.h.post("/products/".concat(e,"/technical-sheet"),s,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(r)}})).data},deleteTechnicalSheet:async(e,t)=>(await a.h.delete("/products/".concat(e,"/technical-sheet"),{headers:{Authorization:"Bearer ".concat(t)}})).data}},3985:function(e,t,r){"use strict";var a,s,o,n,l,i,c,d,u,m,x,p;r.d(t,{UY:function(){return l},XL:function(){return o},bG:function(){return s},gS:function(){return n},i4:function(){return i},iF:function(){return a}}),r(2265),(c=a||(a={})).PENDING_PAYMENT="PENDING_PAYMENT",c.PROCESSING="PROCESSING",c.SHIPPED="SHIPPED",c.DELIVERED="DELIVERED",c.CANCELLED="CANCELLED",c.REFUNDED="REFUNDED",(d=s||(s={})).PENDING="PENDING",d.PAID="PAID",d.FAILED="FAILED",d.REFUNDED="REFUNDED",(u=o||(o={})).CASH="CASH",u.DEBIT_CARD="DEBIT_CARD",u.CREDIT_CARD="CREDIT_CARD",u.BANK_TRANSFER="BANK_TRANSFER",u.OTHER="OTHER",(m=n||(n={})).DRAFT="DRAFT",m.SENT="SENT",m.ACCEPTED="ACCEPTED",m.REJECTED="REJECTED",m.EXPIRED="EXPIRED",m.INVOICED="INVOICED",(x=l||(l={})).DRAFT="DRAFT",x.SENT="SENT",x.PAID="PAID",x.PARTIALLY_PAID="PARTIALLY_PAID",x.OVERDUE="OVERDUE",x.VOID="VOID",x.CANCELLED="CANCELLED",(p=i||(i={})).ADMIN="ADMIN",p.EDITOR="EDITOR",p.VIEWER="VIEWER",p.CLIENT="CLIENT"},4508:function(e,t,r){"use strict";r.d(t,{LH:function(){return i},cn:function(){return o},eQ:function(){return n},fW:function(){return c},p6:function(){return l}});var a=r(1994),s=r(3335);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}function n(e){let t=Number(e);if(isNaN(t))return"$0";let r=Math.abs(t),a=(r%1).toFixed(2).substring(2),s=Math.trunc(r).toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),o="$".concat(s);return"00"!==a&&(o+=",".concat(a)),t<0?"-".concat(o):o}function l(e){try{let t=new Date(e),r=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),s=t.getFullYear();return"".concat(r,"/").concat(a,"/").concat(s)}catch(t){return console.error("Invalid date provided to formatDate:",e),"Fecha inv\xe1lida"}}function i(e){if("string"!=typeof e)return NaN;let t=parseFloat(e.replace(/\$\s?|(,*)/g,"").replace(/\./g,"").replace(",","."));return isNaN(t)?0:t}function c(e){if("string"!=typeof e||(e=e.replace(/\./g,"").replace(/-/g,"")).length<2)return!1;let t=e.slice(0,-1),r=e.slice(-1).toUpperCase(),a=0,s=2;for(let e=t.length-1;e>=0;e--)a+=parseInt(t[e],10)*s,++s>7&&(s=2);let o=11-a%11;return(11===o?"0":10===o?"K":o.toString())===r}}},function(e){e.O(0,[6137,3464,4438,8560,2971,2117,1744],function(){return e(e.s=4134)}),_N_E=e.O()}]);