(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6623],{4761:function(e,t,r){Promise.resolve().then(r.bind(r,8957))},8957:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var a=r(7437),s=r(2265),n=r(9376),o=r(2779),l=r(6070),i=r(8560),d=r(4508),c=r(9138),u=r(4038);let m={async getAllPurchaseOrders(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=await (0,u.Z)("/purchase-orders?page=".concat(e,"&limit=").concat(t));return{data:r.data,total:r.total,page:r.currentPage,limit:t,pages:r.pages}},getPurchaseOrderById:async e=>(0,u.Z)("/purchase-orders/".concat(e)),createPurchaseOrder:async e=>(0,u.Z)("/purchase-orders",{method:"POST",body:JSON.stringify(e)}),updatePurchaseOrder:async(e,t)=>(0,u.Z)("/purchase-orders/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),async deletePurchaseOrder(e){await (0,u.Z)("/purchase-orders/".concat(e),{method:"DELETE"})}};var p=r(1441),h=r(5186),f=r(2869),x=r(6815),g=r(3647),N=r(4438),v=e=>{let{onSave:t,onCancel:r}=e,{token:n}=(0,o.a)(),[u,v]=(0,s.useState)(""),[y,b]=(0,s.useState)([]),[j,w]=(0,s.useState)(new Date().toISOString().split("T")[0]),[E,C]=(0,s.useState)(""),[D,A]=(0,s.useState)([]),[S,P]=(0,s.useState)(""),[I,R]=(0,s.useState)([]),[T,k]=(0,s.useState)(null),[O,_]=(0,s.useState)(""),[F,z]=(0,s.useState)(""),[L,V]=(0,s.useState)({}),[B,Z]=(0,s.useState)({}),[M,H]=(0,s.useState)(!1);(0,s.useEffect)(()=>{n&&p.J.getAllCompanies(1,1e3,{isSupplier:!0}).then(e=>{b(e.data)}).catch(e=>console.error("Error fetching suppliers:",e))},[n]),(0,s.useEffect)(()=>{let e=setTimeout(()=>{S.length>2&&n?c.M.searchProducts(n,S).then(e=>R(e.data)).catch(e=>console.error("Error searching products:",e)):R([])},300);return()=>clearTimeout(e)},[S,n]);let U=(0,s.useCallback)(async e=>{var t;k(e),P(e.name),R([]),z((null===(t=e.unitPrice)||void 0===t?void 0:t.toString())||"")},[]),{subTotal:q,totalVatAmount:G,grandTotal:J}=(0,s.useMemo)(()=>{let e=D.reduce((e,t)=>e+t.totalPrice,0),t=D.reduce((e,t)=>e+t.itemVatAmount,0);return{subTotal:e,totalVatAmount:t,grandTotal:e+t}},[D]),W=()=>{let e={};T||(e.product="Debe seleccionar un producto.");let t=parseFloat(O);(isNaN(t)||t<=0)&&(e.quantity="La cantidad debe ser un n\xfamero positivo.");let r=parseFloat(F);return(isNaN(r)||r<0)&&(e.price="El precio debe ser un n\xfamero positivo o cero."),Z(e),0===Object.keys(e).length},Y=(0,s.useCallback)(()=>{if(!W()||!T)return;let e=parseFloat(O),t=parseFloat(F),r=e*t,a=.19*r,s={productId:T.id,productName:T.name,quantity:e,unitPrice:t,totalPrice:r,itemVatAmount:a,totalPriceWithVat:r+a};A(e=>[...e,s]),P(""),k(null),_(""),z(""),Z({})},[T,O,F]),Q=(0,s.useCallback)(e=>{A(t=>t.filter((t,r)=>r!==e))},[]),X=()=>{let e={};return u||(e.selectedCompanyId="Debe seleccionar un proveedor."),j||(e.orderDate="La fecha de pedido es requerida."),0===D.length&&(e.items="Debe a\xf1adir al menos un art\xedculo a la orden de compra."),V(e),0===Object.keys(e).length},K=async e=>{if(e.preventDefault(),X()){H(!0);try{let e={companyId:u,orderDate:j,expectedDeliveryDate:E||void 0,status:"PENDING",items:D.map(e=>({productId:e.productId,quantity:e.quantity,unitPrice:e.unitPrice,totalPrice:e.totalPrice,itemVatAmount:e.itemVatAmount,totalPriceWithVat:e.totalPriceWithVat})),subTotalAmount:q,totalVatAmount:G,grandTotal:J};await m.createPurchaseOrder(e),N.Am.success("Orden de compra registrada exitosamente."),t()}catch(e){console.error("Error creating purchase order:",e),N.Am.error(e.message||"Error al registrar la orden de compra.")}finally{H(!1)}}},$="mt-1 text-xs text-destructive";return(0,a.jsxs)(l.Zb,{className:"max-w-4xl mx-auto border",children:[(0,a.jsx)(l.Ol,{children:(0,a.jsx)(l.ll,{className:"text-xl",children:"Crear Nueva Orden de Compra"})}),(0,a.jsxs)("form",{onSubmit:K,children:[(0,a.jsxs)(l.aY,{className:"space-y-6 pt-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(x._,{htmlFor:"company-select",children:["Proveedor ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)(g.Ph,{onValueChange:v,value:u,children:[(0,a.jsx)(g.i4,{id:"company-select",children:(0,a.jsx)(g.ki,{placeholder:"Selecciona un proveedor"})}),(0,a.jsx)(g.Bw,{children:y.map(e=>(0,a.jsx)(g.Ql,{value:e.id,children:e.name},e.id))})]}),L.selectedCompanyId&&(0,a.jsx)("p",{id:"company-error",className:$,children:L.selectedCompanyId})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(x._,{htmlFor:"order-date",children:["Fecha de Pedido ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(h.I,{type:"date",id:"order-date",value:j,onChange:e=>w(e.target.value)}),L.orderDate&&(0,a.jsx)("p",{id:"orderDate-error",className:$,children:L.orderDate})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(x._,{htmlFor:"expected-delivery-date",children:"Fecha de Entrega Esperada"}),(0,a.jsx)(h.I,{type:"date",id:"expected-delivery-date",value:E,onChange:e=>C(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-4 p-4 border border-border rounded-md bg-card",children:[(0,a.jsx)("h3",{className:"text-md font-semibold text-foreground",children:"Art\xedculos de la Orden de Compra"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-4 items-end",children:[(0,a.jsxs)("div",{className:"sm:col-span-5 relative",children:[(0,a.jsx)(x._,{htmlFor:"product-search",children:"Buscar Producto"}),(0,a.jsx)(h.I,{id:"product-search",type:"text",value:S,onChange:e=>P(e.target.value),placeholder:"Escribe para buscar productos...",className:"pr-10"}),(0,a.jsx)(i.W1,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),I.length>0&&(0,a.jsx)("div",{className:"absolute z-10 w-full bg-popover border border-border rounded-md shadow-lg mt-1 max-h-60 overflow-y-auto",children:I.map(e=>(0,a.jsxs)("div",{className:"px-3 py-2 hover:bg-accent cursor-pointer text-sm",onClick:()=>U(e),children:[e.name," ",e.sku?"(".concat(e.sku,")"):""]},e.id))}),B.product&&(0,a.jsx)("p",{className:$,children:B.product})]}),T&&(0,a.jsxs)("div",{className:"sm:col-span-7 grid grid-cols-1 sm:grid-cols-5 gap-4",children:[(0,a.jsxs)("div",{className:"sm:col-span-2",children:[(0,a.jsx)(x._,{htmlFor:"item-quantity",children:"Cantidad"}),(0,a.jsx)(h.I,{type:"number",id:"item-quantity",value:O,onChange:e=>_(e.target.value),placeholder:"0"}),B.quantity&&(0,a.jsx)("p",{className:$,children:B.quantity})]}),(0,a.jsxs)("div",{className:"sm:col-span-3",children:[(0,a.jsx)(x._,{htmlFor:"item-price",children:"Costo Unit. (sin IVA)"}),(0,a.jsx)(h.I,{type:"number",id:"item-price",value:F,onChange:e=>z(e.target.value),placeholder:"0.00",step:"0.01"}),B.price&&(0,a.jsx)("p",{className:$,children:B.price})]}),(0,a.jsx)("div",{className:"sm:col-span-5",children:(0,a.jsxs)(f.z,{type:"button",onClick:Y,className:"w-full",children:[(0,a.jsx)(i.pO,{className:"w-4 h-4 mr-2"})," A\xf1adir Art\xedculo"]})})]})]}),D.length>0?(0,a.jsx)("div",{className:"mt-4 -mx-4 sm:mx-0 overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[(0,a.jsx)("thead",{className:"bg-muted/50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-3 py-2 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Producto"}),(0,a.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Cant."}),(0,a.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Costo Unit. (s/IVA)"}),(0,a.jsx)("th",{className:"px-3 py-2 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Subtotal (s/IVA)"}),(0,a.jsx)("th",{className:"px-3 py-2 text-center text-xs font-semibold text-muted-foreground uppercase tracking-wider"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-border",children:D.map((e,t)=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-foreground",children:e.productName}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-muted-foreground text-right",children:e.quantity}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-muted-foreground text-right",children:(0,d.eQ)(e.unitPrice)}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-foreground font-medium text-right",children:(0,d.eQ)(e.totalPrice)}),(0,a.jsx)("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:(0,a.jsx)("button",{type:"button",onClick:()=>Q(t),title:"Eliminar Art\xedculo",className:"text-destructive hover:text-destructive/80 p-1 rounded-md hover:bg-destructive/10 transition-colors",children:(0,a.jsx)(i.XH,{className:"w-4 h-4"})})})]},t))})]})}):(0,a.jsx)("p",{className:"text-sm text-center text-muted-foreground italic py-3",children:"A\xfan no se han a\xf1adido art\xedculos a la orden de compra."}),L.items&&(0,a.jsx)("p",{className:$+" text-center",children:L.items})]}),(0,a.jsxs)("div",{className:"mt-6 pt-4 border-t border-border space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-end items-center",children:[(0,a.jsx)("span",{className:"text-md font-medium text-muted-foreground",children:"Subtotal (sin IVA):"}),(0,a.jsx)("span",{className:"ml-4 text-md font-semibold text-foreground w-32 text-right",children:(0,d.eQ)(q)})]}),(0,a.jsxs)("div",{className:"flex justify-end items-center",children:[(0,a.jsxs)("span",{className:"text-md font-medium text-muted-foreground",children:["IVA (",19,"%):"]}),(0,a.jsx)("span",{className:"ml-4 text-md font-semibold text-foreground w-32 text-right",children:(0,d.eQ)(G)})]}),(0,a.jsxs)("div",{className:"flex justify-end items-center mt-1 pt-1 border-t border-border/50",children:[(0,a.jsx)("span",{className:"text-lg font-bold text-foreground",children:"Total Orden:"}),(0,a.jsx)("span",{className:"ml-4 text-2xl font-bold text-primary w-32 text-right",children:(0,d.eQ)(J)})]})]})]}),(0,a.jsxs)(l.eW,{className:"flex flex-col sm:flex-row justify-end items-center gap-3 pt-6",children:[(0,a.jsx)(f.z,{type:"button",variant:"outline",onClick:r,className:"w-full sm:w-auto order-2 sm:order-1",children:"Cancelar"}),(0,a.jsx)(f.z,{type:"submit",className:"w-full sm:w-auto order-1 sm:order-2",disabled:M,children:M?"Guardando...":"Crear Orden de Compra"})]})]})]})},y=r(3985),b=r(3578),j=()=>{let{isAuthenticated:e,currentUser:t,isLoading:r}=(0,o.a)(),c=(0,n.useRouter)(),[u,p]=(0,s.useState)(!1),[h,x]=(0,s.useState)([]),[g,N]=(0,s.useState)(!0),[j,w]=(0,s.useState)(null),[E,C]=(0,s.useState)(1),[D,A]=(0,s.useState)(1),[S,P]=(0,s.useState)(0),I=(0,s.useCallback)(async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!e||(null==t?void 0:t.role)!==y.i4.ADMIN&&(null==t?void 0:t.role)!==y.i4.EDITOR){w("No autorizado para ver esta p\xe1gina o no autenticado."),N(!1),e||c.push("/login");return}N(!0);try{let e=await m.getAllPurchaseOrders(r);x(e.data),A(e.pages),C(e.page),P(e.total)}catch(e){console.error("Error fetching purchase orders:",e),e.message&&e.message.includes("Unauthorized")?c.push("/login"):w("Error al cargar las \xf3rdenes de compra.")}finally{N(!1)}},[e,t,c]);(0,s.useEffect)(()=>{r||I(E)},[I,E,r]);let R=(0,s.useCallback)(()=>{p(!0)},[]),T=(0,s.useCallback)(async()=>{p(!1),I(E)},[I,E]),k=(0,s.useCallback)(()=>{p(!1)},[]),O=e=>{C(e)};return r?(0,a.jsx)("div",{className:"text-center py-8",children:"Cargando autenticaci\xf3n..."}):g?(0,a.jsx)("div",{className:"text-center py-8",children:"Cargando \xf3rdenes de compra..."}):j?(0,a.jsx)("div",{className:"text-center py-8 text-destructive",children:j}):e&&((null==t?void 0:t.role)===y.i4.ADMIN||(null==t?void 0:t.role)===y.i4.EDITOR)?u?(0,a.jsx)(v,{onSave:T,onCancel:k}):(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-semibold text-foreground",children:"Gesti\xf3n de \xd3rdenes de Compra"}),(0,a.jsxs)(f.z,{className:"w-full sm:w-auto",onClick:R,children:[(0,a.jsx)(i.pO,{className:"w-5 h-5 mr-2"}),(0,a.jsx)("span",{children:"Crear Nueva Orden de Compra"})]})]}),(0,a.jsx)(l.Zb,{className:"overflow-hidden border",children:(0,a.jsx)(l.aY,{className:"p-0",children:h.length>0?(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)(b.iA,{children:[(0,a.jsx)(b.xD,{className:"bg-muted/50",children:(0,a.jsxs)(b.SC,{children:[(0,a.jsx)(b.ss,{children:"ID Orden"}),(0,a.jsx)(b.ss,{children:"Empresa"}),(0,a.jsx)(b.ss,{className:"hidden sm:table-cell",children:"Fecha Pedido"}),(0,a.jsx)(b.ss,{className:"text-right",children:"Total"})]})}),(0,a.jsx)(b.RM,{children:h.map(e=>{var t;return(0,a.jsxs)(b.SC,{className:"hover:bg-accent transition-colors duration-150",children:[(0,a.jsxs)(b.pj,{className:"font-mono text-muted-foreground",children:[e.id.substring(0,8),"..."]}),(0,a.jsx)(b.pj,{children:(0,a.jsx)("div",{className:"font-medium text-foreground",children:null===(t=e.company)||void 0===t?void 0:t.name})}),(0,a.jsx)(b.pj,{className:"hidden sm:table-cell text-muted-foreground",children:new Date(e.orderDate).toLocaleDateString()}),(0,a.jsx)(b.pj,{className:"font-semibold text-primary text-right",children:(0,d.eQ)(e.grandTotal)})]},e.id)})})]})}):(0,a.jsxs)("div",{className:"text-center py-12 px-4",children:[(0,a.jsx)(i.Q1,{className:"mx-auto h-16 w-16 text-muted-foreground opacity-40"}),(0,a.jsx)("h3",{className:"mt-3 text-xl font-semibold text-foreground",children:"No hay \xf3rdenes de compra registradas"}),(0,a.jsx)("p",{className:"mt-1.5 text-sm text-muted-foreground",children:"Comienza creando una nueva orden de compra para verla listada aqu\xed."}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsxs)(f.z,{type:"button",onClick:R,children:[(0,a.jsx)(i.pO,{className:"w-5 h-5 mr-2"}),(0,a.jsx)("span",{children:"Crear Primera Orden de Compra"})]})})]})})}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["P\xe1gina ",E," de ",D," (Total: ",S," \xf3rdenes)"]})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.z,{variant:"outline",size:"sm",onClick:()=>O(E-1),disabled:E<=1,children:"Anterior"}),(0,a.jsx)(f.z,{variant:"outline",size:"sm",onClick:()=>O(E+1),disabled:E>=D,children:"Siguiente"})]})]})]})}):(0,a.jsx)("div",{className:"text-center py-8 text-destructive",children:"Acceso denegado. No tienes permisos suficientes."})};function w(){return(0,a.jsx)(j,{})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var a=r(7437),s=r(2265),n=r(7053),o=r(535),l=r(4508);let i=(0,o.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary-500 text-white hover:bg-primary-600",outline:"border border-primary-500 text-primary-500 hover:bg-primary-50",ghost:"hover:bg-gray-100"},size:{default:"h-10 px-4 py-2",sm:"h-8 px-3 text-xs",lg:"h-12 px-8"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:d=!1,...c}=e,u=d?n.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(i({variant:s,size:o,className:r})),ref:t,...c})});d.displayName="Button"},6070:function(e,t,r){"use strict";r.d(t,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return o},aY:function(){return c},eW:function(){return u},ll:function(){return i}});var a=r(7437),s=r(2265),n=r(4508);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl bg-card text-card-foreground shadow-sm","border border-border","transition-all duration-200 ease-in-out","hover:shadow-lg dark:hover:shadow-primary/20","hover:border-border dark:hover:border-primary/40","dark:hover:bg-muted/20",r),...s})});o.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-5",r),...s})});l.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,n.cn)("text-xl font-semibold leading-none tracking-tight",r),...s})});i.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("p-5 pt-0",r),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-5 pt-0",r),...s})});u.displayName="CardFooter"},5186:function(e,t,r){"use strict";r.d(t,{I:function(){return o}});var a=r(7437),s=r(2265),n=r(4508);let o=s.forwardRef((e,t)=>{let{className:r,type:s,...o}=e;return(0,a.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...o})});o.displayName="Input"},6815:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var a=r(7437),s=r(2265),n=r(6394),o=r(535),l=r(4508);let i=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.f,{ref:t,className:(0,l.cn)(i(),r),...s})});d.displayName=n.f.displayName},3647:function(e,t,r){"use strict";r.d(t,{Bw:function(){return m},Ph:function(){return d},Ql:function(){return p},i4:function(){return u},ki:function(){return c}});var a=r(7437),s=r(2265),n=r(8238),o=r(875),l=r(401),i=r(4508);let d=n.fC;n.ZA;let c=n.B4,u=s.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(n.xz,{ref:t,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...l,children:[s,(0,a.jsx)(n.JO,{asChild:!0,children:(0,a.jsx)(o.Z,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=n.xz.displayName;let m=s.forwardRef((e,t)=>{let{className:r,children:s,position:o="popper",...l}=e;return(0,a.jsx)(n.h_,{children:(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:o,...l,children:(0,a.jsx)(n.l_,{className:(0,i.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s})})})});m.displayName=n.VY.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.__,{ref:t,className:(0,i.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...s})}).displayName=n.__.displayName;let p=s.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsxs)(n.ck,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(n.eT,{children:s})]})});p.displayName=n.ck.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(n.Z0,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=n.Z0.displayName},3578:function(e,t,r){"use strict";r.d(t,{RM:function(){return i},SC:function(){return d},iA:function(){return o},pj:function(){return u},ss:function(){return c},xD:function(){return l}});var a=r(7437),s=r(2265),n=r(4508);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",r),...s})})});o.displayName="Table";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",r),...s})});l.displayName="TableHeader";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",r),...s})});i.displayName="TableBody",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:hidden",r),...s})}).displayName="TableFooter";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...s})});d.displayName="TableRow";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...s})});c.displayName="TableHead";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...s})});u.displayName="TableCell",s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",r),...s})}).displayName="TableCaption"},2779:function(e,t,r){"use strict";r.d(t,{H:function(){return d},a:function(){return c}});var a=r(7437),s=r(2265),n=r(3464);let o="http://localhost:3001",l={login:async e=>{try{return(await n.Z.post("".concat(o,"/auth/login"),e)).data}catch(e){throw e}},register:async e=>{let t={email:e.email,password:e.password,firstName:e.firstName,lastName:e.lastName,role:e.role};try{return(await n.Z.post("".concat(o,"/auth/register"),t)).data}catch(e){throw e}}},i=(0,s.createContext)(void 0),d=e=>{let{children:t}=e,[r,n]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=localStorage.getItem("wolfflow_token"),t=localStorage.getItem("wolfflow_user");if(e&&t){n(e);try{d(JSON.parse(t))}catch(e){console.error("Failed to parse stored user:",e),localStorage.removeItem("wolfflow_user"),localStorage.removeItem("wolfflow_token"),n(null),d(null)}}u(!1)},[]);let m=async e=>{u(!0);try{let t=await l.login(e);if(t&&t.access_token&&t.user)return n(t.access_token),d(t.user),localStorage.setItem("wolfflow_token",t.access_token),localStorage.setItem("wolfflow_user",JSON.stringify(t.user)),u(!1),{success:!0};return u(!1),{success:!1,error:t.message||"Login failed: No token or user data received."}}catch(e){var t,r;return u(!1),{success:!1,error:(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||e.message||"An unknown error occurred during login."}}},p=async e=>{u(!0);try{let t=await l.register(e);if(t){let r=await m({email:e.email,password:e.password});return u(!1),{success:r.success,error:r.error,data:t}}return u(!1),{success:!0,data:t}}catch(e){var t,r;return u(!1),{success:!1,error:(null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||e.message||"An unknown error occurred during registration."}}};return(0,a.jsx)(i.Provider,{value:{token:r,currentUser:o,isAuthenticated:!!r,isLoading:c,login:m,logout:()=>{u(!0),n(null),d(null),localStorage.removeItem("wolfflow_token"),localStorage.removeItem("wolfflow_user"),u(!1)},register:p},children:t})},c=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9116:function(e,t,r){"use strict";r.d(t,{h:function(){return n}});var a=r(3464);let s=()=>localStorage.getItem("wolfflow_token"),n=a.Z.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=s();return console.log("Auth Token being sent:",t),t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e))},4038:function(e,t,r){"use strict";var a=r(9116);async function s(e,t){try{let r={};return(null==t?void 0:t.headers)&&(t.headers instanceof Headers?t.headers.forEach((e,t)=>{r[t]=e}):Array.isArray(t.headers)?t.headers.forEach(e=>{let[t,a]=e;r[t]=a}):Object.assign(r,t.headers)),(await (0,a.h)(e,{method:(null==t?void 0:t.method)||"GET",data:null==t?void 0:t.body,headers:r})).data}catch(e){if(e.response)throw Error(e.response.data.message||e.response.statusText);if(e.request)throw Error("No response received from server.");throw Error(e.message)}}t.Z=s},1441:function(e,t,r){"use strict";r.d(t,{J:function(){return s}});var a=r(4038);let s={async getAllCompanies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=new URLSearchParams({page:e.toString(),limit:t.toString()});return r.isClient&&s.append("isClient","true"),r.isSupplier&&s.append("isSupplier","true"),(0,a.Z)("/companies?".concat(s.toString()))},getCompanyById:async e=>(0,a.Z)("/companies/".concat(e)),createCompany:async e=>await (0,a.Z)("/companies",{method:"POST",body:JSON.stringify(e)}),updateCompany:async(e,t)=>await (0,a.Z)("/companies/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),async deleteCompany(e){await (0,a.Z)("/companies/".concat(e),{method:"DELETE"})}}},9138:function(e,t,r){"use strict";r.d(t,{M:function(){return s}});var a=r(9116);let s={async getAllProducts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return(await a.h.get("/products",{params:{page:t,limit:r},headers:{Authorization:"Bearer ".concat(e)}})).data},async searchProducts(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return(await a.h.get("/products/search",{params:{term:t,page:r,limit:s},headers:{Authorization:"Bearer ".concat(e)}})).data},async getPublishedProducts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;return(await a.h.get("/products/published",{params:{page:e,limit:t,category:r,searchQuery:s,minPrice:n,maxPrice:o}})).data},getPublishedProductById:async e=>(await a.h.get("/products/published/".concat(e))).data,getProductLots:async(e,t)=>(await a.h.get("/products/".concat(e,"/lots"),{headers:{Authorization:"Bearer ".concat(t)}})).data,getAverageCost:async(e,t)=>(await a.h.get("/products/".concat(e,"/average-cost"),{headers:{Authorization:"Bearer ".concat(t)}})).data,createProduct:async(e,t)=>(await a.h.post("/products",e,{headers:{Authorization:"Bearer ".concat(t)}})).data,updateProduct:async(e,t,r)=>(await a.h.patch("/products/".concat(e),t,{headers:{Authorization:"Bearer ".concat(r)}})).data,async deleteProduct(e,t){await a.h.delete("/products/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},async uploadTechnicalSheet(e,t,r){let s=new FormData;return s.append("file",t),(await a.h.post("/products/".concat(e,"/technical-sheet"),s,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(r)}})).data},deleteTechnicalSheet:async(e,t)=>(await a.h.delete("/products/".concat(e,"/technical-sheet"),{headers:{Authorization:"Bearer ".concat(t)}})).data}},3985:function(e,t,r){"use strict";var a,s,n,o,l,i,d,c,u,m,p,h;r.d(t,{UY:function(){return l},XL:function(){return n},bG:function(){return s},gS:function(){return o},i4:function(){return i},iF:function(){return a}}),r(2265),(d=a||(a={})).PENDING_PAYMENT="PENDING_PAYMENT",d.PROCESSING="PROCESSING",d.SHIPPED="SHIPPED",d.DELIVERED="DELIVERED",d.CANCELLED="CANCELLED",d.REFUNDED="REFUNDED",(c=s||(s={})).PENDING="PENDING",c.PAID="PAID",c.FAILED="FAILED",c.REFUNDED="REFUNDED",(u=n||(n={})).CASH="CASH",u.DEBIT_CARD="DEBIT_CARD",u.CREDIT_CARD="CREDIT_CARD",u.BANK_TRANSFER="BANK_TRANSFER",u.OTHER="OTHER",(m=o||(o={})).DRAFT="DRAFT",m.SENT="SENT",m.ACCEPTED="ACCEPTED",m.REJECTED="REJECTED",m.EXPIRED="EXPIRED",m.INVOICED="INVOICED",(p=l||(l={})).DRAFT="DRAFT",p.SENT="SENT",p.PAID="PAID",p.PARTIALLY_PAID="PARTIALLY_PAID",p.OVERDUE="OVERDUE",p.VOID="VOID",p.CANCELLED="CANCELLED",(h=i||(i={})).ADMIN="ADMIN",h.EDITOR="EDITOR",h.VIEWER="VIEWER",h.CLIENT="CLIENT"},4508:function(e,t,r){"use strict";r.d(t,{LH:function(){return i},cn:function(){return n},eQ:function(){return o},fW:function(){return d},p6:function(){return l}});var a=r(1994),s=r(3335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}function o(e){let t=Number(e);if(isNaN(t))return"$0";let r=Math.abs(t),a=(r%1).toFixed(2).substring(2),s=Math.trunc(r).toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),n="$".concat(s);return"00"!==a&&(n+=",".concat(a)),t<0?"-".concat(n):n}function l(e){try{let t=new Date(e),r=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),s=t.getFullYear();return"".concat(r,"/").concat(a,"/").concat(s)}catch(t){return console.error("Invalid date provided to formatDate:",e),"Fecha inv\xe1lida"}}function i(e){if("string"!=typeof e)return NaN;let t=parseFloat(e.replace(/\$\s?|(,*)/g,"").replace(/\./g,"").replace(",","."));return isNaN(t)?0:t}function d(e){if("string"!=typeof e||(e=e.replace(/\./g,"").replace(/-/g,"")).length<2)return!1;let t=e.slice(0,-1),r=e.slice(-1).toUpperCase(),a=0,s=2;for(let e=t.length-1;e>=0;e--)a+=parseInt(t[e],10)*s,++s>7&&(s=2);let n=11-a%11;return(11===n?"0":10===n?"K":n.toString())===r}},9376:function(e,t,r){"use strict";var a=r(5475);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},6394:function(e,t,r){"use strict";r.d(t,{f:function(){return l}});var a=r(2265),s=r(6840),n=r(7437),o=a.forwardRef((e,t)=>(0,n.jsx)(s.WV.label,{...e,ref:t,onMouseDown:t=>{var r;t.target.closest("button, input, select, textarea")||(null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));o.displayName="Label";var l=o}},function(e){e.O(0,[6137,3464,3937,9432,4438,8560,2971,2117,1744],function(){return e(e.s=4761)}),_N_E=e.O()}]);