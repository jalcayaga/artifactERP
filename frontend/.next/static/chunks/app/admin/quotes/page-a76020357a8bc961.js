(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5933],{1983:function(e,t,a){Promise.resolve().then(a.bind(a,4162))},4162:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Q}});var s=a(7437),r=a(2265),n=a(9376),i=a(2779),l=a(6070),o=a(9501),c=a(3590),d=a(6900),u=a(2869),m=a(5186),h=a(3647),x=a(4508);let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("textarea",{className:(0,x.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...r})});p.displayName="Textarea";var f=a(7053),g=a(6815);let j=o.RV,v=r.createContext({}),b=e=>{let{...t}=e;return(0,s.jsx)(v.Provider,{value:{name:t.name},children:(0,s.jsx)(o.Qr,{...t})})},y=()=>{let e=r.useContext(v),t=r.useContext(N),{getFieldState:a,formState:s}=(0,o.Gc)(),n=a(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...n}},N=r.createContext({}),w=r.forwardRef((e,t)=>{let{className:a,...n}=e,i=r.useId();return(0,s.jsx)(N.Provider,{value:{id:i},children:(0,s.jsx)("div",{ref:t,className:(0,x.cn)("space-y-2",a),...n})})});w.displayName="FormItem";let C=r.forwardRef((e,t)=>{let{className:a,...r}=e,{error:n,formItemId:i}=y();return(0,s.jsx)(g._,{ref:t,className:(0,x.cn)(n&&"text-destructive",a),htmlFor:i,...r})});C.displayName="FormLabel";let z=r.forwardRef((e,t)=>{let{...a}=e,{error:r,formItemId:n,formDescriptionId:i,formMessageId:l}=y();return(0,s.jsx)(f.g7,{ref:t,id:n,"aria-describedby":r?"".concat(i," ").concat(l):"".concat(i),"aria-invalid":!!r,...a})});z.displayName="FormControl",r.forwardRef((e,t)=>{let{className:a,...r}=e,{formDescriptionId:n}=y();return(0,s.jsx)("p",{ref:t,id:n,className:(0,x.cn)("text-sm text-muted-foreground",a),...r})}).displayName="FormDescription";let E=r.forwardRef((e,t)=>{var a;let{className:r,children:n,...i}=e,{error:l,formMessageId:o}=y(),c=l?String(null!==(a=null==l?void 0:l.message)&&void 0!==a?a:""):n;return c?(0,s.jsx)("p",{ref:t,id:o,className:(0,x.cn)("text-sm font-medium text-destructive",r),...i,children:c}):null});E.displayName="FormMessage";var S=a(8560),k=a(3985),D=a(1441),A=a(9138);let P=d.Ry({companyId:d.Z_().min(1,"La empresa es requerida."),status:d.jb(k.gS),quoteDate:d.Z_().min(1,"La fecha es requerida."),expiryDate:d.Z_().optional(),notes:d.Z_().optional(),items:d.IX(d.Ry({productId:d.Z_().min(1,"El producto es requerido."),quantity:d.Rx().min(1,"La cantidad debe ser al menos 1."),unitPrice:d.Rx(),totalPrice:d.Rx(),itemVatAmount:d.Rx(),totalPriceWithVat:d.Rx()})).min(1,"Debe haber al menos un \xedtem en la cotizaci\xf3n."),subTotalAmount:d.Rx(),vatAmount:d.Rx(),grandTotal:d.Rx()});var I=e=>{let{quoteData:t,onSave:a,onCancel:n}=e,[i,d]=(0,r.useState)([]),[f,g]=(0,r.useState)([]),v=(0,o.cI)({resolver:(0,c.F)(P),defaultValues:t?{companyId:t.companyId,status:t.status,quoteDate:t.quoteDate?new Date(t.quoteDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],expiryDate:t.expiryDate?new Date(t.expiryDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],items:t.items||[],notes:t.notes||""}:{companyId:"",status:k.gS.DRAFT,quoteDate:new Date().toISOString().split("T")[0],expiryDate:new Date().toISOString().split("T")[0],notes:"",items:[]}}),{fields:y,append:N,remove:I}=(0,o.Dq)({control:v.control,name:"items"}),V=(0,r.useCallback)(async()=>{try{let e=await D.J.getAllCompanies(1,100,{isClient:!0});d(e.data);let t=await A.M.getAllProducts("1",1e3);g(t.data)}catch(e){console.error("Error fetching companies or products",e)}},[]);(0,r.useEffect)(()=>{V()},[V]);let T=(0,r.useCallback)(()=>{let e=v.getValues("items"),t=0;e.forEach((e,a)=>{let s=f.find(t=>t.id===e.productId);if(s){let r=parseFloat(v.getValues("items.".concat(a,".unitPrice"))||s.price)*e.quantity,n=.19*r;v.setValue("items.".concat(a,".totalPrice"),r,{shouldValidate:!0}),v.setValue("items.".concat(a,".itemVatAmount"),n,{shouldValidate:!0}),v.setValue("items.".concat(a,".totalPriceWithVat"),r+n,{shouldValidate:!0}),t+=r}});let a=.19*t,s=t+a;v.setValue("subTotalAmount",t,{shouldValidate:!0}),v.setValue("vatAmount",a,{shouldValidate:!0}),v.setValue("grandTotal",s,{shouldValidate:!0})},[v,f]);return(0,r.useEffect)(()=>{let e=v.watch((e,t)=>{let{name:a,type:s}=t;(null==a?void 0:a.startsWith("items"))&&T()});return()=>e.unsubscribe()},[v,T]),(0,s.jsx)(j,{...v,children:(0,s.jsxs)("form",{onSubmit:v.handleSubmit(e=>{a(e)}),className:"space-y-8",children:[(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{children:t?"Editar Cotizaci\xf3n":"Crear Cotizaci\xf3n"})}),(0,s.jsxs)(l.aY,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(b,{control:v.control,name:"companyId",render:e=>{let{field:t}=e;return(0,s.jsxs)(w,{children:[(0,s.jsx)(C,{children:"Empresa"}),(0,s.jsxs)(h.Ph,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(z,{children:(0,s.jsx)(h.i4,{children:(0,s.jsx)(h.ki,{placeholder:"Seleccione una empresa"})})}),(0,s.jsx)(h.Bw,{children:i&&i.map(e=>(0,s.jsx)(h.Ql,{value:e.id,children:e.name},e.id))})]}),(0,s.jsx)(E,{})]})}}),(0,s.jsx)(b,{control:v.control,name:"status",render:e=>{let{field:t}=e;return(0,s.jsxs)(w,{children:[(0,s.jsx)(C,{children:"Estado"}),(0,s.jsxs)(h.Ph,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(z,{children:(0,s.jsx)(h.i4,{children:(0,s.jsx)(h.ki,{placeholder:"Seleccione un estado"})})}),(0,s.jsx)(h.Bw,{children:Object.values(k.gS).map(e=>(0,s.jsx)(h.Ql,{value:e,children:e},e))})]}),(0,s.jsx)(E,{})]})}}),(0,s.jsx)(b,{control:v.control,name:"quoteDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(w,{children:[(0,s.jsx)(C,{children:"Fecha de Cotizaci\xf3n"}),(0,s.jsx)(z,{children:(0,s.jsx)(m.I,{type:"date",...t})}),(0,s.jsx)(E,{})]})}}),(0,s.jsx)(b,{control:v.control,name:"expiryDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(w,{children:[(0,s.jsx)(C,{children:"Fecha de Vencimiento"}),(0,s.jsx)(z,{children:(0,s.jsx)(m.I,{type:"date",...t})}),(0,s.jsx)(E,{})]})}})]}),(0,s.jsx)(b,{control:v.control,name:"notes",render:e=>{let{field:t}=e;return(0,s.jsxs)(w,{children:[(0,s.jsx)(C,{children:"Notas"}),(0,s.jsx)(z,{children:(0,s.jsx)(p,{placeholder:"Notas adicionales sobre la cotizaci\xf3n",...t})}),(0,s.jsx)(E,{})]})}})]})]}),(0,s.jsxs)(l.Zb,{children:[(0,s.jsx)(l.Ol,{children:(0,s.jsx)(l.ll,{children:"\xcdtems de la Cotizaci\xf3n"})}),(0,s.jsxs)(l.aY,{children:[y.map((e,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-4 items-center",children:[(0,s.jsx)(b,{control:v.control,name:"items.".concat(t,".productId"),render:e=>{let{field:a}=e;return(0,s.jsx)(w,{className:"col-span-2",children:(0,s.jsxs)(h.Ph,{onValueChange:e=>{a.onChange(e);let s=f.find(t=>t.id===e);v.setValue("items.".concat(t,".unitPrice"),parseFloat((null==s?void 0:s.price)||"0"))},defaultValue:a.value,children:[(0,s.jsx)(z,{children:(0,s.jsx)(h.i4,{children:(0,s.jsx)(h.ki,{placeholder:"Seleccione un producto"})})}),(0,s.jsx)(h.Bw,{children:f.map(e=>(0,s.jsx)(h.Ql,{value:e.id,children:e.name},e.id))})]})})}}),(0,s.jsx)(b,{control:v.control,name:"items.".concat(t,".quantity"),render:e=>{let{field:t}=e;return(0,s.jsx)(w,{children:(0,s.jsx)(m.I,{type:"number",placeholder:"Cantidad",...t,onChange:e=>t.onChange(parseInt(e.target.value,10)||0)})})}}),(0,s.jsx)(b,{control:v.control,name:"items.".concat(t,".unitPrice"),render:e=>{let{field:t}=e;return(0,s.jsx)(w,{children:(0,s.jsx)(m.I,{type:"text",placeholder:"Precio Unit.",...t,onChange:e=>t.onChange((0,x.LH)(e.target.value)),value:(0,x.eQ)(t.value)})})}}),(0,s.jsx)(u.z,{type:"button",variant:"outline",onClick:()=>I(t),children:(0,s.jsx)(S.XH,{className:"w-4 h-4"})})]},e.id)),(0,s.jsxs)(u.z,{type:"button",variant:"outline",onClick:()=>N({productId:"",quantity:1,unitPrice:0,totalPrice:0,itemVatAmount:0,totalPriceWithVat:0}),children:[(0,s.jsx)(S.pO,{className:"w-4 h-4 mr-2"}),"A\xf1adir \xcdtem"]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,s.jsx)(u.z,{type:"button",variant:"outline",onClick:n,children:"Cancelar"}),(0,s.jsx)(u.z,{type:"submit",children:"Guardar Cotizaci\xf3n"})]})]})})},V=a(6110),T=a(3578),q=e=>{var t,a;let{quote:r,onClose:n}=e;return(0,s.jsx)(V.Vq,{open:!0,onOpenChange:n,children:(0,s.jsxs)(V.cZ,{className:"max-w-3xl",children:[(0,s.jsxs)(V.fK,{children:[(0,s.jsxs)(V.$N,{children:["Detalle de Cotizaci\xf3n - ID: ",r.id.substring(0,8),"..."]}),(0,s.jsx)(V.Be,{children:"Aqu\xed puedes ver los detalles completos de la cotizaci\xf3n seleccionada, incluyendo informaci\xf3n de la empresa, fechas y los \xedtems cotizados."})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 py-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Empresa:"})," ",null===(t=r.company)||void 0===t?void 0:t.name]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Fecha:"})," ",new Date(r.quoteDate).toLocaleDateString()]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Vencimiento:"})," ",r.expiryDate?new Date(r.expiryDate).toLocaleDateString():"N/A"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Estado:"})," ",r.status]}),r.notes&&(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("strong",{children:"Notas:"})," ",r.notes]})]}),(0,s.jsx)("h4",{className:"font-semibold mt-4",children:"\xcdtems de la Cotizaci\xf3n"}),(0,s.jsxs)(T.iA,{children:[(0,s.jsx)(T.xD,{children:(0,s.jsxs)(T.SC,{children:[(0,s.jsx)(T.ss,{children:"Producto"}),(0,s.jsx)(T.ss,{className:"text-center",children:"Cantidad"}),(0,s.jsx)(T.ss,{className:"text-right",children:"Precio Unit."}),(0,s.jsx)(T.ss,{className:"text-right",children:"Total"})]})}),(0,s.jsx)(T.RM,{children:null===(a=r.items)||void 0===a?void 0:a.map(e=>{var t;return(0,s.jsxs)(T.SC,{children:[(0,s.jsx)(T.pj,{children:null===(t=e.product)||void 0===t?void 0:t.name}),(0,s.jsx)(T.pj,{className:"text-center",children:e.quantity}),(0,s.jsx)(T.pj,{className:"text-right",children:(0,x.eQ)(parseFloat(e.unitPrice))}),(0,s.jsx)(T.pj,{className:"text-right",children:(0,x.eQ)(parseFloat(e.totalPriceWithVat))})]},e.id)})})]}),(0,s.jsxs)("div",{className:"flex justify-end mt-4 space-x-4 font-semibold",children:[(0,s.jsx)("div",{children:"Subtotal:"}),(0,s.jsx)("div",{children:(0,x.eQ)(parseFloat(r.subTotalAmount))})]}),(0,s.jsxs)("div",{className:"flex justify-end mt-2 space-x-4 font-semibold",children:[(0,s.jsx)("div",{children:"IVA (19%):"}),(0,s.jsx)("div",{children:(0,x.eQ)(parseFloat(r.totalVatAmount))})]}),(0,s.jsxs)("div",{className:"flex justify-end mt-2 space-x-4 font-bold text-lg",children:[(0,s.jsx)("div",{children:"Total:"}),(0,s.jsx)("div",{children:(0,x.eQ)(parseFloat(r.grandTotalAmount))})]}),(0,s.jsx)(V.cN,{children:(0,s.jsx)(u.z,{onClick:n,children:"Cerrar"})})]})})},R=a(1944),Z=a(4038);let F={async getAllQuotes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=await (0,Z.Z)("/quotes?page=".concat(e,"&limit=").concat(t));return{data:a.data,total:a.total,page:a.currentPage,limit:t,pages:a.pages}},getQuoteById:async e=>(0,Z.Z)("/quotes/".concat(e)),createQuote:async e=>(0,Z.Z)("/quotes",{method:"POST",body:JSON.stringify(e)}),updateQuote:async(e,t)=>(0,Z.Z)("/quotes/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),async deleteQuote(e){await (0,Z.Z)("/quotes/".concat(e),{method:"DELETE"})}};var O=()=>{var e;let{isAuthenticated:t,currentUser:a,isLoading:o}=(0,i.a)(),c=(0,n.useRouter)(),[d,m]=(0,r.useState)(!1),[h,p]=(0,r.useState)([]),[f,g]=(0,r.useState)(null),[j,v]=(0,r.useState)(null),[b,y]=(0,r.useState)(!1),[N,w]=(0,r.useState)(null),[C,z]=(0,r.useState)(!0),[E,D]=(0,r.useState)(null),[A,P]=(0,r.useState)(1),[V,Z]=(0,r.useState)(1),[O,Q]=(0,r.useState)(0),B=(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!t||(null==a?void 0:a.role)!==k.i4.ADMIN&&(null==a?void 0:a.role)!==k.i4.EDITOR&&(null==a?void 0:a.role)!==k.i4.VIEWER){D("No autorizado para ver esta p\xe1gina o no autenticado."),z(!1),t||c.push("/login");return}z(!0);try{let t=await F.getAllQuotes(e);p(t.data),Z(t.pages),P(t.page),Q(t.total)}catch(e){console.error("Error fetching quotes:",e),e.message&&e.message.includes("Unauthorized")?c.push("/login"):D("Error al cargar las cotizaciones.")}finally{z(!1)}},[t,a,c]);(0,r.useEffect)(()=>{o||B(A)},[B,A,o]);let _=(0,r.useCallback)(()=>{v(null),m(!0)},[]),L=(0,r.useCallback)(e=>{v(e),m(!0)},[]),H=(0,r.useCallback)(e=>{w(e),y(!0)},[]),J=(0,r.useCallback)(async()=>{if(N)try{await F.deleteQuote(N.id),B(A),w(null),y(!1)}catch(e){console.error("Error deleting quote:",e),e.message&&e.message.includes("Unauthorized")?c.push("/login"):D("Error al eliminar la cotizaci\xf3n.")}},[N,B,A,c]),M=(0,r.useCallback)(()=>{w(null),y(!1)},[]),U=(0,r.useCallback)(async e=>{try{j?await F.updateQuote(j.id,e):await F.createQuote(e),m(!1),v(null),B(A)}catch(e){console.error("Error saving quote:",e),e.message&&e.message.includes("Unauthorized")?c.push("/login"):D("Error al guardar la cotizaci\xf3n.")}},[j,B,A,c]),W=(0,r.useCallback)(()=>{m(!1),v(null)},[]),Y=(0,r.useCallback)(e=>{g(e)},[]),G=(0,r.useCallback)(()=>{g(null)},[]),X=e=>{P(e)},K=e=>{switch(e){case"DRAFT":return"bg-gray-500/10 text-gray-700 dark:text-gray-400";case"SENT":return"bg-blue-500/10 text-blue-700 dark:text-blue-400";case"ACCEPTED":return"bg-green-500/10 text-green-700 dark:text-green-400";case"REJECTED":return"bg-red-500/10 text-red-700 dark:text-red-400";case"INVOICED":return"bg-purple-500/10 text-purple-700 dark:text-purple-400";default:return"bg-muted text-muted-foreground"}};return o?(0,s.jsx)("div",{className:"text-center py-8",children:"Cargando autenticaci\xf3n..."}):C?(0,s.jsx)("div",{className:"text-center py-8",children:"Cargando cotizaciones..."}):E?(0,s.jsx)("div",{className:"text-center py-8 text-destructive",children:E}):t&&((null==a?void 0:a.role)===k.i4.ADMIN||(null==a?void 0:a.role)===k.i4.EDITOR||(null==a?void 0:a.role)===k.i4.VIEWER)?d?(0,s.jsx)(I,{quoteData:j,onSave:U,onCancel:W}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-semibold text-foreground",children:"Gesti\xf3n de Cotizaciones"}),(0,s.jsxs)(u.z,{className:"w-full sm:w-auto",onClick:_,children:[(0,s.jsx)(S.pO,{className:"w-5 h-5 mr-2"}),(0,s.jsx)("span",{children:"Crear Nueva Cotizaci\xf3n"})]})]}),(0,s.jsx)(l.Zb,{className:"overflow-hidden border",children:(0,s.jsx)(l.aY,{className:"p-0",children:h.length>0?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(T.iA,{children:[(0,s.jsx)(T.xD,{className:"bg-muted/50",children:(0,s.jsxs)(T.SC,{children:[(0,s.jsx)(T.ss,{children:"ID Cotizaci\xf3n"}),(0,s.jsx)(T.ss,{children:"Empresa"}),(0,s.jsx)(T.ss,{className:"hidden sm:table-cell",children:"Fecha"}),(0,s.jsx)(T.ss,{className:"hidden lg:table-cell",children:"Estado"}),(0,s.jsx)(T.ss,{className:"text-right",children:"Total"}),(0,s.jsx)(T.ss,{className:"text-center",children:"Acciones"})]})}),(0,s.jsx)(T.RM,{children:h.map(e=>{var t;return(0,s.jsxs)(T.SC,{className:"hover:bg-accent transition-colors duration-150",children:[(0,s.jsxs)(T.pj,{className:"font-mono text-muted-foreground",children:[e.id.substring(0,8),"..."]}),(0,s.jsx)(T.pj,{children:(0,s.jsx)("div",{className:"text-sm font-medium text-foreground",children:null===(t=e.company)||void 0===t?void 0:t.name})}),(0,s.jsx)(T.pj,{className:"hidden sm:table-cell text-muted-foreground",children:new Date(e.quoteDate).toLocaleDateString()}),(0,s.jsx)(T.pj,{className:"hidden lg:table-cell",children:(0,s.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat(K(e.status)),children:e.status})}),(0,s.jsx)(T.pj,{className:"font-semibold text-primary text-right",children:(0,x.eQ)(e.grandTotalAmount)}),(0,s.jsx)(T.pj,{className:"text-center",children:(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-1 sm:space-x-2",children:[(0,s.jsx)(u.z,{variant:"ghost",size:"sm",onClick:()=>Y(e),title:"Ver Detalles de Cotizaci\xf3n","aria-label":"Ver detalles de cotizaci\xf3n ".concat(e.id.substring(0,8)),children:(0,s.jsx)(S.tE,{className:"w-5 h-5"})}),(0,s.jsx)(u.z,{variant:"ghost",size:"sm",onClick:()=>L(e),title:"Editar Cotizaci\xf3n","aria-label":"Editar cotizaci\xf3n ".concat(e.id.substring(0,8)),children:(0,s.jsx)(S.vd,{className:"w-5 h-5"})}),(0,s.jsx)(u.z,{variant:"ghost",size:"sm",onClick:()=>H(e),title:"Eliminar Cotizaci\xf3n","aria-label":"Eliminar cotizaci\xf3n ".concat(e.id.substring(0,8)),children:(0,s.jsx)(S.XH,{className:"w-5 h-5"})})]})})]},e.id)})})]})}):(0,s.jsxs)("div",{className:"text-center py-12 px-4",children:[(0,s.jsx)(S.YH,{className:"mx-auto h-16 w-16 text-muted-foreground opacity-40"}),(0,s.jsx)("h3",{className:"mt-3 text-xl font-semibold text-foreground",children:"No hay cotizaciones registradas"}),(0,s.jsx)("p",{className:"mt-1.5 text-sm text-muted-foreground",children:"Comienza creando una nueva cotizaci\xf3n para verla listada aqu\xed."}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsxs)(u.z,{type:"button",onClick:_,children:[(0,s.jsx)(S.pO,{className:"w-5 h-5 mr-2"}),(0,s.jsx)("span",{children:"Crear Primera Cotizaci\xf3n"})]})})]})})}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["P\xe1gina ",A," de ",V," (Total: ",O," cotizaciones)"]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(u.z,{variant:"outline",size:"sm",onClick:()=>X(A-1),disabled:A<=1,children:"Anterior"}),(0,s.jsx)(u.z,{variant:"outline",size:"sm",onClick:()=>X(A+1),disabled:A>=V,children:"Siguiente"})]})]})]}),f&&(0,s.jsx)(q,{quote:f,onClose:G}),b&&N&&(0,s.jsx)(R.Z,{isOpen:b,onClose:M,onConfirm:J,title:"Confirmar Eliminaci\xf3n de Cotizaci\xf3n",message:(0,s.jsxs)(s.Fragment,{children:["\xbfEst\xe1s seguro de que quieres eliminar la cotizaci\xf3n ",(0,s.jsxs)("strong",{children:["ID: ",N.id.substring(0,8),"..."]})," para la empresa ",(0,s.jsx)("strong",{children:null===(e=N.company)||void 0===e?void 0:e.name}),"? Esta acci\xf3n no se puede deshacer."]}),confirmText:"Eliminar Cotizaci\xf3n",confirmButtonClass:"bg-destructive hover:bg-destructive/90 text-destructive-foreground",icon:(0,s.jsx)(S.XH,{className:"w-5 h-5 mr-2"})})]}):(0,s.jsx)("div",{className:"text-center py-8 text-destructive",children:"Acceso denegado. No tienes permisos suficientes."})},Q=()=>(0,s.jsx)(O,{})},1944:function(e,t,a){"use strict";var s=a(7437),r=a(2265),n=a(8560);t.Z=e=>{let{isOpen:t,onClose:a,onConfirm:i,title:l,message:o,confirmText:c="Confirmar",cancelText:d="Cancelar",confirmButtonClass:u="bg-primary hover:bg-primary/90 text-primary-foreground",icon:m}=e;return((0,r.useEffect)(()=>{if(!t)return;let e=e=>{"Escape"===e.key&&a()};return window.addEventListener("keydown",e),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,a]),t)?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 dark:bg-black/75 p-4 transition-opacity duration-300 ease-in-out",onClick:a,role:"alertdialog","aria-modal":"true","aria-labelledby":"confirmation-modal-title","aria-describedby":"confirmation-modal-message",children:(0,s.jsxs)("div",{className:"bg-card text-card-foreground rounded-lg shadow-xl w-full max-w-md flex flex-col overflow-hidden border border-border",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-5 border-b border-border",children:[(0,s.jsxs)("h2",{id:"confirmation-modal-title",className:"text-lg sm:text-xl font-semibold text-foreground flex items-center",children:[m&&(0,s.jsx)("span",{className:"mr-2",children:m})," ",l," "]}),(0,s.jsxs)("button",{onClick:a,className:"p-1.5 rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors","aria-label":"Cerrar modal",children:[(0,s.jsx)(n.b0,{className:"w-5 h-5"})," "]})]}),(0,s.jsx)("div",{className:"p-4 sm:p-5",children:(0,s.jsxs)("p",{id:"confirmation-modal-message",className:"text-sm text-foreground",children:[o," "]})}),(0,s.jsxs)("div",{className:"px-4 py-3 sm:p-5 bg-muted/50 border-t border-border flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0 space-y-reverse",children:[(0,s.jsxs)("button",{type:"button",onClick:a,className:"w-full sm:w-auto justify-center px-4 py-2.5 border border-border text-sm font-medium rounded-md text-foreground bg-background hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-ring dark:focus:ring-offset-card transition-colors duration-150",children:[d," "]}),(0,s.jsxs)("button",{type:"button",onClick:i,className:"w-full sm:w-auto justify-center px-4 py-2.5 border border-transparent text-sm font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-card transition-colors duration-150 ".concat(u," focus:ring-current"),children:[c," "]})]})]})}):null}},3647:function(e,t,a){"use strict";a.d(t,{Bw:function(){return m},Ph:function(){return c},Ql:function(){return h},i4:function(){return u},ki:function(){return d}});var s=a(7437),r=a(2265),n=a(8238),i=a(875),l=a(401),o=a(4508);let c=n.fC;n.ZA;let d=n.B4,u=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(n.xz,{ref:t,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,s.jsx)(n.JO,{asChild:!0,children:(0,s.jsx)(i.Z,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=n.xz.displayName;let m=r.forwardRef((e,t)=>{let{className:a,children:r,position:i="popper",...l}=e;return(0,s.jsx)(n.h_,{children:(0,s.jsx)(n.VY,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:i,...l,children:(0,s.jsx)(n.l_,{className:(0,o.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r})})})});m.displayName=n.VY.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.__,{ref:t,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=n.__.displayName;let h=r.forwardRef((e,t)=>{let{className:a,children:r,...i}=e;return(0,s.jsxs)(n.ck,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...i,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{children:(0,s.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(n.eT,{children:r})]})});h.displayName=n.ck.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Z0,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=n.Z0.displayName},9116:function(e,t,a){"use strict";a.d(t,{h:function(){return n}});var s=a(3464);let r=()=>localStorage.getItem("wolfflow_token"),n=s.Z.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=r();return console.log("Auth Token being sent:",t),t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e))},4038:function(e,t,a){"use strict";var s=a(9116);async function r(e,t){try{let a={};return(null==t?void 0:t.headers)&&(t.headers instanceof Headers?t.headers.forEach((e,t)=>{a[t]=e}):Array.isArray(t.headers)?t.headers.forEach(e=>{let[t,s]=e;a[t]=s}):Object.assign(a,t.headers)),(await (0,s.h)(e,{method:(null==t?void 0:t.method)||"GET",data:null==t?void 0:t.body,headers:a})).data}catch(e){if(e.response)throw Error(e.response.data.message||e.response.statusText);if(e.request)throw Error("No response received from server.");throw Error(e.message)}}t.Z=r},1441:function(e,t,a){"use strict";a.d(t,{J:function(){return r}});var s=a(4038);let r={async getAllCompanies(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new URLSearchParams({page:e.toString(),limit:t.toString()});return a.isClient&&r.append("isClient","true"),a.isSupplier&&r.append("isSupplier","true"),(0,s.Z)("/companies?".concat(r.toString()))},getCompanyById:async e=>(0,s.Z)("/companies/".concat(e)),createCompany:async e=>await (0,s.Z)("/companies",{method:"POST",body:JSON.stringify(e)}),updateCompany:async(e,t)=>await (0,s.Z)("/companies/".concat(e),{method:"PATCH",body:JSON.stringify(t)}),async deleteCompany(e){await (0,s.Z)("/companies/".concat(e),{method:"DELETE"})}}},9138:function(e,t,a){"use strict";a.d(t,{M:function(){return r}});var s=a(9116);let r={async getAllProducts(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return(await s.h.get("/products",{params:{page:t,limit:a},headers:{Authorization:"Bearer ".concat(e)}})).data},async searchProducts(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return(await s.h.get("/products/search",{params:{term:t,page:a,limit:r},headers:{Authorization:"Bearer ".concat(e)}})).data},async getPublishedProducts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return(await s.h.get("/products/published",{params:{page:e,limit:t,category:a,searchQuery:r,minPrice:n,maxPrice:i}})).data},getPublishedProductById:async e=>(await s.h.get("/products/published/".concat(e))).data,getProductLots:async(e,t)=>(await s.h.get("/products/".concat(e,"/lots"),{headers:{Authorization:"Bearer ".concat(t)}})).data,getAverageCost:async(e,t)=>(await s.h.get("/products/".concat(e,"/average-cost"),{headers:{Authorization:"Bearer ".concat(t)}})).data,createProduct:async(e,t)=>(await s.h.post("/products",e,{headers:{Authorization:"Bearer ".concat(t)}})).data,updateProduct:async(e,t,a)=>(await s.h.patch("/products/".concat(e),t,{headers:{Authorization:"Bearer ".concat(a)}})).data,async deleteProduct(e,t){await s.h.delete("/products/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})},async uploadTechnicalSheet(e,t,a){let r=new FormData;return r.append("file",t),(await s.h.post("/products/".concat(e,"/technical-sheet"),r,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(a)}})).data},deleteTechnicalSheet:async(e,t)=>(await s.h.delete("/products/".concat(e,"/technical-sheet"),{headers:{Authorization:"Bearer ".concat(t)}})).data}}},function(e){e.O(0,[6137,3464,3937,9432,9008,1752,8560,9479,2971,2117,1744],function(){return e(e.s=1983)}),_N_E=e.O()}]);