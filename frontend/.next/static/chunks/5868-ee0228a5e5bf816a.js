"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5868],{5868:function(e,s,a){a.d(s,{Z:function(){return j}});var r=a(7437),t=a(2265),i=a(2779),l=a(3464);let n=a(257).env.NEXT_PUBLIC_API_URL||"http://localhost:3001",c={async getAllUsers(e){try{return(await l.Z.get("".concat(n,"/users"),{headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){throw console.error("Error fetching users:",e),e}},async getUserById(e,s){try{return(await l.Z.get("".concat(n,"/users/").concat(e),{headers:{Authorization:"Bearer ".concat(s)}})).data}catch(s){throw console.error("Error fetching user ".concat(e,":"),s),s}},async createUser(e,s){try{return(await l.Z.post("".concat(n,"/users"),e,{headers:{Authorization:"Bearer ".concat(s)}})).data}catch(e){throw console.error("Error creating user:",e),e}},async updateUser(e,s,a){try{return(await l.Z.patch("".concat(n,"/users/").concat(e),s,{headers:{Authorization:"Bearer ".concat(a)}})).data}catch(s){throw console.error("Error updating user ".concat(e,":"),s),s}},async deleteUser(e,s){try{await l.Z.delete("".concat(n,"/users/").concat(e),{headers:{Authorization:"Bearer ".concat(s)}})}catch(s){throw console.error("Error deleting user ".concat(e,":"),s),s}}};var o=a(3985),d=a(6070),u=a(2869),m=a(5186),h=a(6815),x=a(3578),p=a(6110),f=a(3647),N=a(8560),j=()=>{let{token:e,isAuthenticated:s,currentUser:a}=(0,i.a)(),[l,n]=(0,t.useState)([]),[j,g]=(0,t.useState)(!0),[w,y]=(0,t.useState)(null),[v,b]=(0,t.useState)(!1),[C,E]=(0,t.useState)(null),[A,_]=(0,t.useState)({firstName:"",lastName:"",email:"",role:o.i4.CLIENT,password:""}),z=(0,t.useCallback)(async()=>{if(!s||!e||(null==a?void 0:a.role)!==o.i4.ADMIN){y("No autorizado para ver esta p\xe1gina."),g(!1);return}try{g(!0);let s=await c.getAllUsers(e);n(s)}catch(e){console.error("Error fetching users:",e),y("Error al cargar los usuarios.")}finally{g(!1)}},[s,e,a]);(0,t.useEffect)(()=>{z()},[z]);let U=e=>{let{id:s,value:a}=e.target;_({...A,[s]:a})},k=e=>{e?(E(e),_({firstName:e.firstName,lastName:e.lastName,email:e.email,role:e.role,password:""})):(E(null),_({firstName:"",lastName:"",email:"",role:o.i4.CLIENT,password:""})),b(!0)},Z=async s=>{if(s.preventDefault(),e)try{C?await c.updateUser(C.id,A,e):await c.createUser(A,e),b(!1),z()}catch(e){console.error("Error saving user:",e),y("Error al guardar el usuario.")}},B=async s=>{if(e&&window.confirm("\xbfEst\xe1s seguro de que quieres eliminar este usuario?"))try{await c.deleteUser(s,e),z()}catch(e){console.error("Error deleting user:",e),y("Error al eliminar el usuario.")}};return j?(0,r.jsx)("div",{className:"text-center py-8",children:"Cargando usuarios..."}):w?(0,r.jsx)("div",{className:"text-center py-8 text-destructive",children:w}):s&&(null==a?void 0:a.role)===o.i4.ADMIN?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-semibold text-foreground",children:"Gesti\xf3n de Usuarios"}),(0,r.jsxs)(p.Vq,{open:v,onOpenChange:b,children:[(0,r.jsx)(p.hg,{asChild:!0,children:(0,r.jsxs)(u.z,{onClick:()=>k(),children:[(0,r.jsx)(N.pO,{className:"mr-2 h-4 w-4"})," A\xf1adir Usuario"]})}),(0,r.jsxs)(p.cZ,{className:"sm:max-w-[425px]",children:[(0,r.jsxs)(p.fK,{children:[(0,r.jsx)(p.$N,{children:C?"Editar Usuario":"A\xf1adir Nuevo Usuario"}),(0,r.jsxs)(p.Be,{children:["Complete los campos a continuaci\xf3n para ",C?"editar el usuario existente":"a\xf1adir un nuevo usuario","."]})]}),(0,r.jsxs)("form",{onSubmit:Z,className:"grid gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(h._,{htmlFor:"firstName",className:"text-right",children:"Nombre"}),(0,r.jsx)(m.I,{id:"firstName",value:A.firstName,onChange:U,className:"col-span-3",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(h._,{htmlFor:"lastName",className:"text-right",children:"Apellido"}),(0,r.jsx)(m.I,{id:"lastName",value:A.lastName,onChange:U,className:"col-span-3",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(h._,{htmlFor:"email",className:"text-right",children:"Email"}),(0,r.jsx)(m.I,{id:"email",type:"email",value:A.email,onChange:U,className:"col-span-3",required:!0})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(h._,{htmlFor:"role",className:"text-right",children:"Rol"}),(0,r.jsxs)(f.Ph,{onValueChange:e=>{_({...A,role:e})},value:A.role,children:[(0,r.jsx)(f.i4,{className:"col-span-3",children:(0,r.jsx)(f.ki,{placeholder:"Seleccionar Rol"})}),(0,r.jsx)(f.Bw,{children:Object.values(o.i4).map(e=>(0,r.jsx)(f.Ql,{value:e,children:e},e))})]})]}),!C&&(0,r.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,r.jsx)(h._,{htmlFor:"password",className:"text-right",children:"Contrase\xf1a"}),(0,r.jsx)(m.I,{id:"password",type:"password",value:A.password,onChange:U,className:"col-span-3",required:!0})]}),(0,r.jsx)(p.cN,{children:(0,r.jsx)(u.z,{type:"submit",children:C?"Guardar Cambios":"A\xf1adir Usuario"})})]})]})]})]}),(0,r.jsx)(d.Zb,{children:(0,r.jsx)(d.aY,{className:"p-0",children:(0,r.jsxs)(x.iA,{children:[(0,r.jsx)(x.xD,{children:(0,r.jsxs)(x.SC,{children:[(0,r.jsx)(x.ss,{children:"Nombre"}),(0,r.jsx)(x.ss,{children:"Email"}),(0,r.jsx)(x.ss,{children:"Rol"}),(0,r.jsx)(x.ss,{children:"Activo"}),(0,r.jsx)(x.ss,{className:"text-right",children:"Acciones"})]})}),(0,r.jsx)(x.RM,{children:l.map(e=>(0,r.jsxs)(x.SC,{children:[(0,r.jsxs)(x.pj,{children:[e.firstName," ",e.lastName]}),(0,r.jsx)(x.pj,{children:e.email}),(0,r.jsx)(x.pj,{children:e.role}),(0,r.jsx)(x.pj,{children:e.isActive?"S\xed":"No"}),(0,r.jsxs)(x.pj,{className:"text-right",children:[(0,r.jsx)(u.z,{variant:"ghost",size:"sm",onClick:()=>k(e),className:"mr-2",children:(0,r.jsx)(N.vd,{className:"h-4 w-4"})}),(0,r.jsx)(u.z,{variant:"ghost",size:"sm",onClick:()=>B(e.id),children:(0,r.jsx)(N.XH,{className:"h-4 w-4"})})]})]},e.id))})]})})})]}):(0,r.jsx)("div",{className:"text-center py-8 text-destructive",children:"Acceso denegado. No tienes permisos de administrador."})}},3647:function(e,s,a){a.d(s,{Bw:function(){return m},Ph:function(){return o},Ql:function(){return h},i4:function(){return u},ki:function(){return d}});var r=a(7437),t=a(2265),i=a(8238),l=a(875),n=a(401),c=a(4508);let o=i.fC;i.ZA;let d=i.B4,u=t.forwardRef((e,s)=>{let{className:a,children:t,...n}=e;return(0,r.jsxs)(i.xz,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...n,children:[t,(0,r.jsx)(i.JO,{asChild:!0,children:(0,r.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=i.xz.displayName;let m=t.forwardRef((e,s)=>{let{className:a,children:t,position:l="popper",...n}=e;return(0,r.jsx)(i.h_,{children:(0,r.jsx)(i.VY,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:(0,r.jsx)(i.l_,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})})});m.displayName=i.VY.displayName,t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(i.__,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...t})}).displayName=i.__.displayName;let h=t.forwardRef((e,s)=>{let{className:a,children:t,...l}=e;return(0,r.jsxs)(i.ck,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.wU,{children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(i.eT,{children:t})]})});h.displayName=i.ck.displayName,t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)(i.Z0,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...t})}).displayName=i.Z0.displayName}}]);