(()=>{var e={};e.id=4425,e.ids=[4425],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},890:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>l,routeModule:()=>m,tree:()=>c}),r(7160),r(8951),r(5866),r(1506);var a=r(3191),s=r(8716),o=r(7922),n=r.n(o),i=r(5231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);r.d(t,d);let c=["",{children:["(public)",{children:["products",{children:["[productId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7160)),"/home/astro/subred-erp/frontend/app/(public)/products/[productId]/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8951)),"/home/astro/subred-erp/frontend/app/(public)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,1506)),"/home/astro/subred-erp/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],l=["/home/astro/subred-erp/frontend/app/(public)/products/[productId]/page.tsx"],u="/(public)/products/[productId]/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(public)/products/[productId]/page",pathname:"/products/[productId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},2580:(e,t,r)=>{Promise.resolve().then(r.bind(r,9252))},9252:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(326),s=r(7577),o=r(5649),n=r(5047),i=r(3255),d=r(4762),c=r(7863),l=r(2643);let u=({productId:e})=>{let[t,r]=(0,s.useState)(null),[u,p]=(0,s.useState)(!0),[m,x]=(0,s.useState)(null),[h,f]=(0,s.useState)(1),[g,b]=(0,s.useState)(null),[y,v]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!1),{addItem:w}=(0,i.j)(),P=(0,n.useRouter)();(0,s.useEffect)(()=>{if(!e){p(!1),x("ID de producto no v\xe1lido.");return}(async()=>{try{p(!0),x(null);let t=await o.M.getPublishedProductById(e);t?(r(t),t.images&&t.images.length>0&&b(t.images[0])):x("Producto no encontrado.")}catch(e){x(e.message||"No se pudo cargar el producto."),console.error(e)}finally{p(!1)}})()},[e]);let k=e=>{f(t=>Math.max(1,t+e))};if(u)return a.jsx("div",{className:"container mx-auto px-4 py-12 text-center text-muted-foreground min-h-[60vh] flex items-center justify-center",children:"Cargando detalles del producto..."});if(m)return a.jsx("div",{className:"container mx-auto px-4 py-12 text-center text-destructive min-h-[60vh] flex items-center justify-center",children:m});if(!t)return a.jsx("div",{className:"container mx-auto px-4 py-12 text-center text-muted-foreground min-h-[60vh] flex items-center justify-center",children:"Producto no disponible."});let S="SERVICE"===t.productType,$=!S&&null!==t.totalStock&&void 0!==t.totalStock&&t.totalStock>0,C=S||$&&t.totalStock>=h,q=1.19*t.price;return a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8 lg:gap-12 items-start",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-4",children:[a.jsx("div",{className:"aspect-square bg-muted rounded-xl overflow-hidden border border-border shadow-sm sticky top-24",children:g?a.jsx("img",{src:g,alt:t.name,className:"w-full h-full object-contain p-2"}):t.images&&t.images.length>0?a.jsx("img",{src:t.images[0],alt:t.name,className:"w-full h-full object-contain p-2"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsx(d.Fj,{className:"w-24 h-24 text-muted-foreground opacity-30"})})}),t.images&&t.images.length>1&&a.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-2.5",children:t.images.map((e,r)=>a.jsx("button",{onClick:()=>b(e),className:`aspect-square bg-muted rounded-lg overflow-hidden border-2 transition-all duration-150 ease-in-out
                              ${g===e?"border-primary shadow-md scale-105":"border-transparent hover:border-border hover:opacity-80"}`,children:a.jsx("img",{src:e,alt:`${t.name} - thumbnail ${r+1}`,className:"w-full h-full object-cover"})},r))})]}),(0,a.jsxs)("div",{className:"lg:col-span-3 space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[t.category&&a.jsx("p",{className:"text-sm font-medium text-primary uppercase tracking-wider",children:t.category}),a.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-foreground leading-tight",children:t.name}),t.sku&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center",children:[a.jsx(d.lO,{className:"w-3.5 h-3.5 mr-1.5"})," SKU: ",t.sku]})]}),(0,a.jsxs)("p",{className:"text-3xl sm:text-4xl font-semibold text-primary",children:[(0,c.eQ)(q),a.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"IVA Incluido"})]}),t.description&&a.jsx("p",{className:"text-base text-muted-foreground leading-relaxed whitespace-pre-wrap",children:t.description}),t.technicalSheetUrl&&a.jsx("div",{className:"pt-4",children:(0,a.jsxs)("a",{href:`http://localhost:3001${t.technicalSheetUrl}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-secondary hover:bg-secondary/80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-secondary",children:[a.jsx(d.YH,{className:"w-5 h-5 mr-2"}),"Descargar Ficha T\xe9cnica"]})}),"PRODUCT"===t.productType&&null!==t.totalStock&&void 0!==t.totalStock&&(0,a.jsxs)("p",{className:`text-sm font-medium flex items-center ${t.totalStock>0?"text-emerald-600 dark:text-emerald-400":"text-destructive"}`,children:[a.jsx(d.vx,{className:"w-4 h-4 mr-1.5"}),t.totalStock>0?`${t.totalStock} unidades disponibles`:"Producto Agotado"]}),a.jsx(l.Zb,{className:"bg-muted/50 dark:bg-card/60 border-border/70",children:(0,a.jsxs)(l.aY,{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("label",{htmlFor:"quantity",className:"text-sm font-medium text-foreground",children:"Cantidad:"}),(0,a.jsxs)("div",{className:"flex items-center border border-input rounded-md bg-background shadow-sm",children:[a.jsx("button",{onClick:()=>k(-1),className:"px-3 py-2 text-lg text-muted-foreground hover:bg-accent rounded-l-md transition-colors focus:outline-none focus:ring-1 focus:ring-primary","aria-label":"Disminuir cantidad",children:a.jsx(d.V_,{className:"w-4 h-4"})}),a.jsx("input",{type:"number",id:"quantity",name:"quantity",value:h,onChange:e=>f(Math.max(1,parseInt(e.target.value,10)||1)),className:"w-12 text-center border-x border-input bg-transparent text-foreground focus:outline-none py-2 appearance-none [-moz-appearance:_textfield]","aria-label":"Cantidad de producto"}),a.jsx("button",{onClick:()=>k(1),className:"px-3 py-2 text-lg text-muted-foreground hover:bg-accent rounded-r-md transition-colors focus:outline-none focus:ring-1 focus:ring-primary","aria-label":"Aumentar cantidad",children:a.jsx(d.pO,{className:"w-4 h-4"})})]})]}),"PRODUCT"===t.productType&&(0,a.jsxs)("div",{className:"flex items-center space-x-2.5 pt-2",children:[a.jsx("input",{type:"checkbox",id:"includeInstallation",checked:y,onChange:e=>v(e.target.checked),className:"h-4 w-4 text-primary border-border rounded focus:ring-2 focus:ring-primary focus:ring-offset-1 dark:focus:ring-offset-card","aria-label":"A\xf1adir servicio de instalaci\xf3n"}),(0,a.jsxs)("label",{htmlFor:"includeInstallation",className:"text-sm text-foreground flex items-center cursor-pointer",children:[a.jsx(d.KY,{className:"w-4 h-4 mr-1.5 text-primary/90"}),"A\xf1adir Servicio de Instalaci\xf3n (+",(0,c.eQ)(5e4),")"]})]}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)("button",{onClick:()=>{t&&(w(t,h,y),N(!0),setTimeout(()=>N(!1),3e3))},disabled:!C||u,className:"w-full sm:w-auto flex items-center justify-center bg-primary hover:bg-primary/90 text-primary-foreground font-semibold py-3 px-8 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 dark:focus:ring-offset-card transition-all duration-200 ease-in-out text-base disabled:opacity-60 disabled:cursor-not-allowed",children:[a.jsx(d.Q1,{className:"w-5 h-5 mr-2.5"}),"A\xf1adir al Carrito"]}),a.jsx("button",{onClick:()=>{t&&(w(t,h,y),P.push("/checkout"))},disabled:!C||u,className:"w-full sm:w-auto flex items-center justify-center bg-secondary hover:bg-secondary/90 text-secondary-foreground font-semibold py-3 px-8 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-secondary focus:ring-offset-2 dark:focus:ring-offset-card transition-all duration-200 ease-in-out text-base disabled:opacity-60 disabled:cursor-not-allowed",children:"Comprar Ahora"})]}),"PRODUCT"===t.productType&&null!==t.totalStock&&void 0!==t.totalStock&&t.totalStock<h&&t.totalStock>0&&(0,a.jsxs)("p",{className:"text-xs text-destructive mt-1",children:["No hay suficiente stock. Solo ",t.totalStock," unidades disponibles."]}),j&&(0,a.jsxs)("div",{className:"mt-3 flex items-center text-sm text-emerald-600 dark:text-emerald-400 transition-opacity duration-300",children:[a.jsx(d.rE,{className:"w-5 h-5 mr-2"}),"\xa1Producto a\xf1adido al carrito!"]})]})}),t.longDescription&&(0,a.jsxs)("div",{className:"prose prose-sm dark:prose-invert max-w-none text-foreground pt-4 border-t border-border/50",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2 text-foreground",children:"Detalles Adicionales:"}),a.jsx("div",{className:"whitespace-pre-wrap text-muted-foreground leading-relaxed",children:t.longDescription})]})]})]})})};function p(){let e=(0,n.useParams)(),t="string"==typeof e.productId?e.productId:"";return t?a.jsx(u,{productId:t}):a.jsx("p",{className:"text-center py-10",children:"Cargando producto..."})}},2643:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>d,SZ:()=>l,Zb:()=>i,aY:()=>u,eW:()=>p,ll:()=>c});var a=r(326),s=r(7577),o=r.n(s),n=r(7863);let i=o().forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("rounded-xl bg-card text-card-foreground shadow-sm","border border-border","transition-all duration-200 ease-in-out","hover:shadow-lg dark:hover:shadow-primary/20","hover:border-border dark:hover:border-primary/40","dark:hover:bg-muted/20",e),...t}));i.displayName="Card";let d=o().forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-5",e),...t}));d.displayName="CardHeader";let c=o().forwardRef(({className:e,...t},r)=>a.jsx("h3",{ref:r,className:(0,n.cn)("text-xl font-semibold leading-none tracking-tight",e),...t}));c.displayName="CardTitle";let l=o().forwardRef(({className:e,...t},r)=>a.jsx("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));l.displayName="CardDescription";let u=o().forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("p-5 pt-0",e),...t}));u.displayName="CardContent";let p=o().forwardRef(({className:e,...t},r)=>a.jsx("div",{ref:r,className:(0,n.cn)("flex items-center p-5 pt-0",e),...t}));p.displayName="CardFooter"},6824:(e,t,r)=>{"use strict";r.d(t,{h:()=>o});var a=r(4099);let s=()=>localStorage.getItem("wolfflow_token"),o=a.Z.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});o.interceptors.request.use(e=>{let t=s();return console.log("Auth Token being sent:",t),t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e))},5649:(e,t,r)=>{"use strict";r.d(t,{M:()=>s});var a=r(6824);let s={getAllProducts:async(e,t=1,r=10)=>(await a.h.get("/products",{params:{page:t,limit:r},headers:{Authorization:`Bearer ${e}`}})).data,searchProducts:async(e,t,r=1,s=10)=>(await a.h.get("/products/search",{params:{term:t,page:r,limit:s},headers:{Authorization:`Bearer ${e}`}})).data,getPublishedProducts:async(e=1,t=10,r,s,o,n)=>(await a.h.get("/products/published",{params:{page:e,limit:t,category:r,searchQuery:s,minPrice:o,maxPrice:n}})).data,getPublishedProductById:async e=>(await a.h.get(`/products/published/${e}`)).data,getProductLots:async(e,t)=>(await a.h.get(`/products/${e}/lots`,{headers:{Authorization:`Bearer ${t}`}})).data,getAverageCost:async(e,t)=>(await a.h.get(`/products/${e}/average-cost`,{headers:{Authorization:`Bearer ${t}`}})).data,createProduct:async(e,t)=>(await a.h.post("/products",e,{headers:{Authorization:`Bearer ${t}`}})).data,updateProduct:async(e,t,r)=>(await a.h.patch(`/products/${e}`,t,{headers:{Authorization:`Bearer ${r}`}})).data,async deleteProduct(e,t){await a.h.delete(`/products/${e}`,{headers:{Authorization:`Bearer ${t}`}})},async uploadTechnicalSheet(e,t,r){let s=new FormData;return s.append("file",t),(await a.h.post(`/products/${e}/technical-sheet`,s,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${r}`}})).data},deleteTechnicalSheet:async(e,t)=>(await a.h.delete(`/products/${e}/technical-sheet`,{headers:{Authorization:`Bearer ${t}`}})).data}},7863:(e,t,r)=>{"use strict";r.d(t,{LH:()=>d,cn:()=>o,eQ:()=>n,fW:()=>c,p6:()=>i});var a=r(1135),s=r(1009);function o(...e){return(0,s.m6)((0,a.W)(e))}function n(e){let t=Number(e);if(isNaN(t))return"$0";let r=Math.abs(t),a=(r%1).toFixed(2).substring(2),s=Math.trunc(r).toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),o=`$${s}`;return"00"!==a&&(o+=`,${a}`),t<0?`-${o}`:o}function i(e){try{let t=new Date(e),r=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),s=t.getFullYear();return`${r}/${a}/${s}`}catch(t){return console.error("Invalid date provided to formatDate:",e),"Fecha inv\xe1lida"}}function d(e){if("string"!=typeof e)return NaN;let t=parseFloat(e.replace(/\$\s?|(,*)/g,"").replace(/\./g,"").replace(",","."));return isNaN(t)?0:t}function c(e){if("string"!=typeof e||(e=e.replace(/\./g,"").replace(/-/g,"")).length<2)return!1;let t=e.slice(0,-1),r=e.slice(-1).toUpperCase(),a=0,s=2;for(let e=t.length-1;e>=0;e--)a+=parseInt(t[e],10)*s,++s>7&&(s=2);let o=11-a%11;return(11===o?"0":10===o?"K":o.toString())===r}},5047:(e,t,r)=>{"use strict";var a=r(7389);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},7160:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(8570).createProxy)(String.raw`/home/astro/subred-erp/frontend/app/(public)/products/[productId]/page.tsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[7364,434,325,6226,4278,5459],()=>r(890));module.exports=a})();