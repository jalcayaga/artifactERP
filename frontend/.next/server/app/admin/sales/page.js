(()=>{var e={};e.id=3603,e.ids=[3603],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},5770:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d}),a(1180),a(596),a(1506),a(5866);var s=a(3191),r=a(8716),l=a(7922),i=a.n(l),n=a(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d=["",{children:["admin",{children:["sales",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,1180)),"/home/astro/subred-erp/frontend/app/admin/sales/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,596)),"/home/astro/subred-erp/frontend/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,1506)),"/home/astro/subred-erp/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/astro/subred-erp/frontend/app/admin/sales/page.tsx"],u="/admin/sales/page",m={require:a,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/sales/page",pathname:"/admin/sales",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5575:(e,t,a)=>{Promise.resolve().then(a.bind(a,1071))},1071:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>T});var s=a(326),r=a(7577),l=a(5047),i=a(7394),n=a(2643),o=a(4762),d=a(2771),c=a(7863),u=a(5649),m=a(6693);let x={async getAllSales(e=1,t=10){let a=await (0,m.Z)(`/sales?page=${e}&limit=${t}`);return{data:a.data,total:a.total,page:a.currentPage,limit:t,pages:a.pages}},getSaleById:async e=>(0,m.Z)(`/sales/${e}`),createSale:async e=>(0,m.Z)("/sales",{method:"POST",body:JSON.stringify(e)})};var p=a(8588),h=a(6384),f=a(772),g=a(1048),b=a(4474),j=a(5999),y=a(2288);let N=a(4099).Z.create({baseURL:"http://localhost:3001"});N.interceptors.request.use(e=>{let t=localStorage.getItem("wolfflow_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));let v={getAllSuppliers:async()=>(await N.get("/companies",{params:{isSupplier:!0}})).data},w=({isOpen:e,onClose:t,onConfirm:a,stockInfo:l})=>{let[i,n]=(0,r.useState)([]),[d,c]=(0,r.useState)("");return((0,r.useEffect)(()=>{e&&v.getAllSuppliers().then(e=>{n(e)})},[e]),e&&l)?s.jsx(y.Vq,{open:e,onOpenChange:t,children:(0,s.jsxs)(y.cZ,{"aria-describedby":"create-purchase-order-description",children:[(0,s.jsxs)(y.fK,{children:[(0,s.jsxs)(y.$N,{className:"flex items-center",children:[s.jsx(o.lM,{className:"w-6 h-6 mr-2 text-yellow-500"}),s.jsx("span",{children:"Stock Insuficiente"})]}),(0,s.jsxs)(y.Be,{id:"create-purchase-order-description",className:"pt-2",children:["No hay suficiente stock para el producto"," ",s.jsx("strong",{children:l.productName}),".",s.jsx("br",{}),"Necesitas ",s.jsx("strong",{children:l.quantityNeeded})," y solo hay"," ",s.jsx("strong",{children:l.quantityAvailable})," disponibles.",s.jsx("br",{}),s.jsx("br",{}),"\xbfDeseas crear una orden de compra para adquirir las unidades faltantes?"]})]}),(0,s.jsxs)("div",{className:"py-4",children:[s.jsx("label",{htmlFor:"supplier-select",className:"block text-sm font-medium text-gray-700",children:"Proveedor"}),(0,s.jsxs)(b.Ph,{onValueChange:c,value:d,children:[s.jsx(b.i4,{id:"supplier-select",children:s.jsx(b.ki,{placeholder:"Seleccione un proveedor"})}),s.jsx(b.Bw,{children:i.map(e=>s.jsx(b.Ql,{value:e.id,children:e.name},e.id))})]})]}),(0,s.jsxs)(y.cN,{children:[s.jsx(f.z,{variant:"ghost",onClick:t,children:"Cancelar"}),s.jsx(f.z,{onClick:()=>{if(!d){alert("Por favor, seleccione un proveedor.");return}let e=l.quantityNeeded-l.quantityAvailable;a(l.productId,e,d),t()},disabled:!d,children:"Crear Orden de Compra"})]})]})}):null};var E=a(9292);let A=({saleData:e,onSave:t,onCancel:a})=>{let{token:l,currentUser:m}=(0,i.a)(),[y,N]=(0,r.useState)(""),[v,A]=(0,r.useState)([]),[C,P]=(0,r.useState)(new Date().toISOString().split("T")[0]),[S,D]=(0,r.useState)(""),[I,k]=(0,r.useState)([]),[T,R]=(0,r.useState)(""),[V,z]=(0,r.useState)([]),[O,F]=(0,r.useState)(null),[_,$]=(0,r.useState)([]),[q,L]=(0,r.useState)(""),[B,Z]=(0,r.useState)(""),[Q,G]=(0,r.useState)(null),[U,M]=(0,r.useState)({}),[H,Y]=(0,r.useState)({}),[J,W]=(0,r.useState)(!1),[X,K]=(0,r.useState)(!1),[ee,et]=(0,r.useState)(null),ea=(0,r.useMemo)(()=>!!e,[e]);(0,r.useEffect)(()=>{l&&p.J.getAllCompanies().then(e=>{Array.isArray(e)?A(e.filter(e=>e.isClient)):A(e.data.filter(e=>e.isClient))}).catch(e=>console.error("Error fetching companies:",e))},[l]),(0,r.useEffect)(()=>{e?(N(e.companyId),P(new Date(e.createdAt).toISOString().split("T")[0]),D(e.customerNotes||"")):(N(""),P(new Date().toISOString().split("T")[0]),D("")),k([]),M({}),Y({}),R(""),z([]),F(null),$([]),L(""),Z(""),G(null)},[e,m]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{T.length>2&&l?u.M.searchProducts(l,T).then(e=>z(e.data)).catch(e=>console.error("Error searching products:",e)):z([])},300);return()=>clearTimeout(e)},[T,l]);let es=(0,r.useCallback)(async e=>{if(F(e),R(e.name),z([]),Z(e.price.toString()),G(null),"PRODUCT"===e.productType&&l)try{let t=await u.M.getProductLots(e.id,l);$(t)}catch(e){console.error("Error fetching product lots:",e),j.Am.error("Error al cargar los lotes del producto."),$([])}else $([])},[l]),{subTotal:er,totalVatAmount:el,grandTotal:ei}=(0,r.useMemo)(()=>{let e=I.reduce((e,t)=>e+parseFloat(t.totalPrice.toString()),0),t=I.reduce((e,t)=>e+parseFloat(t.itemVatAmount.toString()),0);return{subTotal:e,totalVatAmount:t,grandTotal:e+t}},[I]),en=()=>{let e={};O||(e.product="Debe seleccionar un producto.");let t=parseFloat(q);(isNaN(t)||t<=0)&&(e.quantity="La cantidad debe ser un n\xfamero positivo.");let a=parseFloat(B);return(isNaN(a)||a<0)&&(e.price="El precio debe ser un n\xfamero positivo o cero."),O?.productType!=="PRODUCT"||Q||(e.lot="Debe seleccionar un lote para productos f\xedsicos."),Y(e),0===Object.keys(e).length},eo=(0,r.useCallback)(()=>{if(!en()||!O)return;let e=parseFloat(q),t=parseFloat(B),a=e*t,s=.19*a,r={productId:O.id,quantity:e,unitPrice:t,totalPrice:a,itemVatAmount:s,totalPriceWithVat:a+s};k(e=>[...e,r]),R(""),F(null),$([]),L(""),Z(""),G(null),Y({})},[O,q,B,Q]),ed=(0,r.useCallback)(e=>{k(t=>t.filter((t,a)=>a!==e))},[]),ec=()=>{let e={};return y||(e.selectedCompanyId="Debe seleccionar un cliente."),C||(e.saleDate="La fecha de venta es requerida."),0===I.length&&(e.items="Debe a\xf1adir al menos un art\xedculo a la venta."),M(e),0===Object.keys(e).length},eu=async a=>{if(a.preventDefault(),ec()){if(!m?.id){j.Am.error("No se pudo determinar el usuario actual.");return}W(!0);try{let a={userId:m.id,companyId:y,status:e?.status||d.iF.PENDING_PAYMENT,paymentStatus:e?.paymentStatus||d.bG.PENDING,subTotalAmount:er,vatAmount:el,vatRatePercent:19,discountAmount:0,shippingAmount:0,grandTotalAmount:ei,currency:"CLP",shippingAddress:e?.shippingAddress||void 0,billingAddress:e?.billingAddress||void 0,customerNotes:S.trim()||void 0,paymentMethod:e?.paymentMethod||void 0,items:I.map(e=>({...e,unitPrice:e.unitPrice,totalPrice:e.totalPrice,itemVatAmount:e.itemVatAmount,totalPriceWithVat:e.totalPriceWithVat}))},s=await x.createSale(a);j.Am.success(`Venta ${s.id.substring(0,8)}... creada exitosamente.`),t(s)}catch(e){console.error("Error creating sale:",e),e.response?.data?.errorCode==="OUT_OF_STOCK"?(et(e.response.data),K(!0)):j.Am.error(e.message||"Error al crear la venta.")}finally{W(!1)}}},em=async(e,t,a)=>{try{let s=await E.B.createPurchase({companyId:a,status:"PENDING",items:[{productId:e,quantity:t,unitPrice:0,totalPrice:0,itemVatAmount:0,totalPriceWithVat:0}],subTotalAmount:0,totalVatAmount:0,grandTotal:0,purchaseDate:new Date().toISOString()});j.Am.success(`Orden de compra creada: ${s.id}`)}catch(e){console.error("Error creating purchase order:",e),j.Am.error("Error al crear la orden de compra.")}},ex="mt-1 text-xs text-destructive";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.Zb,{className:"max-w-4xl mx-auto border",children:[s.jsx(n.Ol,{children:s.jsx(n.ll,{className:"text-xl",children:ea?`Editar Venta: ${e?.id.substring(0,8)}...`:"Crear Nueva Venta"})}),(0,s.jsxs)("form",{onSubmit:eu,children:[(0,s.jsxs)(n.aY,{className:"space-y-6 pt-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(g._,{htmlFor:"client-select",children:["Cliente ",s.jsx("span",{className:"text-red-500",children:"*"})]}),(0,s.jsxs)(b.Ph,{onValueChange:N,value:y,children:[s.jsx(b.i4,{id:"client-select",children:s.jsx(b.ki,{placeholder:"Selecciona un cliente"})}),s.jsx(b.Bw,{children:v.map(e=>(0,s.jsxs)(b.Ql,{value:e.id,children:[e.name," ",e.email?`(${e.email})`:""]},e.id))})]}),U.selectedCompanyId&&s.jsx("p",{id:"client-error",className:ex,children:U.selectedCompanyId})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(g._,{htmlFor:"sale-date",children:["Fecha de Venta ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(h.I,{type:"date",id:"sale-date",value:C,onChange:e=>P(e.target.value),"aria-describedby":"saleDate-error"}),U.saleDate&&s.jsx("p",{id:"saleDate-error",className:ex,children:U.saleDate})]})]}),(0,s.jsxs)("div",{className:"space-y-4 p-4 border border-border rounded-md bg-card",children:[(0,s.jsxs)("h3",{className:"text-md font-semibold text-foreground",children:["Art\xedculos de la Venta (IVA ",19,"%)"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-4 items-end",children:[(0,s.jsxs)("div",{className:"sm:col-span-5 relative",children:[s.jsx(g._,{htmlFor:"product-search",className:"block text-xs font-medium text-muted-foreground",children:"Buscar Producto"}),s.jsx(h.I,{id:"product-search",type:"text",value:T,onChange:e=>R(e.target.value),placeholder:"Escribe para buscar productos...",className:"pr-10"}),s.jsx(o.W1,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),V.length>0&&s.jsx("div",{className:"absolute z-10 w-full bg-popover border border-border rounded-md shadow-lg mt-1 max-h-60 overflow-y-auto",children:V.map(e=>(0,s.jsxs)("div",{className:"px-3 py-2 hover:bg-accent cursor-pointer text-sm",onClick:()=>es(e),children:[e.name," ",e.sku?`(${e.sku})`:""," - ",(0,c.eQ)(e.price)]},e.id))}),H.product&&s.jsx("p",{className:ex,children:H.product})]}),O&&(0,s.jsxs)("div",{className:"sm:col-span-7 grid grid-cols-1 sm:grid-cols-5 gap-4",children:[(0,s.jsxs)("div",{className:"sm:col-span-2",children:[s.jsx(g._,{htmlFor:"item-quantity",className:"block text-xs font-medium text-muted-foreground",children:"Cant."}),s.jsx(h.I,{type:"number",id:"item-quantity",value:q,onChange:e=>L(e.target.value),placeholder:"0"}),H.quantity&&s.jsx("p",{className:ex,children:H.quantity})]}),(0,s.jsxs)("div",{className:"sm:col-span-3",children:[s.jsx(g._,{htmlFor:"item-price",className:"block text-xs font-medium text-muted-foreground",children:"P. Unit. Venta (sin IVA)"}),s.jsx(h.I,{type:"number",id:"item-price",value:B,onChange:e=>Z(e.target.value),placeholder:"0.00",step:"0.01"}),H.price&&s.jsx("p",{className:ex,children:H.price})]}),"PRODUCT"===O.productType&&_.length>0&&(0,s.jsxs)("div",{className:"sm:col-span-5",children:[s.jsx(g._,{htmlFor:"lot-select",className:"block text-xs font-medium text-muted-foreground",children:"Seleccionar Lote (Precio Compra)"}),(0,s.jsxs)(b.Ph,{onValueChange:G,value:Q||"",children:[s.jsx(b.i4,{id:"lot-select",children:s.jsx(b.ki,{placeholder:"Selecciona un lote"})}),s.jsx(b.Bw,{children:_.map(e=>(0,s.jsxs)(b.Ql,{value:e.id,children:["Lote: ",e.lotNumber," - Cant: ",e.currentQuantity," - Compra: ",(0,c.eQ)(e.purchasePrice)]},e.id))})]}),H.lot&&s.jsx("p",{className:ex,children:H.lot})]}),s.jsx("div",{className:"sm:col-span-5",children:(0,s.jsxs)(f.z,{type:"button",onClick:eo,className:"w-full",children:[s.jsx(o.pO,{className:"w-4 h-4 mr-2"})," A\xf1adir Art\xedculo"]})})]})]}),I.length>0?s.jsx("div",{className:"mt-4 -mx-4 sm:mx-0 overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[s.jsx("thead",{className:"bg-muted/50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Producto / Servicio"}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Cant."}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"P.Unit (s/IVA)"}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Subtotal (s/IVA)"}),s.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider hidden sm:table-cell",children:"IVA Item"}),s.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-muted-foreground uppercase tracking-wider"})]})}),s.jsx("tbody",{className:"divide-y divide-border",children:I.map((e,t)=>(0,s.jsxs)("tr",{children:[" ",s.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-foreground",children:e.productId})," ",s.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-muted-foreground text-right",children:e.quantity}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-muted-foreground text-right",children:(0,c.eQ)(e.unitPrice)}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-foreground font-medium text-right",children:(0,c.eQ)(e.totalPrice)}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-muted-foreground text-right hidden sm:table-cell",children:(0,c.eQ)(e.itemVatAmount)}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-center",children:s.jsx("button",{type:"button",onClick:()=>ed(t),title:"Eliminar Art\xedculo",className:"text-destructive hover:text-destructive/80 p-1 rounded-md hover:bg-destructive/10 transition-colors",children:s.jsx(o.XH,{className:"w-4 h-4"})})})]},t))})]})}):s.jsx("p",{className:"text-sm text-center text-muted-foreground italic py-3",children:"A\xfan no se han a\xf1adido art\xedculos a la venta."}),U.items&&s.jsx("p",{className:ex+" text-center",children:U.items})]}),(0,s.jsxs)("div",{className:"mt-6 pt-4 border-t border-border space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-end items-center",children:[s.jsx("span",{className:"text-md font-medium text-muted-foreground",children:"Subtotal (sin IVA):"}),s.jsx("span",{className:"ml-4 text-md font-semibold text-foreground w-32 text-right",children:(0,c.eQ)(er)})]}),(0,s.jsxs)("div",{className:"flex justify-end items-center",children:[(0,s.jsxs)("span",{className:"text-md font-medium text-muted-foreground",children:["IVA (",19,"%):"]}),s.jsx("span",{className:"ml-4 text-md font-semibold text-foreground w-32 text-right",children:(0,c.eQ)(el)})]}),(0,s.jsxs)("div",{className:"flex justify-end items-center mt-1 pt-1 border-t border-border/50",children:[s.jsx("span",{className:"text-lg font-bold text-foreground",children:"Total Venta:"}),s.jsx("span",{className:"ml-4 text-2xl font-bold text-primary w-32 text-right",children:(0,c.eQ)(ei)})]})]}),(0,s.jsxs)("div",{children:[s.jsx(g._,{htmlFor:"sale-observations",children:"Observaciones"}),s.jsx("textarea",{id:"sale-observations",value:S,onChange:e=>D(e.target.value),rows:3,className:"mt-1 block w-full px-3 py-2 border rounded-md shadow-sm text-sm transition-colors duration-150 bg-background border-border placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:border-ring text-foreground",placeholder:"A\xf1adir notas adicionales sobre la venta..."})]})]}),(0,s.jsxs)(n.eW,{className:"flex flex-col sm:flex-row justify-end items-center gap-3 pt-6",children:[s.jsx(f.z,{type:"button",variant:"outline",onClick:a,className:"w-full sm:w-auto order-2 sm:order-1",children:"Cancelar"}),s.jsx(f.z,{type:"submit",className:"w-full sm:w-auto order-1 sm:order-2",disabled:J,children:J?"Guardando...":ea?"Actualizar Venta":"Guardar Venta"})]})]})]}),s.jsx(w,{isOpen:X,onClose:()=>K(!1),onConfirm:em,stockInfo:ee})]})};var C=a(4269);let P=({label:e,value:t,icon:a})=>t||"object"==typeof t||"boolean"==typeof t||"number"==typeof t?(0,s.jsxs)("div",{className:"flex items-start py-1.5",children:[a&&s.jsx(a,{className:"w-5 h-5 mr-2.5 mt-0.5 text-muted-foreground opacity-80 flex-shrink-0"}),(0,s.jsxs)("div",{className:"flex-grow",children:[s.jsx("dt",{className:"text-xs font-medium text-muted-foreground",children:e}),s.jsx("dd",{className:"text-sm text-foreground",children:t||s.jsx("span",{className:"italic",children:"N/A"})})]})]}):null,S=({sale:e,onClose:t,onInvoiceCreated:a})=>{let[l,i]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{if(!e)return;let a=e=>{"Escape"===e.key&&t()};return window.addEventListener("keydown",a),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",a),document.body.style.overflow="unset"}},[e,t]),!e)return null;let n=async()=>{if(e){i(!0);try{await C.q.createInvoiceFromOrder(e.id),j.Am.success("Factura creada exitosamente"),a(),t()}catch(e){j.Am.error(e.message||"Error al crear la factura")}finally{i(!1)}}},d=e=>e.totalPrice+e.itemVatAmount;return s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 dark:bg-black/75 p-4 transition-opacity duration-300 ease-in-out",onClick:t,role:"dialog","aria-modal":"true","aria-labelledby":"sale-detail-modal-title",children:(0,s.jsxs)("div",{className:"bg-card text-card-foreground rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col overflow-hidden border border-border",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-5 border-b border-border",children:[(0,s.jsxs)("h2",{id:"sale-detail-modal-title",className:"text-lg sm:text-xl font-semibold text-foreground flex items-center",children:[s.jsx(o.Q1,{className:"w-6 h-6 mr-2 text-primary"}),"Detalle de Venta (ID: ",e.id.substring(0,8),"...)"]}),s.jsx("button",{onClick:t,className:"p-1.5 rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors","aria-label":"Cerrar modal",children:s.jsx(o.b0,{className:"w-5 h-5"})})]}),(0,s.jsxs)("div",{className:"p-4 sm:p-5 space-y-4 overflow-y-auto",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-3 mb-3",children:[s.jsx(P,{label:"Empresa",value:e.company?.name}),s.jsx(P,{label:"Fecha de Venta",value:new Date(e.createdAt).toLocaleDateString(),icon:o.Qu}),e.customerNotes&&s.jsx("div",{className:"md:col-span-2",children:s.jsx(P,{label:"Observaciones",value:e.customerNotes,icon:o.Zw})})]}),s.jsx("h3",{className:"text-md font-semibold text-foreground mb-1.5",children:"Art\xedculos"}),s.jsx("div",{className:"overflow-x-auto border border-border rounded-md",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-border",children:[s.jsx("thead",{className:"bg-muted/50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{className:"px-3 py-2.5 text-left text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Producto / Servicio"}),s.jsx("th",{className:"px-3 py-2.5 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Cant."}),s.jsx("th",{className:"px-3 py-2.5 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider hidden sm:table-cell",children:"P.Unit (s/IVA)"}),s.jsx("th",{className:"px-3 py-2.5 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Subtotal (s/IVA)"}),(0,s.jsxs)("th",{className:"px-3 py-2.5 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider hidden md:table-cell",children:["IVA (",e.vatRatePercent,"%)"]}),s.jsx("th",{className:"px-3 py-2.5 text-right text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"Total Item"})]})}),s.jsx("tbody",{className:"divide-y divide-border",children:e.orderItems?.map(e=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm text-foreground",children:e.product?.name}),s.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm text-muted-foreground text-right",children:e.quantity}),s.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm text-muted-foreground text-right hidden sm:table-cell",children:c.eQ(e.unitPrice)}),s.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm text-foreground text-right",children:c.eQ(e.totalPrice)}),s.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm text-muted-foreground text-right hidden md:table-cell",children:c.eQ(e.itemVatAmount)}),s.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm font-medium text-foreground text-right",children:c.eQ(d(e))})]},e.id))})]})}),(0,s.jsxs)("div",{className:"mt-4 pt-3 border-t border-border space-y-1.5",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Subtotal (sin IVA):"}),s.jsx("span",{className:"text-sm font-semibold text-foreground",children:(0,c.eQ)(e.subTotalAmount)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-sm font-medium text-muted-foreground",children:["Total IVA (",e.vatRatePercent,"%):"]}),s.jsx("span",{className:"text-sm font-semibold text-foreground",children:(0,c.eQ)(e.vatAmount)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center pt-1.5 border-t border-border/50",children:[s.jsx("span",{className:"text-md font-bold text-foreground",children:"Gran Total:"}),s.jsx("span",{className:"text-lg font-bold text-primary",children:(0,c.eQ)(e.grandTotalAmount)})]})]})]}),(0,s.jsxs)("div",{className:"px-4 py-3 sm:p-4 bg-muted/50 border-t border-border flex justify-end space-x-2",children:[s.jsx(f.z,{type:"button",onClick:t,variant:"outline",children:"Cerrar"}),s.jsx(f.z,{type:"button",onClick:n,disabled:l,children:l?"Creando Factura...":"Crear Factura"})]})]})})};var D=a(6340),I=a(5940);let k=()=>{let{isAuthenticated:e,currentUser:t,isLoading:a}=(0,i.a)(),u=(0,l.useRouter)(),[m,p]=(0,r.useState)(!1),[h,g]=(0,r.useState)([]),[b,y]=(0,r.useState)(null),[N,v]=(0,r.useState)(null),[w,E]=(0,r.useState)(!1),[P,k]=(0,r.useState)(null),[T,R]=(0,r.useState)(!0),[V,z]=(0,r.useState)(null),[O,F]=(0,r.useState)(1),[_,$]=(0,r.useState)(1),[q,L]=(0,r.useState)(0),B=(0,r.useCallback)(async(a=1)=>{if(!e||t?.role!==d.i4.ADMIN&&t?.role!==d.i4.EDITOR&&t?.role!==d.i4.VIEWER){z("No autorizado para ver esta p\xe1gina o no autenticado."),R(!1),e||u.push("/login");return}R(!0);try{let e=await x.getAllSales(a);g(e.data),$(e.pages),F(e.page),L(e.total)}catch(e){console.error("Error fetching sales:",e),e.message&&e.message.includes("Unauthorized")?u.push("/login"):z("Error al cargar las ventas.")}finally{R(!1)}},[e,t,u]);(0,r.useEffect)(()=>{a||B(O)},[B,O,a]);let Z=(0,r.useCallback)(()=>{v(null),p(!0)},[]),Q=(0,r.useCallback)(e=>{v(e),p(!0)},[]),G=(0,r.useCallback)(e=>{k(e),E(!0)},[]),U=(0,r.useCallback)(async()=>{if(P)try{B(O),k(null),E(!1)}catch(e){console.error("Error deleting sale:",e),e.message&&e.message.includes("Unauthorized")?u.push("/login"):z("Error al eliminar la venta.")}},[P,B,O,u]),M=(0,r.useCallback)(()=>{k(null),E(!1)},[]),H=(0,r.useCallback)(async e=>{try{p(!1),v(null),B(O)}catch(e){console.error("Error saving sale:",e),e.message&&e.message.includes("Unauthorized")?u.push("/login"):z("Error al guardar la venta.")}},[B,O,u]),Y=(0,r.useCallback)(()=>{p(!1),v(null)},[]),J=(0,r.useCallback)(e=>{y(e)},[]),W=(0,r.useCallback)(()=>{y(null)},[]),X=e=>{F(e)},K=async e=>{try{let t=await C.q.createInvoiceFromOrder(e);j.Am.success(`Factura ${t.invoiceNumber} creada exitosamente.`),B(O)}catch(e){console.error("Error creating invoice:",e),j.Am.error(e.response?.data?.message||"Error al crear la factura.")}};return a?s.jsx("div",{className:"text-center py-8",children:"Cargando autenticaci\xf3n..."}):T?s.jsx("div",{className:"text-center py-8",children:"Cargando ventas..."}):V?s.jsx("div",{className:"text-center py-8 text-destructive",children:V}):e&&(t?.role===d.i4.ADMIN||t?.role===d.i4.EDITOR||t?.role===d.i4.VIEWER)?m?s.jsx(A,{saleData:N,onSave:H,onCancel:Y}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[s.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold text-foreground",children:"Gesti\xf3n de Ventas"}),(0,s.jsxs)(f.z,{className:"w-full sm:w-auto",onClick:Z,children:[s.jsx(o.pO,{className:"w-5 h-5 mr-2"}),s.jsx("span",{children:"Crear Nueva Venta"})]})]}),s.jsx(n.Zb,{className:"overflow-hidden border",children:s.jsx(n.aY,{className:"p-0",children:h.length>0?s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)(I.iA,{children:[s.jsx(I.xD,{className:"bg-muted/50",children:(0,s.jsxs)(I.SC,{children:[s.jsx(I.ss,{children:"ID Venta"}),s.jsx(I.ss,{children:"Empresa"}),s.jsx(I.ss,{className:"hidden sm:table-cell",children:"Fecha"}),s.jsx(I.ss,{className:"hidden md:table-cell text-right",children:"Subtotal"}),s.jsx(I.ss,{className:"hidden lg:table-cell text-right",children:"IVA"}),s.jsx(I.ss,{className:"text-right",children:"Total"}),s.jsx(I.ss,{className:"text-center",children:"Acciones"})]})}),s.jsx(I.RM,{children:h.map(e=>(0,s.jsxs)(I.SC,{className:"hover:bg-accent transition-colors duration-150",children:[(0,s.jsxs)(I.pj,{className:"font-mono text-muted-foreground",children:[e.id.substring(0,8),"..."]}),(0,s.jsxs)(I.pj,{children:[s.jsx("div",{className:"font-medium text-foreground",children:e.company?.name}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground sm:hidden",children:[new Date(e.createdAt).toLocaleDateString()," - Total: ",(0,c.eQ)(e.grandTotalAmount)]})]}),s.jsx(I.pj,{className:"hidden sm:table-cell text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()}),s.jsx(I.pj,{className:"hidden md:table-cell text-muted-foreground text-right",children:(0,c.eQ)(e.subTotalAmount)}),s.jsx(I.pj,{className:"hidden lg:table-cell text-muted-foreground text-right",children:(0,c.eQ)(e.vatAmount)}),s.jsx(I.pj,{className:"font-semibold text-primary text-right",children:(0,c.eQ)(e.grandTotalAmount)}),s.jsx(I.pj,{className:"text-center",children:(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-1 sm:space-x-2",children:[s.jsx(f.z,{variant:"ghost",size:"sm",onClick:()=>J(e),title:"Ver Detalles de Venta","aria-label":`Ver detalles de venta ${e.id.substring(0,8)}`,children:s.jsx(o.tE,{className:"w-5 h-5"})}),s.jsx(f.z,{variant:"ghost",size:"sm",onClick:()=>Q(e),title:"Editar Venta","aria-label":`Editar venta ${e.id.substring(0,8)}`,children:s.jsx(o.vd,{className:"w-5 h-5"})}),s.jsx(f.z,{variant:"ghost",size:"sm",onClick:()=>G(e),title:"Eliminar Venta","aria-label":`Eliminar venta ${e.id.substring(0,8)}`,children:s.jsx(o.XH,{className:"w-5 h-5"})}),(e.status===d.iF.DELIVERED||e.status===d.iF.SHIPPED)&&!e.invoice&&s.jsx(f.z,{variant:"ghost",size:"sm",onClick:()=>K(e.id),title:"Generar Factura","aria-label":`Generar factura para la venta ${e.id.substring(0,8)}`,children:s.jsx(o.YH,{className:"w-5 h-5"})})]})})]},e.id))})]})}):(0,s.jsxs)("div",{className:"text-center py-12 px-4",children:[s.jsx(o.Q1,{className:"mx-auto h-16 w-16 text-muted-foreground opacity-40"}),s.jsx("h3",{className:"mt-3 text-xl font-semibold text-foreground",children:"No hay ventas registradas"}),s.jsx("p",{className:"mt-1.5 text-sm text-muted-foreground",children:"Comienza creando una nueva venta para verla listada aqu\xed."}),s.jsx("div",{className:"mt-6",children:(0,s.jsxs)(f.z,{type:"button",onClick:Z,children:[s.jsx(o.pO,{className:"w-5 h-5 mr-2"}),s.jsx("span",{children:"Crear Primera Venta"})]})})]})})}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[s.jsx("div",{children:(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["P\xe1gina ",O," de ",_," (Total: ",q," ventas)"]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx(f.z,{variant:"outline",size:"sm",onClick:()=>X(O-1),disabled:O<=1,children:"Anterior"}),s.jsx(f.z,{variant:"outline",size:"sm",onClick:()=>X(O+1),disabled:O>=_,children:"Siguiente"})]})]})]}),b&&s.jsx(S,{sale:b,onClose:W,onInvoiceCreated:()=>B(O)}),w&&P&&s.jsx(D.Z,{isOpen:w,onClose:M,onConfirm:U,title:"Confirmar Eliminaci\xf3n de Venta",message:(0,s.jsxs)(s.Fragment,{children:["\xbfEst\xe1s seguro de que quieres eliminar la venta ",(0,s.jsxs)("strong",{children:["ID: ",P.id.substring(0,8),"..."]})," para la empresa ",s.jsx("strong",{children:P.company?.name}),"? Esta acci\xf3n no se puede deshacer."]}),confirmText:"Eliminar Venta",confirmButtonClass:"bg-destructive hover:bg-destructive/90 text-destructive-foreground",icon:s.jsx(o.XH,{className:"w-5 h-5 mr-2"})})]}):s.jsx("div",{className:"text-center py-8 text-destructive",children:"Acceso denegado. No tienes permisos suficientes."})};function T(){return s.jsx(k,{})}},6340:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var s=a(326),r=a(7577),l=a(4762);let i=({isOpen:e,onClose:t,onConfirm:a,title:i,message:n,confirmText:o="Confirmar",cancelText:d="Cancelar",confirmButtonClass:c="bg-primary hover:bg-primary/90 text-primary-foreground",icon:u})=>((0,r.useEffect)(()=>{if(!e)return;let a=e=>{"Escape"===e.key&&t()};return window.addEventListener("keydown",a),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",a),document.body.style.overflow="unset"}},[e,t]),e)?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 dark:bg-black/75 p-4 transition-opacity duration-300 ease-in-out",onClick:t,role:"alertdialog","aria-modal":"true","aria-labelledby":"confirmation-modal-title","aria-describedby":"confirmation-modal-message",children:(0,s.jsxs)("div",{className:"bg-card text-card-foreground rounded-lg shadow-xl w-full max-w-md flex flex-col overflow-hidden border border-border",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-5 border-b border-border",children:[(0,s.jsxs)("h2",{id:"confirmation-modal-title",className:"text-lg sm:text-xl font-semibold text-foreground flex items-center",children:[u&&s.jsx("span",{className:"mr-2",children:u})," ",i," "]}),(0,s.jsxs)("button",{onClick:t,className:"p-1.5 rounded-md text-muted-foreground hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-ring transition-colors","aria-label":"Cerrar modal",children:[s.jsx(l.b0,{className:"w-5 h-5"})," "]})]}),s.jsx("div",{className:"p-4 sm:p-5",children:(0,s.jsxs)("p",{id:"confirmation-modal-message",className:"text-sm text-foreground",children:[n," "]})}),(0,s.jsxs)("div",{className:"px-4 py-3 sm:p-5 bg-muted/50 border-t border-border flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3 space-y-2 sm:space-y-0 space-y-reverse",children:[(0,s.jsxs)("button",{type:"button",onClick:t,className:"w-full sm:w-auto justify-center px-4 py-2.5 border border-border text-sm font-medium rounded-md text-foreground bg-background hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-ring dark:focus:ring-offset-card transition-colors duration-150",children:[d," "]}),(0,s.jsxs)("button",{type:"button",onClick:a,className:`w-full sm:w-auto justify-center px-4 py-2.5 border border-transparent text-sm font-medium rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-card transition-colors duration-150 ${c} focus:ring-current`,children:[o," "]})]})]})}):null},772:(e,t,a)=>{"use strict";a.d(t,{z:()=>c});var s=a(326),r=a(7577),l=a.n(r),i=a(4214),n=a(9360),o=a(7863);let d=(0,n.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary-500 text-white hover:bg-primary-600",outline:"border border-primary-500 text-primary-500 hover:bg-primary-50",ghost:"hover:bg-gray-100"},size:{default:"h-10 px-4 py-2",sm:"h-8 px-3 text-xs",lg:"h-12 px-8"}},defaultVariants:{variant:"default",size:"default"}}),c=l().forwardRef(({className:e,variant:t,size:a,asChild:r=!1,...l},n)=>{let c=r?i.g7:"button";return s.jsx(c,{className:(0,o.cn)(d({variant:t,size:a,className:e})),ref:n,...l})});c.displayName="Button"},2288:(e,t,a)=>{"use strict";a.d(t,{$N:()=>h,Be:()=>f,Vq:()=>o,cN:()=>p,cZ:()=>m,fK:()=>x,hg:()=>d});var s=a(326),r=a(7577),l=a(8958),i=a(4019),n=a(7863);let o=l.fC,d=l.xz,c=l.h_;l.x8;let u=r.forwardRef(({className:e,...t},a)=>s.jsx(l.aV,{ref:a,className:(0,n.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));u.displayName=l.aV.displayName;let m=r.forwardRef(({className:e,children:t,...a},r)=>(0,s.jsxs)(c,{children:[s.jsx(u,{}),(0,s.jsxs)(l.VY,{ref:r,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...a,children:[t,(0,s.jsxs)(l.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(i.Z,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));m.displayName=l.VY.displayName;let x=({className:e,...t})=>s.jsx("div",{className:(0,n.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});x.displayName="DialogHeader";let p=({className:e,...t})=>s.jsx("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});p.displayName="DialogFooter";let h=r.forwardRef(({className:e,...t},a)=>s.jsx(l.Dx,{ref:a,className:(0,n.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));h.displayName=l.Dx.displayName;let f=r.forwardRef(({className:e,...t},a)=>s.jsx(l.dk,{ref:a,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));f.displayName=l.dk.displayName},6384:(e,t,a)=>{"use strict";a.d(t,{I:()=>i});var s=a(326),r=a(7577),l=a(7863);let i=r.forwardRef(({className:e,type:t,...a},r)=>s.jsx("input",{type:t,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...a}));i.displayName="Input"},1048:(e,t,a)=>{"use strict";a.d(t,{_:()=>d});var s=a(326),r=a(7577),l=a(4478),i=a(9360),n=a(7863);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=r.forwardRef(({className:e,...t},a)=>s.jsx(l.f,{ref:a,className:(0,n.cn)(o(),e),...t}));d.displayName=l.f.displayName},4474:(e,t,a)=>{"use strict";a.d(t,{Bw:()=>m,Ph:()=>d,Ql:()=>x,i4:()=>u,ki:()=>c});var s=a(326),r=a(7577),l=a(7185),i=a(8393),n=a(2933),o=a(7863);let d=l.fC;l.ZA;let c=l.B4,u=r.forwardRef(({className:e,children:t,...a},r)=>(0,s.jsxs)(l.xz,{ref:r,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[t,s.jsx(l.JO,{asChild:!0,children:s.jsx(i.Z,{className:"h-4 w-4 opacity-50"})})]}));u.displayName=l.xz.displayName;let m=r.forwardRef(({className:e,children:t,position:a="popper",...r},i)=>s.jsx(l.h_,{children:s.jsx(l.VY,{ref:i,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...r,children:s.jsx(l.l_,{className:(0,o.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t})})}));m.displayName=l.VY.displayName,r.forwardRef(({className:e,...t},a)=>s.jsx(l.__,{ref:a,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=l.__.displayName;let x=r.forwardRef(({className:e,children:t,...a},r)=>(0,s.jsxs)(l.ck,{ref:r,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(l.wU,{children:s.jsx(n.Z,{className:"h-4 w-4"})})}),s.jsx(l.eT,{children:t})]}));x.displayName=l.ck.displayName,r.forwardRef(({className:e,...t},a)=>s.jsx(l.Z0,{ref:a,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",e),...t})).displayName=l.Z0.displayName},5940:(e,t,a)=>{"use strict";a.d(t,{RM:()=>o,SC:()=>d,iA:()=>i,pj:()=>u,ss:()=>c,xD:()=>n});var s=a(326),r=a(7577),l=a(7863);let i=r.forwardRef(({className:e,...t},a)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:a,className:(0,l.cn)("w-full caption-bottom text-sm",e),...t})}));i.displayName="Table";let n=r.forwardRef(({className:e,...t},a)=>s.jsx("thead",{ref:a,className:(0,l.cn)("[&_tr]:border-b",e),...t}));n.displayName="TableHeader";let o=r.forwardRef(({className:e,...t},a)=>s.jsx("tbody",{ref:a,className:(0,l.cn)("[&_tr:last-child]:border-0",e),...t}));o.displayName="TableBody",r.forwardRef(({className:e,...t},a)=>s.jsx("tfoot",{ref:a,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:hidden",e),...t})).displayName="TableFooter";let d=r.forwardRef(({className:e,...t},a)=>s.jsx("tr",{ref:a,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));d.displayName="TableRow";let c=r.forwardRef(({className:e,...t},a)=>s.jsx("th",{ref:a,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));c.displayName="TableHead";let u=r.forwardRef(({className:e,...t},a)=>s.jsx("td",{ref:a,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));u.displayName="TableCell",r.forwardRef(({className:e,...t},a)=>s.jsx("caption",{ref:a,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},6824:(e,t,a)=>{"use strict";a.d(t,{h:()=>l});var s=a(4099);let r=()=>localStorage.getItem("wolfflow_token"),l=s.Z.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let t=r();return console.log("Auth Token being sent:",t),t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e))},6693:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s=a(6824);let r=async function(e,t){try{let a={};return t?.headers&&(t.headers instanceof Headers?t.headers.forEach((e,t)=>{a[t]=e}):Array.isArray(t.headers)?t.headers.forEach(([e,t])=>{a[e]=t}):Object.assign(a,t.headers)),(await (0,s.h)(e,{method:t?.method||"GET",data:t?.body,headers:a})).data}catch(e){if(e.response)throw Error(e.response.data.message||e.response.statusText);if(e.request)throw Error("No response received from server.");throw Error(e.message)}}},8588:(e,t,a)=>{"use strict";a.d(t,{J:()=>r});var s=a(6693);let r={async getAllCompanies(e=1,t=10,a={}){let r=new URLSearchParams({page:e.toString(),limit:t.toString()});return a.isClient&&r.append("isClient","true"),a.isSupplier&&r.append("isSupplier","true"),(0,s.Z)(`/companies?${r.toString()}`)},getCompanyById:async e=>(0,s.Z)(`/companies/${e}`),createCompany:async e=>await (0,s.Z)("/companies",{method:"POST",body:JSON.stringify(e)}),updateCompany:async(e,t)=>await (0,s.Z)(`/companies/${e}`,{method:"PATCH",body:JSON.stringify(t)}),async deleteCompany(e){await (0,s.Z)(`/companies/${e}`,{method:"DELETE"})}}},4269:(e,t,a)=>{"use strict";a.d(t,{q:()=>r});var s=a(6693);let r={createInvoiceFromOrder:async e=>(0,s.Z)("/invoices",{method:"POST",body:JSON.stringify({orderId:e})}),async getAllInvoices(e=1,t=10,a){let r=new URLSearchParams({page:e.toString(),limit:t.toString()});a&&r.append("status",a);let l=await (0,s.Z)(`/invoices?${r.toString()}`);return{data:l.data,total:l.total,page:l.currentPage,limit:t,pages:l.pages}},getInvoiceById:async e=>(0,s.Z)(`/invoices/${e}`),getInvoicePdf:async e=>(0,s.Z)(`/invoices/${e}/pdf`)}},5649:(e,t,a)=>{"use strict";a.d(t,{M:()=>r});var s=a(6824);let r={getAllProducts:async(e,t=1,a=10)=>(await s.h.get("/products",{params:{page:t,limit:a},headers:{Authorization:`Bearer ${e}`}})).data,searchProducts:async(e,t,a=1,r=10)=>(await s.h.get("/products/search",{params:{term:t,page:a,limit:r},headers:{Authorization:`Bearer ${e}`}})).data,getPublishedProducts:async(e=1,t=10,a,r,l,i)=>(await s.h.get("/products/published",{params:{page:e,limit:t,category:a,searchQuery:r,minPrice:l,maxPrice:i}})).data,getPublishedProductById:async e=>(await s.h.get(`/products/published/${e}`)).data,getProductLots:async(e,t)=>(await s.h.get(`/products/${e}/lots`,{headers:{Authorization:`Bearer ${t}`}})).data,getAverageCost:async(e,t)=>(await s.h.get(`/products/${e}/average-cost`,{headers:{Authorization:`Bearer ${t}`}})).data,createProduct:async(e,t)=>(await s.h.post("/products",e,{headers:{Authorization:`Bearer ${t}`}})).data,updateProduct:async(e,t,a)=>(await s.h.patch(`/products/${e}`,t,{headers:{Authorization:`Bearer ${a}`}})).data,async deleteProduct(e,t){await s.h.delete(`/products/${e}`,{headers:{Authorization:`Bearer ${t}`}})},async uploadTechnicalSheet(e,t,a){let r=new FormData;return r.append("file",t),(await s.h.post(`/products/${e}/technical-sheet`,r,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${a}`}})).data},deleteTechnicalSheet:async(e,t)=>(await s.h.delete(`/products/${e}/technical-sheet`,{headers:{Authorization:`Bearer ${t}`}})).data}},9292:(e,t,a)=>{"use strict";a.d(t,{B:()=>r});var s=a(6693);let r={async getAllPurchases(e=1,t=10){let a=await (0,s.Z)(`/purchases?page=${e}&limit=${t}`);return{data:a.data,total:a.total,page:a.currentPage,limit:t,pages:a.pages}},getPurchaseById:async e=>(0,s.Z)(`/purchases/${e}`),createPurchase:async e=>(0,s.Z)("/purchases",{method:"POST",body:JSON.stringify(e)}),updatePurchase:async(e,t)=>(0,s.Z)(`/purchases/${e}`,{method:"PATCH",body:JSON.stringify(t)}),async deletePurchase(e){await (0,s.Z)(`/purchases/${e}`,{method:"DELETE"})}}},2771:(e,t,a)=>{"use strict";var s,r,l,i,n,o;a.d(t,{UY:()=>n,XL:()=>l,bG:()=>r,gS:()=>i,i4:()=>o,iF:()=>s}),a(7577),function(e){e.PENDING_PAYMENT="PENDING_PAYMENT",e.PROCESSING="PROCESSING",e.SHIPPED="SHIPPED",e.DELIVERED="DELIVERED",e.CANCELLED="CANCELLED",e.REFUNDED="REFUNDED"}(s||(s={})),function(e){e.PENDING="PENDING",e.PAID="PAID",e.FAILED="FAILED",e.REFUNDED="REFUNDED"}(r||(r={})),function(e){e.CASH="CASH",e.DEBIT_CARD="DEBIT_CARD",e.CREDIT_CARD="CREDIT_CARD",e.BANK_TRANSFER="BANK_TRANSFER",e.OTHER="OTHER"}(l||(l={})),function(e){e.DRAFT="DRAFT",e.SENT="SENT",e.ACCEPTED="ACCEPTED",e.REJECTED="REJECTED",e.EXPIRED="EXPIRED",e.INVOICED="INVOICED"}(i||(i={})),function(e){e.DRAFT="DRAFT",e.SENT="SENT",e.PAID="PAID",e.PARTIALLY_PAID="PARTIALLY_PAID",e.OVERDUE="OVERDUE",e.VOID="VOID",e.CANCELLED="CANCELLED"}(n||(n={})),function(e){e.ADMIN="ADMIN",e.EDITOR="EDITOR",e.VIEWER="VIEWER",e.CLIENT="CLIENT"}(o||(o={}))},1180:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(8570).createProxy)(String.raw`/home/astro/subred-erp/frontend/app/admin/sales/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[7364,434,325,531,2574,3653,5999,4278,4139],()=>a(5770));module.exports=s})();