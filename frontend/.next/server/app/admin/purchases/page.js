(()=>{var e={};e.id=3301,e.ids=[3301],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7790:e=>{"use strict";e.exports=require("assert")},4770:e=>{"use strict";e.exports=require("crypto")},7702:e=>{"use strict";e.exports=require("events")},2048:e=>{"use strict";e.exports=require("fs")},2615:e=>{"use strict";e.exports=require("http")},5240:e=>{"use strict";e.exports=require("https")},9801:e=>{"use strict";e.exports=require("os")},5315:e=>{"use strict";e.exports=require("path")},6162:e=>{"use strict";e.exports=require("stream")},4175:e=>{"use strict";e.exports=require("tty")},7360:e=>{"use strict";e.exports=require("url")},1764:e=>{"use strict";e.exports=require("util")},1568:e=>{"use strict";e.exports=require("zlib")},1145:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c}),r(7053),r(596),r(1506),r(5866);var s=r(3191),a=r(8716),n=r(7922),i=r.n(n),l=r(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let c=["",{children:["admin",{children:["purchases",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7053)),"/home/astro/subred-erp/frontend/app/admin/purchases/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,596)),"/home/astro/subred-erp/frontend/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,1506)),"/home/astro/subred-erp/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/home/astro/subred-erp/frontend/app/admin/purchases/page.tsx"],u="/admin/purchases/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/purchases/page",pathname:"/admin/purchases",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},4241:(e,t,r)=>{Promise.resolve().then(r.bind(r,126))},126:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var s=r(326),a=r(7577),n=r(5047),i=r(7394),l=r(2643),o=r(4762),c=r(2771),d=r(7863),u=r(9292),m=r(5940),p=r(772);let h=()=>{let{isAuthenticated:e,currentUser:t,isLoading:r}=(0,i.a)(),h=(0,n.useRouter)(),[f,x]=(0,a.useState)(!1),[g,E]=(0,a.useState)([]),[N,y]=(0,a.useState)(!0),[b,j]=(0,a.useState)(null),[v,D]=(0,a.useState)(1),[R,P]=(0,a.useState)(1),[C,A]=(0,a.useState)(0),I=(0,a.useCallback)(async(r=1)=>{if(!e||t?.role!==c.i4.ADMIN&&t?.role!==c.i4.EDITOR){j("No autorizado para ver esta p\xe1gina o no autenticado."),y(!1),e||h.push("/login");return}y(!0);try{let e=await u.B.getAllPurchases(r);E(e.data),P(e.pages),D(e.page),A(e.total)}catch(e){console.error("Error fetching purchases:",e),e.message&&e.message.includes("Unauthorized")?h.push("/login"):j("Error al cargar las compras.")}finally{y(!1)}},[e,t,h]);(0,a.useEffect)(()=>{r||I(v)},[I,v,r]);let T=(0,a.useCallback)(()=>{x(!0)},[]);(0,a.useCallback)(async()=>{x(!1),I(v)},[I,v]),(0,a.useCallback)(()=>{x(!1)},[]);let w=e=>{D(e)};return r?s.jsx("div",{className:"text-center py-8",children:"Cargando autenticaci\xf3n..."}):N?s.jsx("div",{className:"text-center py-8",children:"Cargando compras..."}):b?s.jsx("div",{className:"text-center py-8 text-destructive",children:b}):e&&(t?.role===c.i4.ADMIN||t?.role===c.i4.EDITOR)?s.jsx(s.Fragment,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[s.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold text-foreground",children:"Gesti\xf3n de Compras"}),(0,s.jsxs)(p.z,{className:"w-full sm:w-auto",onClick:T,children:[s.jsx(o.pO,{className:"w-5 h-5 mr-2"}),s.jsx("span",{children:"Registrar Nueva Compra"})]})]}),s.jsx(l.Zb,{className:"overflow-hidden border",children:s.jsx(l.aY,{className:"p-0",children:g.length>0?s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)(m.iA,{children:[s.jsx(m.xD,{className:"bg-muted/50",children:(0,s.jsxs)(m.SC,{children:[s.jsx(m.ss,{children:"ID Compra"}),s.jsx(m.ss,{children:"Empresa"}),s.jsx(m.ss,{className:"hidden sm:table-cell",children:"Fecha"}),s.jsx(m.ss,{className:"text-right",children:"Total"})]})}),s.jsx(m.RM,{children:g.map(e=>(0,s.jsxs)(m.SC,{className:"hover:bg-accent transition-colors duration-150",children:[(0,s.jsxs)(m.pj,{className:"font-mono text-muted-foreground",children:[e.id.substring(0,8),"..."]}),s.jsx(m.pj,{children:s.jsx("div",{className:"font-medium text-foreground",children:e.company?.name})}),s.jsx(m.pj,{className:"hidden sm:table-cell text-muted-foreground",children:new Date(e.purchaseDate).toLocaleDateString()}),s.jsx(m.pj,{className:"font-semibold text-primary text-right",children:(0,d.eQ)(e.grandTotal)})]},e.id))})]})}):(0,s.jsxs)("div",{className:"text-center py-12 px-4",children:[s.jsx(o.Q1,{className:"mx-auto h-16 w-16 text-muted-foreground opacity-40"}),s.jsx("h3",{className:"mt-3 text-xl font-semibold text-foreground",children:"No hay compras registradas"}),s.jsx("p",{className:"mt-1.5 text-sm text-muted-foreground",children:"Comienza registrando una nueva compra para verla listada aqu\xed."}),s.jsx("div",{className:"mt-6",children:(0,s.jsxs)(p.z,{type:"button",onClick:T,children:[s.jsx(o.pO,{className:"w-5 h-5 mr-2"}),s.jsx("span",{children:"Registrar Primera Compra"})]})})]})})}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[s.jsx("div",{children:(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["P\xe1gina ",v," de ",R," (Total: ",C," compras)"]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx(p.z,{variant:"outline",size:"sm",onClick:()=>w(v-1),disabled:v<=1,children:"Anterior"}),s.jsx(p.z,{variant:"outline",size:"sm",onClick:()=>w(v+1),disabled:v>=R,children:"Siguiente"})]})]})]})}):s.jsx("div",{className:"text-center py-8 text-destructive",children:"Acceso denegado. No tienes permisos suficientes."})};function f(){return s.jsx(h,{})}},772:(e,t,r)=>{"use strict";r.d(t,{z:()=>d});var s=r(326),a=r(7577),n=r.n(a),i=r(4214),l=r(9360),o=r(7863);let c=(0,l.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary-500 text-white hover:bg-primary-600",outline:"border border-primary-500 text-primary-500 hover:bg-primary-50",ghost:"hover:bg-gray-100"},size:{default:"h-10 px-4 py-2",sm:"h-8 px-3 text-xs",lg:"h-12 px-8"}},defaultVariants:{variant:"default",size:"default"}}),d=n().forwardRef(({className:e,variant:t,size:r,asChild:a=!1,...n},l)=>{let d=a?i.g7:"button";return s.jsx(d,{className:(0,o.cn)(c({variant:t,size:r,className:e})),ref:l,...n})});d.displayName="Button"},5940:(e,t,r)=>{"use strict";r.d(t,{RM:()=>o,SC:()=>c,iA:()=>i,pj:()=>u,ss:()=>d,xD:()=>l});var s=r(326),a=r(7577),n=r(7863);let i=a.forwardRef(({className:e,...t},r)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:r,className:(0,n.cn)("w-full caption-bottom text-sm",e),...t})}));i.displayName="Table";let l=a.forwardRef(({className:e,...t},r)=>s.jsx("thead",{ref:r,className:(0,n.cn)("[&_tr]:border-b",e),...t}));l.displayName="TableHeader";let o=a.forwardRef(({className:e,...t},r)=>s.jsx("tbody",{ref:r,className:(0,n.cn)("[&_tr:last-child]:border-0",e),...t}));o.displayName="TableBody",a.forwardRef(({className:e,...t},r)=>s.jsx("tfoot",{ref:r,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:hidden",e),...t})).displayName="TableFooter";let c=a.forwardRef(({className:e,...t},r)=>s.jsx("tr",{ref:r,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));c.displayName="TableRow";let d=a.forwardRef(({className:e,...t},r)=>s.jsx("th",{ref:r,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));d.displayName="TableHead";let u=a.forwardRef(({className:e,...t},r)=>s.jsx("td",{ref:r,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));u.displayName="TableCell",a.forwardRef(({className:e,...t},r)=>s.jsx("caption",{ref:r,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},6824:(e,t,r)=>{"use strict";r.d(t,{h:()=>n});var s=r(4099);let a=()=>localStorage.getItem("wolfflow_token"),n=s.Z.create({baseURL:"http://localhost:3001",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=a();return console.log("Auth Token being sent:",t),t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e))},6693:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var s=r(6824);let a=async function(e,t){try{let r={};return t?.headers&&(t.headers instanceof Headers?t.headers.forEach((e,t)=>{r[t]=e}):Array.isArray(t.headers)?t.headers.forEach(([e,t])=>{r[e]=t}):Object.assign(r,t.headers)),(await (0,s.h)(e,{method:t?.method||"GET",data:t?.body,headers:r})).data}catch(e){if(e.response)throw Error(e.response.data.message||e.response.statusText);if(e.request)throw Error("No response received from server.");throw Error(e.message)}}},9292:(e,t,r)=>{"use strict";r.d(t,{B:()=>a});var s=r(6693);let a={async getAllPurchases(e=1,t=10){let r=await (0,s.Z)(`/purchases?page=${e}&limit=${t}`);return{data:r.data,total:r.total,page:r.currentPage,limit:t,pages:r.pages}},getPurchaseById:async e=>(0,s.Z)(`/purchases/${e}`),createPurchase:async e=>(0,s.Z)("/purchases",{method:"POST",body:JSON.stringify(e)}),updatePurchase:async(e,t)=>(0,s.Z)(`/purchases/${e}`,{method:"PATCH",body:JSON.stringify(t)}),async deletePurchase(e){await (0,s.Z)(`/purchases/${e}`,{method:"DELETE"})}}},2771:(e,t,r)=>{"use strict";var s,a,n,i,l,o;r.d(t,{UY:()=>l,XL:()=>n,bG:()=>a,gS:()=>i,i4:()=>o,iF:()=>s}),r(7577),function(e){e.PENDING_PAYMENT="PENDING_PAYMENT",e.PROCESSING="PROCESSING",e.SHIPPED="SHIPPED",e.DELIVERED="DELIVERED",e.CANCELLED="CANCELLED",e.REFUNDED="REFUNDED"}(s||(s={})),function(e){e.PENDING="PENDING",e.PAID="PAID",e.FAILED="FAILED",e.REFUNDED="REFUNDED"}(a||(a={})),function(e){e.CASH="CASH",e.DEBIT_CARD="DEBIT_CARD",e.CREDIT_CARD="CREDIT_CARD",e.BANK_TRANSFER="BANK_TRANSFER",e.OTHER="OTHER"}(n||(n={})),function(e){e.DRAFT="DRAFT",e.SENT="SENT",e.ACCEPTED="ACCEPTED",e.REJECTED="REJECTED",e.EXPIRED="EXPIRED",e.INVOICED="INVOICED"}(i||(i={})),function(e){e.DRAFT="DRAFT",e.SENT="SENT",e.PAID="PAID",e.PARTIALLY_PAID="PARTIALLY_PAID",e.OVERDUE="OVERDUE",e.VOID="VOID",e.CANCELLED="CANCELLED"}(l||(l={})),function(e){e.ADMIN="ADMIN",e.EDITOR="EDITOR",e.VIEWER="VIEWER",e.CLIENT="CLIENT"}(o||(o={}))},5047:(e,t,r)=>{"use strict";var s=r(7389);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},7053:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`/home/astro/subred-erp/frontend/app/admin/purchases/page.tsx#default`)},8051:(e,t,r)=>{"use strict";r.d(t,{F:()=>n,e:()=>i});var s=r(7577);function a(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function n(...e){return t=>{let r=!1,s=e.map(e=>{let s=a(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():a(e[t],null)}}}}function i(...e){return s.useCallback(n(...e),e)}},4214:(e,t,r)=>{"use strict";r.d(t,{Z8:()=>i,g7:()=>l});var s=r(7577),a=r(8051),n=r(326);function i(e){let t=function(e){let t=s.forwardRef((e,t)=>{let{children:r,...n}=e;if(s.isValidElement(r)){let e,i;let l=(e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning?r.props.ref:r.props.ref||r.ref,o=function(e,t){let r={...t};for(let s in t){let a=e[s],n=t[s];/^on[A-Z]/.test(s)?a&&n?r[s]=(...e)=>{let t=n(...e);return a(...e),t}:a&&(r[s]=a):"style"===s?r[s]={...a,...n}:"className"===s&&(r[s]=[a,n].filter(Boolean).join(" "))}return{...e,...r}}(n,r.props);return r.type!==s.Fragment&&(o.ref=t?(0,a.F)(t,l):l),s.cloneElement(r,o)}return s.Children.count(r)>1?s.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),r=s.forwardRef((e,r)=>{let{children:a,...i}=e,l=s.Children.toArray(a),o=l.find(c);if(o){let e=o.props.children,a=l.map(t=>t!==o?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,n.jsx)(t,{...i,ref:r,children:s.isValidElement(e)?s.cloneElement(e,void 0,a):null})}return(0,n.jsx)(t,{...i,ref:r,children:a})});return r.displayName=`${e}.Slot`,r}var l=i("Slot"),o=Symbol("radix.slottable");function c(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===o}},9360:(e,t,r)=>{"use strict";r.d(t,{j:()=>i});var s=r(1135);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=s.W,i=(e,t)=>r=>{var s;if((null==t?void 0:t.variants)==null)return n(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:i,defaultVariants:l}=t,o=Object.keys(i).map(e=>{let t=null==r?void 0:r[e],s=null==l?void 0:l[e];if(null===t)return null;let n=a(t)||a(s);return i[e][n]}),c=r&&Object.entries(r).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{});return n(e,o,null==t?void 0:null===(s=t.compoundVariants)||void 0===s?void 0:s.reduce((e,t)=>{let{class:r,className:s,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...l,...c}[t]):({...l,...c})[t]===r})?[...e,r,s]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[7364,434,325,4278,4139],()=>r(1145));module.exports=s})();